"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[176],{7808:function(e,t,n){let i,r,s,o,a,l,c,h,u,d,f,p,m,_,v,g,y,E,b,O,w,T,x;n.d(t,{B:function(){return $}});var S=n(2110),C=n(6376),L=n(4090),P=n(1653);/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */let A={LEFT:1,RIGHT:2,MIDDLE:4},D=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),M={NONE:0,IN:1,OUT:-1};function U(e){return e.isPerspectiveCamera}function z(e){return e.isOrthographicCamera}let R=2*Math.PI,F=Math.PI/2,I=Math.PI/180;function k(e,t,n){return Math.max(t,Math.min(n,e))}function H(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-5;return Math.abs(e)<t}function j(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-5;return H(e-t,n)}function V(e,t){return Math.round(e/t)*t}function B(e){return isFinite(e)?e:e<0?-Number.MAX_VALUE:Number.MAX_VALUE}function N(e){return Math.abs(e)<Number.MAX_VALUE?e:1/0*e}function Y(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,s=arguments.length>5?arguments[5]:void 0,o=2/(i=Math.max(1e-4,i)),a=o*s,l=1/(1+a+.48*a*a+.235*a*a*a),c=e-t,h=t,u=r*i;t=e-(c=k(c,-u,u));let d=(n.value+o*c)*s;n.value=(n.value-o*d)*l;let f=t+(c+d)*l;return h-e>0==f>h&&(f=h,n.value=(f-h)/s),f}function Z(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,a=2/(i=Math.max(1e-4,i)),l=a*s,c=1/(1+l+.48*l*l+.235*l*l*l),h=t.x,u=t.y,d=t.z,f=e.x-h,p=e.y-u,m=e.z-d,_=h,v=u,g=d,y=r*i,E=f*f+p*p+m*m;if(E>y*y){let e=Math.sqrt(E);f=f/e*y,p=p/e*y,m=m/e*y}h=e.x-f,u=e.y-p,d=e.z-m;let b=(n.x+a*f)*s,O=(n.y+a*p)*s,w=(n.z+a*m)*s;n.x=(n.x-a*b)*c,n.y=(n.y-a*O)*c,n.z=(n.z-a*w)*c,o.x=h+(f+b)*c,o.y=u+(p+O)*c,o.z=d+(m+w)*c;let T=_-e.x,x=v-e.y,S=g-e.z;return T*(o.x-_)+x*(o.y-v)+S*(o.z-g)>0&&(o.x=_,o.y=v,o.z=g,n.x=(o.x-_)/s,n.y=(o.y-v)/s,n.z=(o.z-g)/s),o}function W(e,t){t.set(0,0),e.forEach(e=>{t.x+=e.clientX,t.y+=e.clientY}),t.x/=e.length,t.y/=e.length}function G(e,t){return!!z(e)&&(console.warn("".concat(t," is not supported in OrthographicCamera")),!0)}class K{addEventListener(e,t){let n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){let n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){let n=this._listeners[e];if(void 0!==n){let e=n.indexOf(t);-1!==e&&n.splice(e,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){let t=this._listeners[e.type];if(void 0!==t){e.target=this;let n=t.slice(0);for(let t=0,i=n.length;t<i;t++)n[t].call(this,e)}}constructor(){this._listeners={}}}let X=1/8,q=/Mac/.test(navigator.platform),Q=!("PointerEvent"in window);class J extends K{static install(e){r=Object.freeze(new(i=e.THREE).Vector3(0,0,0)),s=Object.freeze(new i.Vector3(0,1,0)),o=Object.freeze(new i.Vector3(0,0,1)),a=new i.Vector2,l=new i.Vector3,c=new i.Vector3,h=new i.Vector3,u=new i.Vector3,d=new i.Vector3,f=new i.Vector3,p=new i.Vector3,m=new i.Vector3,_=new i.Vector3,v=new i.Spherical,g=new i.Spherical,y=new i.Box3,E=new i.Box3,b=new i.Sphere,O=new i.Quaternion,w=new i.Quaternion,T=new i.Matrix4,x=new i.Raycaster}static get ACTION(){return D}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){(this._spherical.radius!==e||this._sphericalEnd.radius!==e)&&(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){(this._spherical.theta!==e||this._sphericalEnd.theta!==e)&&(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){(this._spherical.phi!==e||this._sphericalEnd.phi!==e)&&(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=k(e.width,0,1),this._interactiveArea.height=k(e.height,0,1),this._interactiveArea.x=k(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=k(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,n)}rotateAzimuthTo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._isUserControllingRotate=!1;let i=k(e,this.minAzimuthAngle,this.maxAzimuthAngle),r=k(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=i,this._sphericalEnd.phi=r,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,n||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);let s=!n||j(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&j(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(s)}dolly(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._isUserControllingDolly=!1,this._lastDollyDirection=M.NONE,this._changedDolly=0,this._dollyToNoClamp(k(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){let t=this._collisionTest(),i=j(t,this._spherical.radius);if(!(n>e)&&i)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,t)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);let i=!t||j(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(i)}dollyInFixed(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._targetEnd.add(this._getCameraDirection(u).multiplyScalar(e)),t||this._target.copy(this._targetEnd);let n=!t||j(this._target.x,this._targetEnd.x,this.restThreshold)&&j(this._target.y,this._targetEnd.y,this.restThreshold)&&j(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}zoom(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._isUserControllingZoom=!1,this._zoomEnd=k(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);let n=!t||j(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(n)}pan(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,n)}truck(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._camera.updateMatrix(),d.setFromMatrixColumn(this._camera.matrix,0),f.setFromMatrixColumn(this._camera.matrix,1),d.multiplyScalar(e),f.multiplyScalar(-t);let i=l.copy(d).add(f),r=c.copy(this._targetEnd).add(i);return this.moveTo(r.x,r.y,r.z,n)}forward(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];l.setFromMatrixColumn(this._camera.matrix,0),l.crossVectors(this._camera.up,l),l.multiplyScalar(e);let n=c.copy(this._targetEnd).add(l);return this.moveTo(n.x,n.y,n.z,t)}elevate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return l.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+l.x,this._targetEnd.y+l.y,this._targetEnd.z+l.z,t)}moveTo(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._isUserControllingTruck=!1;let r=l.set(e,t,n).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,r,this.boundaryFriction),this._needsUpdate=!0,i||this._target.copy(this._targetEnd);let s=!i||j(this._target.x,this._targetEnd.x,this.restThreshold)&&j(this._target.y,this._targetEnd.y,this.restThreshold)&&j(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}lookInDirectionOf(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=l.set(e,t,n).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius);return this.setPosition(r.x,r.y,r.z,i)}fitToBox(e,t){let{cover:n=!1,paddingLeft:i=0,paddingRight:r=0,paddingBottom:a=0,paddingTop:h=0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=[],d=e.isBox3?y.copy(e):y.setFromObject(e);d.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());let f=V(this._sphericalEnd.theta,F),p=V(this._sphericalEnd.phi,F);u.push(this.rotateTo(f,p,t));let m=l.setFromSpherical(this._sphericalEnd).normalize(),_=O.setFromUnitVectors(m,o),v=j(Math.abs(m.y),1);v&&_.multiply(w.setFromAxisAngle(s,f)),_.multiply(this._yAxisUpSpaceInverse);let g=E.makeEmpty();c.copy(d.min).applyQuaternion(_),g.expandByPoint(c),c.copy(d.min).setX(d.max.x).applyQuaternion(_),g.expandByPoint(c),c.copy(d.min).setY(d.max.y).applyQuaternion(_),g.expandByPoint(c),c.copy(d.max).setZ(d.min.z).applyQuaternion(_),g.expandByPoint(c),c.copy(d.min).setZ(d.max.z).applyQuaternion(_),g.expandByPoint(c),c.copy(d.max).setY(d.min.y).applyQuaternion(_),g.expandByPoint(c),c.copy(d.max).setX(d.min.x).applyQuaternion(_),g.expandByPoint(c),c.copy(d.max).applyQuaternion(_),g.expandByPoint(c),g.min.x-=i,g.min.y-=a,g.max.x+=r,g.max.y+=h,_.setFromUnitVectors(o,m),v&&_.premultiply(w.invert()),_.premultiply(this._yAxisUpSpace);let b=g.getSize(l),T=g.getCenter(c).applyQuaternion(_);if(U(this._camera)){let e=this.getDistanceToFitBox(b.x,b.y,b.z,n);u.push(this.moveTo(T.x,T.y,T.z,t)),u.push(this.dollyTo(e,t)),u.push(this.setFocalOffset(0,0,0,t))}else if(z(this._camera)){let e=this._camera,i=e.right-e.left,r=e.top-e.bottom,s=n?Math.max(i/b.x,r/b.y):Math.min(i/b.x,r/b.y);u.push(this.moveTo(T.x,T.y,T.z,t)),u.push(this.zoomTo(s,t)),u.push(this.setFocalOffset(0,0,0,t))}return Promise.all(u)}fitToSphere(e,t){let n=[],r=e instanceof i.Sphere?b.copy(e):J.createBoundingSphere(e,b);if(n.push(this.moveTo(r.center.x,r.center.y,r.center.z,t)),U(this._camera)){let e=this.getDistanceToFitSphere(r.radius);n.push(this.dollyTo(e,t))}else if(z(this._camera)){let e=this._camera.right-this._camera.left,i=this._camera.top-this._camera.bottom,s=2*r.radius;n.push(this.zoomTo(Math.min(e/s,i/s),t))}return n.push(this.setFocalOffset(0,0,0,t)),Promise.all(n)}setLookAt(e,t,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=M.NONE,this._changedDolly=0;let a=c.set(i,r,s),h=l.set(e,t,n);this._targetEnd.copy(a),this._sphericalEnd.setFromVector3(h.sub(a).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,o||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));let u=!o||j(this._target.x,this._targetEnd.x,this.restThreshold)&&j(this._target.y,this._targetEnd.y,this.restThreshold)&&j(this._target.z,this._targetEnd.z,this.restThreshold)&&j(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&j(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&j(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(u)}lerpLookAt(e,t,n,i,r,s,o,a,u,d,f,p,m){let _=arguments.length>13&&void 0!==arguments[13]&&arguments[13];this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=M.NONE,this._changedDolly=0;let y=l.set(i,r,s),E=c.set(e,t,n);v.setFromVector3(E.sub(y).applyQuaternion(this._yAxisUpSpace));let b=h.set(d,f,p),O=c.set(o,a,u);g.setFromVector3(O.sub(b).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(y.lerp(b,m));let w=g.theta-v.theta,T=g.phi-v.phi,x=g.radius-v.radius;this._sphericalEnd.set(v.radius+x*m,v.phi+T*m,v.theta+w*m),this.normalizeRotations(),this._needsUpdate=!0,_||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));let S=!_||j(this._target.x,this._targetEnd.x,this.restThreshold)&&j(this._target.y,this._targetEnd.y,this.restThreshold)&&j(this._target.z,this._targetEnd.z,this.restThreshold)&&j(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&j(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&j(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(S)}setPosition(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.setLookAt(e,t,n,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,i)}setTarget(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.getPosition(l),s=this.setLookAt(r.x,r.y,r.z,e,t,n,i);return this._sphericalEnd.phi=k(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),s}setFocalOffset(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,n),this._needsUpdate=!0,i||this._focalOffset.copy(this._focalOffsetEnd);let r=!i||j(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&j(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&j(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}setOrbitPoint(e,t,n){this._camera.updateMatrixWorld(),d.setFromMatrixColumn(this._camera.matrixWorldInverse,0),f.setFromMatrixColumn(this._camera.matrixWorldInverse,1),p.setFromMatrixColumn(this._camera.matrixWorldInverse,2);let i=l.set(e,t,n),r=i.distanceTo(this._camera.position),s=i.sub(this._camera.position);d.multiplyScalar(s.x),f.multiplyScalar(s.y),p.multiplyScalar(s.z),l.copy(d).add(f).add(p),l.z=l.z+r,this.dollyTo(r,!1),this.setFocalOffset(-l.x,l.y,-l.z,!1),this.moveTo(e,t,n,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,n,r){if(null===e){this._viewport=null;return}this._viewport=this._viewport||new i.Vector4,"number"==typeof e?this._viewport.set(e,t,n,r):this._viewport.copy(e)}getDistanceToFitBox(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(G(this._camera,"getDistanceToFitBox"))return this._spherical.radius;let r=e/t,s=this._camera.getEffectiveFOV()*I,o=this._camera.aspect;return .5*((i?r>o:r<o)?t:e/o)/Math.tan(.5*s)+.5*n}getDistanceToFitSphere(e){if(G(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;let t=this._camera.getEffectiveFOV()*I,n=2*Math.atan(Math.tan(.5*t)*this._camera.aspect);return e/Math.sin(.5*(1<this._camera.aspect?t:n))}getTarget(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(e&&e.isVector3?e:new i.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(e&&e.isVector3?e:new i.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(e&&e instanceof i.Spherical?e:new i.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(e&&e.isVector3?e:new i.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%R,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=R),this._spherical.theta+=R*Math.round((this._sphericalEnd.theta-this._spherical.theta)/R)}reset(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!j(this._camera.up.x,this._cameraUp0.x)||!j(this._camera.up.y,this._cameraUp0.y)||!j(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);let e=this.getPosition(l);this.updateCameraUp(),this.setPosition(e.x,e.y,e.z)}return Promise.all([this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)])}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,s),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){let e=l.subVectors(this._target,this._camera.position).normalize(),t=c.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();let n=this.getPosition(l);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}update(e){let t=this._sphericalEnd.theta-this._spherical.theta,n=this._sphericalEnd.phi-this._spherical.phi,i=this._sphericalEnd.radius-this._spherical.radius,r=m.subVectors(this._targetEnd,this._target),s=_.subVectors(this._focalOffsetEnd,this._focalOffset),o=this._zoomEnd-this._zoom;if(H(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{let t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=Y(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,t,1/0,e),this._needsUpdate=!0}if(H(n))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{let t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=Y(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,t,1/0,e),this._needsUpdate=!0}if(H(i))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{let t=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=Y(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,t,this.maxSpeed,e),this._needsUpdate=!0}if(H(r.x)&&H(r.y)&&H(r.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{let t=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;Z(this._target,this._targetEnd,this._targetVelocity,t,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(H(s.x)&&H(s.y)&&H(s.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{let t=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;Z(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,t,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(H(o))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{let t=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=Y(this._zoom,this._zoomEnd,this._zoomVelocity,t,1/0,e)}if(this.dollyToCursor){if(U(this._camera)&&0!==this._changedDolly){let e=this._spherical.radius-this._lastDistance,t=this._camera,n=this._getCameraDirection(u),i=l.copy(n).cross(t.up).normalize();0===i.lengthSq()&&(i.x=1);let r=c.crossVectors(i,n),s=this._sphericalEnd.radius*Math.tan(t.getEffectiveFOV()*I*.5),o=(this._sphericalEnd.radius-e-this._sphericalEnd.radius)/this._sphericalEnd.radius,a=h.copy(this._targetEnd).add(i.multiplyScalar(this._dollyControlCoord.x*s*t.aspect)).add(r.multiplyScalar(this._dollyControlCoord.y*s)),d=l.copy(this._targetEnd).lerp(a,o),f=this._lastDollyDirection===M.IN&&this._spherical.radius<=this.minDistance,p=this._lastDollyDirection===M.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(f||p)){this._sphericalEnd.radius-=e,this._spherical.radius-=e;let t=c.copy(n).multiplyScalar(-e);d.add(t)}this._boundary.clampPoint(d,d);let m=c.subVectors(d,this._targetEnd);this._targetEnd.copy(d),this._target.add(m),this._changedDolly-=e,H(this._changedDolly)&&(this._changedDolly=0)}else if(z(this._camera)&&0!==this._changedZoom){let e=this._zoom-this._lastZoom,t=this._camera,n=l.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(t.near+t.far)/(t.near-t.far)).unproject(t),i=c.set(0,0,-1).applyQuaternion(t.quaternion),r=h.copy(n).add(i.multiplyScalar(-n.dot(t.up))),s=-(this._zoom-e-this._zoom)/this._zoom,o=this._getCameraDirection(u),a=this._targetEnd.dot(o),d=l.copy(this._targetEnd).lerp(r,s),f=d.dot(o),p=o.multiplyScalar(f-a);d.sub(p),this._boundary.clampPoint(d,d);let m=c.subVectors(d,this._targetEnd);this._targetEnd.copy(d),this._target.add(m),this._changedZoom-=e,H(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;let a=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,a),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),H(this._focalOffset.x)&&H(this._focalOffset.y)&&H(this._focalOffset.z)||(this._camera.updateMatrixWorld(),d.setFromMatrixColumn(this._camera.matrix,0),f.setFromMatrixColumn(this._camera.matrix,1),p.setFromMatrixColumn(this._camera.matrix,2),d.multiplyScalar(this._focalOffset.x),f.multiplyScalar(-this._focalOffset.y),p.multiplyScalar(this._focalOffset.z),l.copy(d).add(f).add(p),this._camera.position.add(l)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),l.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);let v=this._needsUpdate;return v&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):v?(this.dispatchEvent({type:"update"}),H(t,this.restThreshold)&&H(n,this.restThreshold)&&H(i,this.restThreshold)&&H(r.x,this.restThreshold)&&H(r.y,this.restThreshold)&&H(r.z,this.restThreshold)&&H(s.x,this.restThreshold)&&H(s.y,this.restThreshold)&&H(s.z,this.restThreshold)&&H(o,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!v&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=v,this._needsUpdate=!1,v}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:B(this.maxDistance),minZoom:this.minZoom,maxZoom:B(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:B(this.maxPolarAngle),minAzimuthAngle:B(this.minAzimuthAngle),maxAzimuthAngle:B(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:l.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=JSON.parse(e);this.enabled=n.enabled,this.minDistance=n.minDistance,this.maxDistance=N(n.maxDistance),this.minZoom=n.minZoom,this.maxZoom=N(n.maxZoom),this.minPolarAngle=n.minPolarAngle,this.maxPolarAngle=N(n.maxPolarAngle),this.minAzimuthAngle=N(n.minAzimuthAngle),this.maxAzimuthAngle=N(n.maxAzimuthAngle),this.smoothTime=n.smoothTime,this.draggingSmoothTime=n.draggingSmoothTime,this.dollySpeed=n.dollySpeed,this.truckSpeed=n.truckSpeed,this.dollyToCursor=n.dollyToCursor,this.verticalDragToForward=n.verticalDragToForward,this._target0.fromArray(n.target0),this._position0.fromArray(n.position0),this._zoom0=n.zoom0,this._focalOffset0.fromArray(n.focalOffset0),this.moveTo(n.target[0],n.target[1],n.target[2],t),v.setFromVector3(l.fromArray(n.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(v.theta,v.phi,t),this.dollyTo(v.radius,t),this.zoomTo(n.zoom,t),this.setFocalOffset(n.focalOffset[0],n.focalOffset[1],n.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version","2.7.3"),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,n){let i=t.lengthSq();if(0===i)return e;let r=c.copy(t).add(e),s=this._boundary.clampPoint(r,h).sub(r),o=s.lengthSq();if(0===o)return e.add(t);if(o===i)return e;if(0===n)return e.add(t).add(s);{let i=1+n*o/t.dot(s);return e.add(c.copy(t).multiplyScalar(i)).add(s.multiplyScalar(1-n))}}_updateNearPlaneCorners(){if(U(this._camera)){let e=this._camera,t=e.near,n=Math.tan(e.getEffectiveFOV()*I*.5)*t,i=n*e.aspect;this._nearPlaneCorners[0].set(-i,-n,0),this._nearPlaneCorners[1].set(i,-n,0),this._nearPlaneCorners[2].set(i,n,0),this._nearPlaneCorners[3].set(-i,n,0)}else if(z(this._camera)){let e=this._camera,t=1/e.zoom,n=e.left*t,i=e.right*t,r=e.top*t,s=e.bottom*t;this._nearPlaneCorners[0].set(n,r,0),this._nearPlaneCorners[1].set(i,r,0),this._nearPlaneCorners[2].set(i,s,0),this._nearPlaneCorners[3].set(n,s,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||G(this._camera,"_collisionTest"))return e;let t=this._getTargetDirection(u);T.lookAt(r,t,this._camera.up);for(let n=0;n<4;n++){let i=c.copy(this._nearPlaneCorners[n]);i.applyMatrix4(T);let r=h.addVectors(this._target,i);x.set(r,t),x.far=this._spherical.radius+1;let s=x.intersectObjects(this.colliderMeshes);0!==s.length&&s[0].distance<e&&(e=s[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;let t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(e=>{let t=()=>{this.removeEventListener("rest",t),e()};this.addEventListener("rest",t)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new i.Sphere,n=t.center;y.makeEmpty(),e.traverseVisible(e=>{e.isMesh&&y.expandByObject(e)}),y.getCenter(n);let r=0;return e.traverseVisible(e=>{if(!e.isMesh)return;let t=e.geometry.clone();t.applyMatrix4(e.matrixWorld);let i=t.attributes.position;for(let e=0,t=i.count;e<t;e++)l.fromBufferAttribute(i,e),r=Math.max(r,n.distanceToSquared(l))}),t.radius=Math.sqrt(r),t}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=D.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=M.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new i.Vector3,this._focalOffsetVelocity=new i.Vector3,this._zoomVelocity={value:0},this._truckInternal=(e,t,n)=>{let i,r;if(U(this._camera)){let n=l.copy(this._camera.position).sub(this._target),s=this._camera.getEffectiveFOV()*I,o=n.length()*Math.tan(.5*s);i=this.truckSpeed*e*o/this._elementRect.height,r=this.truckSpeed*t*o/this._elementRect.height}else{if(!z(this._camera))return;let n=this._camera;i=e*(n.right-n.left)/n.zoom/this._elementRect.width,r=t*(n.top-n.bottom)/n.zoom/this._elementRect.height}this.verticalDragToForward?(n?this.setFocalOffset(this._focalOffsetEnd.x+i,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(i,0,!0),this.forward(-r,!0)):n?this.setFocalOffset(this._focalOffsetEnd.x+i,this._focalOffsetEnd.y+r,this._focalOffsetEnd.z,!0):this.truck(i,r,!0)},this._rotateInternal=(e,t)=>{let n=R*this.azimuthRotateSpeed*e/this._elementRect.height,i=R*this.polarRotateSpeed*t/this._elementRect.height;this.rotate(n,i,!0)},this._dollyInternal=(e,t,n)=>{let i=Math.pow(.95,-e*this.dollySpeed),r=this._sphericalEnd.radius,s=this._sphericalEnd.radius*i,o=k(s,this.minDistance,this.maxDistance);this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(s,!0):(this.infinityDolly&&!this.dollyToCursor&&this.dollyInFixed(o-s,!0),this._dollyToNoClamp(o,!0)),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?s:o)-r,this._dollyControlCoord.set(t,n)),this._lastDollyDirection=Math.sign(-e)},this._zoomInternal=(e,t,n)=>{let i=Math.pow(.95,e*this.dollySpeed),r=this._zoom,s=this._zoom*i;this.zoomTo(s,!0),this.dollyToCursor&&(this._changedZoom+=s-r,this._dollyControlCoord.set(t,n))},void 0===i&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new i.Quaternion().setFromUnitVectors(this._camera.up,s),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=D.NONE,this._target=new i.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new i.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new i.Spherical().setFromVector3(l.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3],this._updateNearPlaneCorners(),this._boundary=new i.Box3(new i.Vector3(-1/0,-1/0,-1/0),new i.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new i.Vector2,this.mouseButtons={left:D.ROTATE,middle:D.DOLLY,right:D.TRUCK,wheel:U(this._camera)?D.DOLLY:z(this._camera)?D.ZOOM:D.NONE},this.touches={one:D.TOUCH_ROTATE,two:U(this._camera)?D.TOUCH_DOLLY_TRUCK:z(this._camera)?D.TOUCH_ZOOM_TRUCK:D.NONE,three:D.TOUCH_TRUCK};let n=new i.Vector2,r=new i.Vector2,o=new i.Vector2,c=e=>{if(!this._enabled||!this._domElement)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){let t=this._domElement.getBoundingClientRect(),n=e.clientX/t.width,i=e.clientY/t.height;if(n<this._interactiveArea.left||n>this._interactiveArea.right||i<this._interactiveArea.top||i>this._interactiveArea.bottom)return}let t="mouse"!==e.pointerType?null:(e.buttons&A.LEFT)===A.LEFT?A.LEFT:(e.buttons&A.MIDDLE)===A.MIDDLE?A.MIDDLE:(e.buttons&A.RIGHT)===A.RIGHT?A.RIGHT:null;if(null!==t){let e=this._findPointerByMouseButton(t);e&&this._disposePointer(e)}if((e.buttons&A.LEFT)===A.LEFT&&this._lockedPointer)return;let n={pointerId:e.pointerId,clientX:e.clientX,clientY:e.clientY,deltaX:0,deltaY:0,mouseButton:t};this._activePointers.push(n),this._domElement.ownerDocument.removeEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",f),this._domElement.ownerDocument.addEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",f),this._isDragging=!0,g(e)},h=e=>{if(!this._enabled||!this._domElement||this._lockedPointer)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){let t=this._domElement.getBoundingClientRect(),n=e.clientX/t.width,i=e.clientY/t.height;if(n<this._interactiveArea.left||n>this._interactiveArea.right||i<this._interactiveArea.top||i>this._interactiveArea.bottom)return}let t=(e.buttons&A.LEFT)===A.LEFT?A.LEFT:(e.buttons&A.MIDDLE)===A.MIDDLE?A.MIDDLE:(e.buttons&A.RIGHT)===A.RIGHT?A.RIGHT:null;if(null!==t){let e=this._findPointerByMouseButton(t);e&&this._disposePointer(e)}let n={pointerId:1,clientX:e.clientX,clientY:e.clientY,deltaX:0,deltaY:0,mouseButton:(e.buttons&A.LEFT)===A.LEFT?A.LEFT:(e.buttons&A.MIDDLE)===A.LEFT?A.MIDDLE:(e.buttons&A.RIGHT)===A.LEFT?A.RIGHT:null};this._activePointers.push(n),this._domElement.ownerDocument.removeEventListener("mousemove",d),this._domElement.ownerDocument.removeEventListener("mouseup",p),this._domElement.ownerDocument.addEventListener("mousemove",d),this._domElement.ownerDocument.addEventListener("mouseup",p),this._isDragging=!0,g(e)},u=e=>{e.cancelable&&e.preventDefault();let t=e.pointerId,n=this._lockedPointer||this._findPointerById(t);if(n){if(n.clientX=e.clientX,n.clientY=e.clientY,n.deltaX=e.movementX,n.deltaY=e.movementY,this._state=0,"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(e.buttons&A.LEFT)===A.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(e.buttons&A.MIDDLE)===A.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(e.buttons&A.RIGHT)===A.RIGHT&&(this._state=this._state|this.mouseButtons.right);y()}},d=e=>{let t=this._lockedPointer||this._findPointerById(1);t&&(t.clientX=e.clientX,t.clientY=e.clientY,t.deltaX=e.movementX,t.deltaY=e.movementY,this._state=0,(this._lockedPointer||(e.buttons&A.LEFT)===A.LEFT)&&(this._state=this._state|this.mouseButtons.left),(e.buttons&A.MIDDLE)===A.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(e.buttons&A.RIGHT)===A.RIGHT&&(this._state=this._state|this.mouseButtons.right),y())},f=e=>{let t=this._findPointerById(e.pointerId);if(!t||t!==this._lockedPointer){if(t&&this._disposePointer(t),"touch"===e.pointerType)switch(this._activePointers.length){case 0:this._state=D.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=D.NONE;E()}},p=()=>{let e=this._findPointerById(1);e&&e===this._lockedPointer||(e&&this._disposePointer(e),this._state=D.NONE,E())},m=-1,_=e=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===D.NONE)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){let t=this._domElement.getBoundingClientRect(),n=e.clientX/t.width,i=e.clientY/t.height;if(n<this._interactiveArea.left||n>this._interactiveArea.right||i<this._interactiveArea.top||i>this._interactiveArea.bottom)return}if(e.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===D.ROTATE||this.mouseButtons.wheel===D.TRUCK){let e=performance.now();m-e<1e3&&this._getClientRect(this._elementRect),m=e}let t=q?-1:-3,n=1===e.deltaMode?e.deltaY/t:e.deltaY/(10*t),i=this.dollyToCursor?(e.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,r=this.dollyToCursor?-((e.clientY-this._elementRect.y)/this._elementRect.height*2)+1:0;switch(this.mouseButtons.wheel){case D.ROTATE:this._rotateInternal(e.deltaX,e.deltaY),this._isUserControllingRotate=!0;break;case D.TRUCK:this._truckInternal(e.deltaX,e.deltaY,!1),this._isUserControllingTruck=!0;break;case D.OFFSET:this._truckInternal(e.deltaX,e.deltaY,!0),this._isUserControllingOffset=!0;break;case D.DOLLY:this._dollyInternal(-n,i,r),this._isUserControllingDolly=!0;break;case D.ZOOM:this._zoomInternal(-n,i,r),this._isUserControllingZoom=!0}this.dispatchEvent({type:"control"})},v=e=>{if(this._domElement&&this._enabled){if(this.mouseButtons.right===J.ACTION.NONE){let t=e instanceof PointerEvent?e.pointerId:(MouseEvent,0),n=this._findPointerById(t);n&&this._disposePointer(n),this._domElement.ownerDocument.removeEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",f),this._domElement.ownerDocument.removeEventListener("mousemove",d),this._domElement.ownerDocument.removeEventListener("mouseup",p);return}e.preventDefault()}},g=e=>{if(this._enabled){if(W(this._activePointers,a),this._getClientRect(this._elementRect),n.copy(a),r.copy(a),this._activePointers.length>=2){let e=a.x-this._activePointers[1].clientX,t=a.y-this._activePointers[1].clientY;o.set(0,Math.sqrt(e*e+t*t));let n=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,i=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;r.set(n,i)}if(this._state=0,e){if("pointerType"in e&&"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._lockedPointer||(e.buttons&A.LEFT)!==A.LEFT||(this._state=this._state|this.mouseButtons.left),(e.buttons&A.MIDDLE)===A.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(e.buttons&A.RIGHT)===A.RIGHT&&(this._state=this._state|this.mouseButtons.right)}else this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);((this._state&D.ROTATE)===D.ROTATE||(this._state&D.TOUCH_ROTATE)===D.TOUCH_ROTATE||(this._state&D.TOUCH_DOLLY_ROTATE)===D.TOUCH_DOLLY_ROTATE||(this._state&D.TOUCH_ZOOM_ROTATE)===D.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&D.TRUCK)===D.TRUCK||(this._state&D.TOUCH_TRUCK)===D.TOUCH_TRUCK||(this._state&D.TOUCH_DOLLY_TRUCK)===D.TOUCH_DOLLY_TRUCK||(this._state&D.TOUCH_ZOOM_TRUCK)===D.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&D.DOLLY)===D.DOLLY||(this._state&D.TOUCH_DOLLY)===D.TOUCH_DOLLY||(this._state&D.TOUCH_DOLLY_TRUCK)===D.TOUCH_DOLLY_TRUCK||(this._state&D.TOUCH_DOLLY_OFFSET)===D.TOUCH_DOLLY_OFFSET||(this._state&D.TOUCH_DOLLY_ROTATE)===D.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&D.ZOOM)===D.ZOOM||(this._state&D.TOUCH_ZOOM)===D.TOUCH_ZOOM||(this._state&D.TOUCH_ZOOM_TRUCK)===D.TOUCH_ZOOM_TRUCK||(this._state&D.TOUCH_ZOOM_OFFSET)===D.TOUCH_ZOOM_OFFSET||(this._state&D.TOUCH_ZOOM_ROTATE)===D.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&D.OFFSET)===D.OFFSET||(this._state&D.TOUCH_OFFSET)===D.TOUCH_OFFSET||(this._state&D.TOUCH_DOLLY_OFFSET)===D.TOUCH_DOLLY_OFFSET||(this._state&D.TOUCH_ZOOM_OFFSET)===D.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})}},y=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,W(this._activePointers,a);let e=this._domElement&&document.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,t=e?-e.deltaX:r.x-a.x,i=e?-e.deltaY:r.y-a.y;if(r.copy(a),((this._state&D.ROTATE)===D.ROTATE||(this._state&D.TOUCH_ROTATE)===D.TOUCH_ROTATE||(this._state&D.TOUCH_DOLLY_ROTATE)===D.TOUCH_DOLLY_ROTATE||(this._state&D.TOUCH_ZOOM_ROTATE)===D.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(t,i),this._isUserControllingRotate=!0),(this._state&D.DOLLY)===D.DOLLY||(this._state&D.ZOOM)===D.ZOOM){let e=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,t=this.dollyToCursor?-((n.y-this._elementRect.y)/this._elementRect.height*2)+1:0,r=this.dollyDragInverted?-1:1;(this._state&D.DOLLY)===D.DOLLY?(this._dollyInternal(r*i*X,e,t),this._isUserControllingDolly=!0):(this._zoomInternal(r*i*X,e,t),this._isUserControllingZoom=!0)}if((this._state&D.TOUCH_DOLLY)===D.TOUCH_DOLLY||(this._state&D.TOUCH_ZOOM)===D.TOUCH_ZOOM||(this._state&D.TOUCH_DOLLY_TRUCK)===D.TOUCH_DOLLY_TRUCK||(this._state&D.TOUCH_ZOOM_TRUCK)===D.TOUCH_ZOOM_TRUCK||(this._state&D.TOUCH_DOLLY_OFFSET)===D.TOUCH_DOLLY_OFFSET||(this._state&D.TOUCH_ZOOM_OFFSET)===D.TOUCH_ZOOM_OFFSET||(this._state&D.TOUCH_DOLLY_ROTATE)===D.TOUCH_DOLLY_ROTATE||(this._state&D.TOUCH_ZOOM_ROTATE)===D.TOUCH_ZOOM_ROTATE){let e=a.x-this._activePointers[1].clientX,t=a.y-this._activePointers[1].clientY,n=Math.sqrt(e*e+t*t),i=o.y-n;o.set(0,n);let s=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,l=this.dollyToCursor?-((r.y-this._elementRect.y)/this._elementRect.height*2)+1:0;(this._state&D.TOUCH_DOLLY)===D.TOUCH_DOLLY||(this._state&D.TOUCH_DOLLY_ROTATE)===D.TOUCH_DOLLY_ROTATE||(this._state&D.TOUCH_DOLLY_TRUCK)===D.TOUCH_DOLLY_TRUCK||(this._state&D.TOUCH_DOLLY_OFFSET)===D.TOUCH_DOLLY_OFFSET?(this._dollyInternal(i*X,s,l),this._isUserControllingDolly=!0):(this._zoomInternal(i*X,s,l),this._isUserControllingZoom=!0)}((this._state&D.TRUCK)===D.TRUCK||(this._state&D.TOUCH_TRUCK)===D.TOUCH_TRUCK||(this._state&D.TOUCH_DOLLY_TRUCK)===D.TOUCH_DOLLY_TRUCK||(this._state&D.TOUCH_ZOOM_TRUCK)===D.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(t,i,!1),this._isUserControllingTruck=!0),((this._state&D.OFFSET)===D.OFFSET||(this._state&D.TOUCH_OFFSET)===D.TOUCH_OFFSET||(this._state&D.TOUCH_DOLLY_OFFSET)===D.TOUCH_DOLLY_OFFSET||(this._state&D.TOUCH_ZOOM_OFFSET)===D.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(t,i,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},E=()=>{W(this._activePointers,a),r.copy(a),this._dragNeedsUpdate=!1,(0===this._activePointers.length||1===this._activePointers.length&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),0===this._activePointers.length&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",d),this._domElement.ownerDocument.removeEventListener("pointerup",f),this._domElement.ownerDocument.removeEventListener("mouseup",p),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{this._enabled&&this._domElement&&(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",f),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",b),this._domElement.ownerDocument.addEventListener("pointerlockerror",O),this._domElement.ownerDocument.addEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",f),g())},this.unlockPointer=()=>{null!==this._lockedPointer&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),document.exitPointerLock(),this.cancel(),this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointerlockchange",b),this._domElement.ownerDocument.removeEventListener("pointerlockerror",O))};let b=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},O=()=>{this.unlockPointer()};this._addAllEventListeners=e=>{this._domElement=e,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",c),Q&&this._domElement.addEventListener("mousedown",h),this._domElement.addEventListener("pointercancel",f),this._domElement.addEventListener("wheel",_,{passive:!1}),this._domElement.addEventListener("contextmenu",v)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",c),this._domElement.removeEventListener("mousedown",h),this._domElement.removeEventListener("pointercancel",f),this._domElement.removeEventListener("wheel",_,{passive:!1}),this._domElement.removeEventListener("contextmenu",v),this._domElement.ownerDocument.removeEventListener("pointermove",u,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",d),this._domElement.ownerDocument.removeEventListener("pointerup",f),this._domElement.ownerDocument.removeEventListener("mouseup",p),this._domElement.ownerDocument.removeEventListener("pointerlockchange",b),this._domElement.ownerDocument.removeEventListener("pointerlockerror",O))},this.cancel=()=>{this._state!==D.NONE&&(this._state=D.NONE,this._activePointers.length=0,E())},t&&this.connect(t),this.update(0)}}let $=(0,L.forwardRef)((e,t)=>{(0,L.useMemo)(()=>{let e={Box3:C.Box3,MathUtils:{clamp:C.MathUtils.clamp},Matrix4:C.Matrix4,Quaternion:C.Quaternion,Raycaster:C.Raycaster,Sphere:C.Sphere,Spherical:C.Spherical,Vector2:C.Vector2,Vector3:C.Vector3,Vector4:C.Vector4};J.install({THREE:e}),(0,P.e)({CameraControlsImpl:J})},[]);let{camera:n,domElement:i,makeDefault:r,onStart:s,onEnd:o,onChange:a,regress:l,...c}=e,h=(0,P.z)(e=>e.camera),u=(0,P.z)(e=>e.gl),d=(0,P.z)(e=>e.invalidate),f=(0,P.z)(e=>e.events),p=(0,P.z)(e=>e.setEvents),m=(0,P.z)(e=>e.set),_=(0,P.z)(e=>e.get),v=(0,P.z)(e=>e.performance),g=n||h,y=i||f.connected||u.domElement,E=(0,L.useMemo)(()=>new J(g),[g]);return(0,P.A)((e,t)=>{E.enabled&&E.update(t)},-1),(0,L.useEffect)(()=>(E.connect(y),()=>void E.disconnect()),[y,E]),(0,L.useEffect)(()=>{let e=e=>{d(),l&&v.regress(),a&&a(e)},t=e=>{s&&s(e)},n=e=>{o&&o(e)};return E.addEventListener("update",e),E.addEventListener("controlstart",t),E.addEventListener("controlend",n),E.addEventListener("control",e),E.addEventListener("transitionstart",e),E.addEventListener("wake",e),()=>{E.removeEventListener("update",e),E.removeEventListener("controlstart",t),E.removeEventListener("controlend",n),E.removeEventListener("control",e),E.removeEventListener("transitionstart",e),E.removeEventListener("wake",e)}},[E,s,o,d,p,l,a]),(0,L.useEffect)(()=>{if(r){let e=_().controls;return m({controls:E}),()=>m({controls:e})}},[r,E]),L.createElement("primitive",(0,S.Z)({ref:t,object:E},c))})},2997:function(e,t,n){let i,r,s,o;n.d(t,{x:function(){return D}});var a=n(2110),l=n(4090),c=n(6376),h=n(1653);let u=new c.Box3,d=new c.Vector3;class f extends c.InstancedBufferGeometry{applyMatrix4(e){let t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));let n=new c.InstancedInterleavedBuffer(t,6,1);return this.setAttribute("instanceStart",new c.InterleavedBufferAttribute(n,3,0)),this.setAttribute("instanceEnd",new c.InterleavedBufferAttribute(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));let i=new c.InstancedInterleavedBuffer(t,2*n,1);return this.setAttribute("instanceColorStart",new c.InterleavedBufferAttribute(i,n,0)),this.setAttribute("instanceColorEnd",new c.InterleavedBufferAttribute(i,n,n)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new c.WireframeGeometry(e.geometry)),this}fromLineSegments(e){let t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new c.Box3);let e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),u.setFromBufferAttribute(t),this.boundingBox.union(u))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new c.Sphere),null===this.boundingBox&&this.computeBoundingBox();let e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){let n=this.boundingSphere.center;this.boundingBox.getCenter(n);let i=0;for(let r=0,s=e.count;r<s;r++)d.fromBufferAttribute(e,r),i=Math.max(i,n.distanceToSquared(d)),d.fromBufferAttribute(t,r),i=Math.max(i,n.distanceToSquared(d));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry",this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new c.Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new c.Float32BufferAttribute([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}}class p extends c.ShaderMaterial{constructor(e){super({type:"LineMaterial",uniforms:c.UniformsUtils.clone(c.UniformsUtils.merge([c.UniformsLib.common,c.UniformsLib.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new c.Vector2(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:"\n				#include <common>\n				#include <fog_pars_vertex>\n				#include <logdepthbuf_pars_vertex>\n				#include <clipping_planes_pars_vertex>\n\n				uniform float linewidth;\n				uniform vec2 resolution;\n\n				attribute vec3 instanceStart;\n				attribute vec3 instanceEnd;\n\n				#ifdef USE_COLOR\n					#ifdef USE_LINE_COLOR_ALPHA\n						varying vec4 vLineColor;\n						attribute vec4 instanceColorStart;\n						attribute vec4 instanceColorEnd;\n					#else\n						varying vec3 vLineColor;\n						attribute vec3 instanceColorStart;\n						attribute vec3 instanceColorEnd;\n					#endif\n				#endif\n\n				#ifdef WORLD_UNITS\n\n					varying vec4 worldPos;\n					varying vec3 worldStart;\n					varying vec3 worldEnd;\n\n					#ifdef USE_DASH\n\n						varying vec2 vUv;\n\n					#endif\n\n				#else\n\n					varying vec2 vUv;\n\n				#endif\n\n				#ifdef USE_DASH\n\n					uniform float dashScale;\n					attribute float instanceDistanceStart;\n					attribute float instanceDistanceEnd;\n					varying float vLineDistance;\n\n				#endif\n\n				void trimSegment( const in vec4 start, inout vec4 end ) {\n\n					// trim end segment so it terminates between the camera plane and the near plane\n\n					// conservative estimate of the near plane\n					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n					float nearEstimate = - 0.5 * b / a;\n\n					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n					end.xyz = mix( start.xyz, end.xyz, alpha );\n\n				}\n\n				void main() {\n\n					#ifdef USE_COLOR\n\n						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n					#endif\n\n					#ifdef USE_DASH\n\n						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n						vUv = uv;\n\n					#endif\n\n					float aspect = resolution.x / resolution.y;\n\n					// camera space\n					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n					#ifdef WORLD_UNITS\n\n						worldStart = start.xyz;\n						worldEnd = end.xyz;\n\n					#else\n\n						vUv = uv;\n\n					#endif\n\n					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n					// perhaps there is a more elegant solution -- WestLangley\n\n					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n					if ( perspective ) {\n\n						if ( start.z < 0.0 && end.z >= 0.0 ) {\n\n							trimSegment( start, end );\n\n						} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n							trimSegment( end, start );\n\n						}\n\n					}\n\n					// clip space\n					vec4 clipStart = projectionMatrix * start;\n					vec4 clipEnd = projectionMatrix * end;\n\n					// ndc space\n					vec3 ndcStart = clipStart.xyz / clipStart.w;\n					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n					// direction\n					vec2 dir = ndcEnd.xy - ndcStart.xy;\n\n					// account for clip-space aspect ratio\n					dir.x *= aspect;\n					dir = normalize( dir );\n\n					#ifdef WORLD_UNITS\n\n						// get the offset direction as perpendicular to the view vector\n						vec3 worldDir = normalize( end.xyz - start.xyz );\n						vec3 offset;\n						if ( position.y < 0.5 ) {\n\n							offset = normalize( cross( start.xyz, worldDir ) );\n\n						} else {\n\n							offset = normalize( cross( end.xyz, worldDir ) );\n\n						}\n\n						// sign flip\n						if ( position.x < 0.0 ) offset *= - 1.0;\n\n						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );\n\n						// don't extend the line if we're rendering dashes because we\n						// won't be rendering the endcaps\n						#ifndef USE_DASH\n\n							// extend the line bounds to encompass  endcaps\n							start.xyz += - worldDir * linewidth * 0.5;\n							end.xyz += worldDir * linewidth * 0.5;\n\n							// shift the position of the quad so it hugs the forward edge of the line\n							offset.xy -= dir * forwardOffset;\n							offset.z += 0.5;\n\n						#endif\n\n						// endcaps\n						if ( position.y > 1.0 || position.y < 0.0 ) {\n\n							offset.xy += dir * 2.0 * forwardOffset;\n\n						}\n\n						// adjust for linewidth\n						offset *= linewidth * 0.5;\n\n						// set the world position\n						worldPos = ( position.y < 0.5 ) ? start : end;\n						worldPos.xyz += offset;\n\n						// project the worldpos\n						vec4 clip = projectionMatrix * worldPos;\n\n						// shift the depth of the projected points so the line\n						// segments overlap neatly\n						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n						clip.z = clipPose.z * clip.w;\n\n					#else\n\n						vec2 offset = vec2( dir.y, - dir.x );\n						// undo aspect ratio adjustment\n						dir.x /= aspect;\n						offset.x /= aspect;\n\n						// sign flip\n						if ( position.x < 0.0 ) offset *= - 1.0;\n\n						// endcaps\n						if ( position.y < 0.0 ) {\n\n							offset += - dir;\n\n						} else if ( position.y > 1.0 ) {\n\n							offset += dir;\n\n						}\n\n						// adjust for linewidth\n						offset *= linewidth;\n\n						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n						offset /= resolution.y;\n\n						// select end\n						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n						// back to clip space\n						offset *= clip.w;\n\n						clip.xy += offset;\n\n					#endif\n\n					gl_Position = clip;\n\n					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n					#include <logdepthbuf_vertex>\n					#include <clipping_planes_vertex>\n					#include <fog_vertex>\n\n				}\n			",fragmentShader:"\n				uniform vec3 diffuse;\n				uniform float opacity;\n				uniform float linewidth;\n\n				#ifdef USE_DASH\n\n					uniform float dashOffset;\n					uniform float dashSize;\n					uniform float gapSize;\n\n				#endif\n\n				varying float vLineDistance;\n\n				#ifdef WORLD_UNITS\n\n					varying vec4 worldPos;\n					varying vec3 worldStart;\n					varying vec3 worldEnd;\n\n					#ifdef USE_DASH\n\n						varying vec2 vUv;\n\n					#endif\n\n				#else\n\n					varying vec2 vUv;\n\n				#endif\n\n				#include <common>\n				#include <fog_pars_fragment>\n				#include <logdepthbuf_pars_fragment>\n				#include <clipping_planes_pars_fragment>\n\n				#ifdef USE_COLOR\n					#ifdef USE_LINE_COLOR_ALPHA\n						varying vec4 vLineColor;\n					#else\n						varying vec3 vLineColor;\n					#endif\n				#endif\n\n				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n					float mua;\n					float mub;\n\n					vec3 p13 = p1 - p3;\n					vec3 p43 = p4 - p3;\n\n					vec3 p21 = p2 - p1;\n\n					float d1343 = dot( p13, p43 );\n					float d4321 = dot( p43, p21 );\n					float d1321 = dot( p13, p21 );\n					float d4343 = dot( p43, p43 );\n					float d2121 = dot( p21, p21 );\n\n					float denom = d2121 * d4343 - d4321 * d4321;\n\n					float numer = d1343 * d4321 - d1321 * d4343;\n\n					mua = numer / denom;\n					mua = clamp( mua, 0.0, 1.0 );\n					mub = ( d1343 + d4321 * ( mua ) ) / d4343;\n					mub = clamp( mub, 0.0, 1.0 );\n\n					return vec2( mua, mub );\n\n				}\n\n				void main() {\n\n					#include <clipping_planes_fragment>\n\n					#ifdef USE_DASH\n\n						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n					#endif\n\n					float alpha = opacity;\n\n					#ifdef WORLD_UNITS\n\n						// Find the closest points on the view ray and the line segment\n						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n						vec3 lineDir = worldEnd - worldStart;\n						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n						vec3 p1 = worldStart + lineDir * params.x;\n						vec3 p2 = rayEnd * params.y;\n						vec3 delta = p1 - p2;\n						float len = length( delta );\n						float norm = len / linewidth;\n\n						#ifndef USE_DASH\n\n							#ifdef USE_ALPHA_TO_COVERAGE\n\n								float dnorm = fwidth( norm );\n								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n							#else\n\n								if ( norm > 0.5 ) {\n\n									discard;\n\n								}\n\n							#endif\n\n						#endif\n\n					#else\n\n						#ifdef USE_ALPHA_TO_COVERAGE\n\n							// artifacts appear on some hardware if a derivative is taken within a conditional\n							float a = vUv.x;\n							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n							float len2 = a * a + b * b;\n							float dlen = fwidth( len2 );\n\n							if ( abs( vUv.y ) > 1.0 ) {\n\n								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n							}\n\n						#else\n\n							if ( abs( vUv.y ) > 1.0 ) {\n\n								float a = vUv.x;\n								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n								float len2 = a * a + b * b;\n\n								if ( len2 > 1.0 ) discard;\n\n							}\n\n						#endif\n\n					#endif\n\n					vec4 diffuseColor = vec4( diffuse, alpha );\n					#ifdef USE_COLOR\n						#ifdef USE_LINE_COLOR_ALPHA\n							diffuseColor *= vLineColor;\n						#else\n							diffuseColor.rgb *= vLineColor;\n						#endif\n					#endif\n\n					#include <logdepthbuf_fragment>\n\n					gl_FragColor = diffuseColor;\n\n					#include <tonemapping_fragment>\n					#include <".concat(parseInt(c.REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment",">\n					#include <fog_fragment>\n					#include <premultiplied_alpha_fragment>\n\n				}\n			"),clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(e){!0===e?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth.value=e}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(e){!!e!="USE_DASH"in this.defines&&(this.needsUpdate=!0),!0===e?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(e){this.uniforms.dashOffset.value=e}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(e){!!e!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),!0===e?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}let m=new c.Vector3,_=new c.Vector3,v=new c.Vector4,g=new c.Vector4,y=new c.Vector4,E=new c.Vector3,b=new c.Matrix4,O=new c.Line3,w=new c.Vector3,T=new c.Box3,x=new c.Sphere,S=new c.Vector4;function C(e,t,n){return S.set(0,0,-t,1).applyMatrix4(e.projectionMatrix),S.multiplyScalar(1/S.w),S.x=o/n.width,S.y=o/n.height,S.applyMatrix4(e.projectionMatrixInverse),S.multiplyScalar(1/S.w),Math.abs(Math.max(S.x,S.y))}class L extends c.Mesh{computeLineDistances(){let e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,i=new Float32Array(2*t.count);for(let e=0,r=0,s=t.count;e<s;e++,r+=2)m.fromBufferAttribute(t,e),_.fromBufferAttribute(n,e),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+m.distanceTo(_);let r=new c.InstancedInterleavedBuffer(i,2,1);return e.setAttribute("instanceDistanceStart",new c.InterleavedBufferAttribute(r,1,0)),e.setAttribute("instanceDistanceEnd",new c.InterleavedBufferAttribute(r,1,1)),this}raycast(e,t){let n,a;let l=this.material.worldUnits,h=e.camera;null!==h||l||console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');let u=void 0!==e.params.Line2&&e.params.Line2.threshold||0;i=e.ray;let d=this.matrixWorld,f=this.geometry,p=this.material;if(o=p.linewidth+u,r=f.attributes.instanceStart,s=f.attributes.instanceEnd,null===f.boundingSphere&&f.computeBoundingSphere(),x.copy(f.boundingSphere).applyMatrix4(d),l)n=.5*o;else{let e=Math.max(h.near,x.distanceToPoint(i.origin));n=C(h,e,p.resolution)}if(x.radius+=n,!1!==i.intersectsSphere(x)){if(null===f.boundingBox&&f.computeBoundingBox(),T.copy(f.boundingBox).applyMatrix4(d),l)a=.5*o;else{let e=Math.max(h.near,T.distanceToPoint(i.origin));a=C(h,e,p.resolution)}T.expandByScalar(a),!1!==i.intersectsBox(T)&&(l?function(e,t){for(let n=0,a=r.count;n<a;n++){O.start.fromBufferAttribute(r,n),O.end.fromBufferAttribute(s,n);let a=new c.Vector3,l=new c.Vector3;i.distanceSqToSegment(O.start,O.end,l,a),l.distanceTo(a)<.5*o&&t.push({point:l,pointOnLine:a,distance:i.origin.distanceTo(l),object:e,face:null,faceIndex:n,uv:null,uv2:null})}}(this,t):function(e,t,n){let r=t.projectionMatrix,s=e.material.resolution,a=e.matrixWorld,l=e.geometry,h=l.attributes.instanceStart,u=l.attributes.instanceEnd,d=-t.near;i.at(1,y),y.w=1,y.applyMatrix4(t.matrixWorldInverse),y.applyMatrix4(r),y.multiplyScalar(1/y.w),y.x*=s.x/2,y.y*=s.y/2,y.z=0,E.copy(y),b.multiplyMatrices(t.matrixWorldInverse,a);for(let t=0,l=h.count;t<l;t++){if(v.fromBufferAttribute(h,t),g.fromBufferAttribute(u,t),v.w=1,g.w=1,v.applyMatrix4(b),g.applyMatrix4(b),v.z>d&&g.z>d)continue;if(v.z>d){let e=v.z-g.z,t=(v.z-d)/e;v.lerp(g,t)}else if(g.z>d){let e=g.z-v.z,t=(g.z-d)/e;g.lerp(v,t)}v.applyMatrix4(r),g.applyMatrix4(r),v.multiplyScalar(1/v.w),g.multiplyScalar(1/g.w),v.x*=s.x/2,v.y*=s.y/2,g.x*=s.x/2,g.y*=s.y/2,O.start.copy(v),O.start.z=0,O.end.copy(g),O.end.z=0;let l=O.closestPointToPointParameter(E,!0);O.at(l,w);let f=c.MathUtils.lerp(v.z,g.z,l),p=f>=-1&&f<=1,m=E.distanceTo(w)<.5*o;if(p&&m){O.start.fromBufferAttribute(h,t),O.end.fromBufferAttribute(u,t),O.start.applyMatrix4(a),O.end.applyMatrix4(a);let r=new c.Vector3,s=new c.Vector3;i.distanceSqToSegment(O.start,O.end,s,r),n.push({point:s,pointOnLine:r,distance:i.origin.distanceTo(s),object:e,face:null,faceIndex:t,uv:null,uv2:null})}}}(this,h,t))}}constructor(e=new f,t=new p({color:16777215*Math.random()})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}}class P extends f{setPositions(e){let t=e.length-3,n=new Float32Array(2*t);for(let i=0;i<t;i+=3)n[2*i]=e[i],n[2*i+1]=e[i+1],n[2*i+2]=e[i+2],n[2*i+3]=e[i+3],n[2*i+4]=e[i+4],n[2*i+5]=e[i+5];return super.setPositions(n),this}setColors(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=e.length-t,i=new Float32Array(2*n);if(3===t)for(let r=0;r<n;r+=t)i[2*r]=e[r],i[2*r+1]=e[r+1],i[2*r+2]=e[r+2],i[2*r+3]=e[r+3],i[2*r+4]=e[r+4],i[2*r+5]=e[r+5];else for(let r=0;r<n;r+=t)i[2*r]=e[r],i[2*r+1]=e[r+1],i[2*r+2]=e[r+2],i[2*r+3]=e[r+3],i[2*r+4]=e[r+4],i[2*r+5]=e[r+5],i[2*r+6]=e[r+6],i[2*r+7]=e[r+7];return super.setColors(i,t),this}fromLine(e){let t=e.geometry;return this.setPositions(t.attributes.position.array),this}constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}}class A extends L{constructor(e=new P,t=new p({color:16777215*Math.random()})){super(e,t),this.isLine2=!0,this.type="Line2"}}let D=l.forwardRef(function(e,t){var n;let{points:i,color:r="black",vertexColors:s,linewidth:o,lineWidth:u,segments:d,dashed:m,..._}=e,v=(0,h.z)(e=>e.size),g=l.useMemo(()=>d?new L:new A,[d]),[y]=l.useState(()=>new p),E=(null==s||null==(n=s[0])?void 0:n.length)===4?4:3,b=l.useMemo(()=>{let e=d?new f:new P,t=i.map(e=>{let t=Array.isArray(e);return e instanceof c.Vector3||e instanceof c.Vector4?[e.x,e.y,e.z]:e instanceof c.Vector2?[e.x,e.y,0]:t&&3===e.length?[e[0],e[1],e[2]]:t&&2===e.length?[e[0],e[1],0]:e});if(e.setPositions(t.flat()),s){let t=s.map(e=>e instanceof c.Color?e.toArray():e);e.setColors(t.flat(),E)}return e},[i,d,s,E]);return l.useLayoutEffect(()=>{g.computeLineDistances()},[i,g]),l.useLayoutEffect(()=>{m?y.defines.USE_DASH="":delete y.defines.USE_DASH,y.needsUpdate=!0},[m,y]),l.useEffect(()=>()=>b.dispose(),[b]),l.createElement("primitive",(0,a.Z)({object:g,ref:t},_),l.createElement("primitive",{object:b,attach:"geometry"}),l.createElement("primitive",(0,a.Z)({object:y,attach:"material",color:r,vertexColors:!!s,resolution:[v.width,v.height],linewidth:null!=o?o:u,dashed:m,transparent:4===E},_)))})},4728:function(e,t,n){n.d(t,{q:function(){return o}});var i=n(6376),r=n(4090),s=n(1653);function o(e){let{all:t,scene:n,camera:o}=e,a=(0,s.z)(e=>{let{gl:t}=e;return t}),l=(0,s.z)(e=>{let{camera:t}=e;return t}),c=(0,s.z)(e=>{let{scene:t}=e;return t});return r.useLayoutEffect(()=>{let e=[];t&&(n||c).traverse(t=>{!1===t.visible&&(e.push(t),t.visible=!0)}),a.compile(n||c,o||l);let r=new i.WebGLCubeRenderTarget(128);new i.CubeCamera(.01,1e5,r).update(a,n||c),r.dispose(),e.forEach(e=>e.visible=!1)},[]),null}},2311:function(e,t,n){n.d(t,{KC:function(){return s}});var i=n(2110),r=n(4090);let s=function(e,t){let n=e+"Geometry";return r.forwardRef((e,s)=>{let{args:o,children:a,...l}=e,c=r.useRef(null);return r.useImperativeHandle(s,()=>c.current),r.useLayoutEffect(()=>void(null==t||t(c.current))),r.createElement("mesh",(0,i.Z)({ref:c},l),r.createElement(n,{attach:"geometry",args:o}),a)})}("torus")},7032:function(e,t,n){n.d(t,{S:function(){return a}});var i=n(6376),r=n(4090);let s=!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?r.useEffect:r.useLayoutEffect,o=0,a=function(e){let t="function"==typeof e?function(e){let t;let n=new Set,i=(e,i)=>{let r="function"==typeof e?e(t):e;if(r!==t){let e=t;t=i?r:Object.assign({},t,r),n.forEach(n=>n(t,e))}},r=()=>t,s=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is;console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let o=i(t);function a(){let n=i(t);if(!s(o,n)){let t=o;e(o=n,t)}}return n.add(a),()=>n.delete(a)},o={setState:i,getState:r,subscribe:(e,t,i)=>t||i?s(e,t,i):(n.add(e),()=>n.delete(e)),destroy:()=>n.clear()};return t=e(i,r,o),o}(e):e,n=function(){let e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.getState,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is,[,o]=(0,r.useReducer)(e=>e+1,0),a=t.getState(),l=(0,r.useRef)(a),c=(0,r.useRef)(n),h=(0,r.useRef)(i),u=(0,r.useRef)(!1),d=(0,r.useRef)();void 0===d.current&&(d.current=n(a));let f=!1;(l.current!==a||c.current!==n||h.current!==i||u.current)&&(e=n(a),f=!i(d.current,e)),s(()=>{f&&(d.current=e),l.current=a,c.current=n,h.current=i,u.current=!1});let p=(0,r.useRef)(a);s(()=>{let e=()=>{try{let e=t.getState(),n=c.current(e);h.current(d.current,n)||(l.current=e,d.current=n,o())}catch(e){u.current=!0,o()}},n=t.subscribe(e);return t.getState()!==p.current&&e(),n},[]);let m=f?e:d.current;return(0,r.useDebugValue)(m),m};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");let e=[n,t];return{next(){let t=e.length<=0;return{value:e.shift(),done:t}}}},n}(e=>(i.DefaultLoadingManager.onStart=(t,n,i)=>{e({active:!0,item:t,loaded:n,total:i,progress:(n-o)/(i-o)*100})},i.DefaultLoadingManager.onLoad=()=>{e({active:!1})},i.DefaultLoadingManager.onError=t=>e(e=>({errors:[...e.errors,t]})),i.DefaultLoadingManager.onProgress=(t,n,i)=>{n===i&&(o=i),e({active:!0,item:t,loaded:n,total:i,progress:(n-o)/(i-o)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}))},7475:function(e,t,n){n.d(t,{m:function(){return a}});var i=n(6376),r=n(1653),s=n(4090);let o=e=>e===Object(e)&&!Array.isArray(e)&&"function"!=typeof e;function a(e,t){let n=(0,r.z)(e=>e.gl),a=(0,r.D)(i.TextureLoader,o(e)?Object.values(e):e);if((0,s.useLayoutEffect)(()=>{null==t||t(a)},[t]),(0,s.useEffect)(()=>{"initTexture"in n&&(Array.isArray(a)?a:[a]).forEach(n.initTexture)},[n,a]),!o(e))return a;{let t={},n=0;for(let i in e)t[i]=a[n++];return t}}a.preload=e=>r.D.preload(i.TextureLoader,e),a.clear=e=>r.D.clear(i.TextureLoader,e)},6959:function(e,t,n){n.d(t,{V:function(){return g}});var i,r,s=n(2110),o=n(4090),a=n(7600),l=n(6376),c=n(1653);let h=new l.Vector3,u=new l.Vector3,d=new l.Vector3;function f(e,t,n){let i=h.setFromMatrixPosition(e.matrixWorld);i.project(t);let r=n.width/2,s=n.height/2;return[i.x*r+r,-(i.y*s)+s]}let p=e=>1e-10>Math.abs(e)?0:e;function m(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i="matrix3d(";for(let n=0;16!==n;n++)i+=p(t[n]*e.elements[n])+(15!==n?",":")");return n+i}let _=(i=[1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1],e=>m(e,i)),v=(r=e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1],(e,t)=>m(e,r(t),"translate(-50%,-50%)")),g=o.forwardRef((e,t)=>{let{children:n,eps:i=.001,style:r,className:m,prepend:g,center:y,fullscreen:E,portal:b,distanceFactor:O,sprite:w=!1,transform:T=!1,occlude:x,onOcclude:S,castShadow:C,receiveShadow:L,material:P,geometry:A,zIndexRange:D=[16777271,0],calculatePosition:M=f,as:U="div",wrapperClass:z,pointerEvents:R="auto",...F}=e,{gl:I,camera:k,scene:H,size:j,raycaster:V,events:B,viewport:N}=(0,c.z)(),[Y]=o.useState(()=>document.createElement(U)),Z=o.useRef(),W=o.useRef(null),G=o.useRef(0),K=o.useRef([0,0]),X=o.useRef(null),q=o.useRef(null),Q=(null==b?void 0:b.current)||B.connected||I.domElement.parentNode,J=o.useRef(null),$=o.useRef(!1),ee=o.useMemo(()=>{var e;return x&&"blending"!==x||Array.isArray(x)&&x.length&&(e=x[0])&&"object"==typeof e&&"current"in e},[x]);o.useLayoutEffect(()=>{let e=I.domElement;x&&"blending"===x?(e.style.zIndex="".concat(Math.floor(D[0]/2)),e.style.position="absolute",e.style.pointerEvents="none"):(e.style.zIndex=null,e.style.position=null,e.style.pointerEvents=null)},[x]),o.useLayoutEffect(()=>{if(W.current){let e=Z.current=a.createRoot(Y);if(H.updateMatrixWorld(),T)Y.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{let e=M(W.current,k,j);Y.style.cssText="position:absolute;top:0;left:0;transform:translate3d(".concat(e[0],"px,").concat(e[1],"px,0);transform-origin:0 0;")}return Q&&(g?Q.prepend(Y):Q.appendChild(Y)),()=>{Q&&Q.removeChild(Y),e.unmount()}}},[Q,T]),o.useLayoutEffect(()=>{z&&(Y.className=z)},[z]);let et=o.useMemo(()=>T?{position:"absolute",top:0,left:0,width:j.width,height:j.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:y?"translate3d(-50%,-50%,0)":"none",...E&&{top:-j.height/2,left:-j.width/2,width:j.width,height:j.height},...r},[r,y,E,j,T]),en=o.useMemo(()=>({position:"absolute",pointerEvents:R}),[R]);o.useLayoutEffect(()=>{var e,i;$.current=!1,T?null==(e=Z.current)||e.render(o.createElement("div",{ref:X,style:et},o.createElement("div",{ref:q,style:en},o.createElement("div",{ref:t,className:m,style:r,children:n})))):null==(i=Z.current)||i.render(o.createElement("div",{ref:t,style:et,className:m,children:n}))});let ei=o.useRef(!0);(0,c.A)(e=>{if(W.current){k.updateMatrixWorld(),W.current.updateWorldMatrix(!0,!1);let e=T?K.current:M(W.current,k,j);if(T||Math.abs(G.current-k.zoom)>i||Math.abs(K.current[0]-e[0])>i||Math.abs(K.current[1]-e[1])>i){let t=function(e,t){let n=h.setFromMatrixPosition(e.matrixWorld),i=u.setFromMatrixPosition(t.matrixWorld),r=n.sub(i),s=t.getWorldDirection(d);return r.angleTo(s)>Math.PI/2}(W.current,k),n=!1;ee&&(Array.isArray(x)?n=x.map(e=>e.current):"blending"!==x&&(n=[H]));let i=ei.current;if(n){let e=function(e,t,n,i){let r=h.setFromMatrixPosition(e.matrixWorld),s=r.clone();s.project(t),n.setFromCamera(s,t);let o=n.intersectObjects(i,!0);if(o.length){let e=o[0].distance;return r.distanceTo(n.ray.origin)<e}return!0}(W.current,k,V,n);ei.current=e&&!t}else ei.current=!t;i!==ei.current&&(S?S(!ei.current):Y.style.display=ei.current?"block":"none");let r=Math.floor(D[0]/2),s=x?ee?[D[0],r]:[r-1,0]:D;if(Y.style.zIndex="".concat(function(e,t,n){if(t instanceof l.PerspectiveCamera||t instanceof l.OrthographicCamera){let i=h.setFromMatrixPosition(e.matrixWorld),r=u.setFromMatrixPosition(t.matrixWorld),s=i.distanceTo(r),o=(n[1]-n[0])/(t.far-t.near),a=n[1]-o*t.far;return Math.round(o*s+a)}}(W.current,k,s)),T){let[e,t]=[j.width/2,j.height/2],n=k.projectionMatrix.elements[5]*t,{isOrthographicCamera:i,top:r,left:s,bottom:o,right:a}=k,l=_(k.matrixWorldInverse),c=i?"scale(".concat(n,")translate(").concat(p(-(a+s)/2),"px,").concat(p((r+o)/2),"px)"):"translateZ(".concat(n,"px)"),h=W.current.matrixWorld;w&&((h=k.matrixWorldInverse.clone().transpose().copyPosition(h).scale(W.current.scale)).elements[3]=h.elements[7]=h.elements[11]=0,h.elements[15]=1),Y.style.width=j.width+"px",Y.style.height=j.height+"px",Y.style.perspective=i?"":"".concat(n,"px"),X.current&&q.current&&(X.current.style.transform="".concat(c).concat(l,"translate(").concat(e,"px,").concat(t,"px)"),q.current.style.transform=v(h,1/((O||10)/400)))}else{let t=void 0===O?1:function(e,t){if(t instanceof l.OrthographicCamera)return t.zoom;if(!(t instanceof l.PerspectiveCamera))return 1;{let n=h.setFromMatrixPosition(e.matrixWorld),i=u.setFromMatrixPosition(t.matrixWorld);return 1/(2*Math.tan(t.fov*Math.PI/180/2)*n.distanceTo(i))}}(W.current,k)*O;Y.style.transform="translate3d(".concat(e[0],"px,").concat(e[1],"px,0) scale(").concat(t,")")}K.current=e,G.current=k.zoom}}if(!ee&&J.current&&!$.current){if(T){if(X.current){let e=X.current.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){let{isOrthographicCamera:t}=k;if(t||A)F.scale&&(Array.isArray(F.scale)?F.scale instanceof l.Vector3?J.current.scale.copy(F.scale.clone().divideScalar(1)):J.current.scale.set(1/F.scale[0],1/F.scale[1],1/F.scale[2]):J.current.scale.setScalar(1/F.scale));else{let t=(O||10)/400,n=e.clientWidth*t,i=e.clientHeight*t;J.current.scale.set(n,i,1)}$.current=!0}}}else{let t=Y.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){let e=1/N.factor,n=t.clientWidth*e,i=t.clientHeight*e;J.current.scale.set(n,i,1),$.current=!0}J.current.lookAt(e.camera.position)}}});let er=o.useMemo(()=>({vertexShader:T?void 0:'\n          /*\n            This shader is from the THREE\'s SpriteMaterial.\n            We need to turn the backing plane into a Sprite\n            (make it always face the camera) if "transfrom" \n            is false. \n          */\n          #include <common>\n\n          void main() {\n            vec2 center = vec2(0., 1.);\n            float rotation = 0.0;\n            \n            // This is somewhat arbitrary, but it seems to work well\n            // Need to figure out how to derive this dynamically if it even matters\n            float size = 0.03;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n            vec2 scale;\n            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n            bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n            if ( isPerspective ) scale *= - mvPosition.z;\n\n            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n            vec2 rotatedPosition;\n            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n            mvPosition.xy += rotatedPosition;\n\n            gl_Position = projectionMatrix * mvPosition;\n          }\n      ',fragmentShader:"\n        void main() {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n      "}),[T]);return o.createElement("group",(0,s.Z)({},F,{ref:W}),x&&!ee&&o.createElement("mesh",{castShadow:C,receiveShadow:L,ref:J},A||o.createElement("planeGeometry",null),P||o.createElement("shaderMaterial",{side:l.DoubleSide,vertexShader:er.vertexShader,fragmentShader:er.fragmentShader})))})},1653:function(e,t,n){let i,r,s;n.d(t,{A:function(){return el},B:function(){return A},D:function(){return eh},E:function(){return D},a:function(){return L},b:function(){return eg},c:function(){return X},d:function(){return eE},e:function(){return w},i:function(){return C},u:function(){return P},x:function(){return es},z:function(){return ea}});var o,a,l=n(6376),c=n(4090),h=n(7777);let u=!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?c.useEffect:c.useLayoutEffect;var d=n(4812),f=n.n(d),p=n(9514);let m=e=>"object"==typeof e&&"function"==typeof e.then,_=[];function v(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;if(e===t)return!0;if(!e||!t)return!1;let i=e.length;if(t.length!==i)return!1;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};for(let r of(null===t&&(t=[e]),_))if(v(t,r.keys,r.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(r,"error"))throw r.error;if(Object.prototype.hasOwnProperty.call(r,"response"))return i.lifespan&&i.lifespan>0&&(r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout(r.remove,i.lifespan)),r.response;if(!n)throw r.promise}let r={keys:t,equal:i.equal,remove:()=>{let e=_.indexOf(r);-1!==e&&_.splice(e,1)},promise:(m(e)?e:e(...t)).then(e=>{r.response=e,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))}).catch(e=>r.error=e)};if(_.push(r),!n)throw r.promise}let y=(e,t,n)=>g(e,t,!1,n),E=(e,t,n)=>void g(e,t,!0,n),b=e=>{if(void 0===e||0===e.length)_.splice(0,_.length);else{let t=_.find(t=>v(e,t.keys,t.equal));t&&t.remove()}},O={},w=e=>void Object.assign(O,e),T=e=>"colorSpace"in e||"outputColorSpace"in e,x=()=>{var e;return null!=(e=O.ColorManagement)?e:null},S=e=>e&&e.isOrthographicCamera,C=e=>e&&e.hasOwnProperty("current"),L=null!=(o=window.document)&&o.createElement||(null==(a=window.navigator)?void 0:a.product)==="ReactNative"?c.useLayoutEffect:c.useEffect;function P(e){let t=c.useRef(e);return L(()=>void(t.current=e),[e]),t}function A(e){let{set:t}=e;return L(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class D extends c.Component{componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}constructor(...e){super(...e),this.state={error:!1}}}D.getDerivedStateFromError=()=>({error:!0});let M="__default",U=new Map,z=e=>e&&!!e.memoized&&!!e.changes;function R(e){var t;let n=null!=(t=window.devicePixelRatio)?t:2;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}let F=e=>{var t;return null==(t=e.__r3f)?void 0:t.root.getState()},I={obj:e=>e===Object(e)&&!I.arr(e)&&"function"!=typeof e,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,boo:e=>"boolean"==typeof e,und:e=>void 0===e,arr:e=>Array.isArray(e),equ(e,t){let n,{arrays:i="shallow",objects:r="reference",strict:s=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(typeof e!=typeof t||!!e!=!!t)return!1;if(I.str(e)||I.num(e))return e===t;let o=I.obj(e);if(o&&"reference"===r)return e===t;let a=I.arr(e);if(a&&"reference"===i)return e===t;if((a||o)&&e===t)return!0;for(n in e)if(!(n in t))return!1;if(o&&"shallow"===i&&"shallow"===r){for(n in s?t:e)if(!I.equ(e[n],t[n],{strict:s,objects:"reference"}))return!1}else for(n in s?t:e)if(e[n]!==t[n])return!1;if(I.und(n)){if(a&&0===e.length&&0===t.length||o&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function k(e,t){return e.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function H(e,t){let n=e;if(!t.includes("-"))return{target:n,key:t};{let i=t.split("-"),r=i.pop();return{target:n=i.reduce((e,t)=>e[t],e),key:r}}}let j=/-\d+$/;function V(e,t,n){if(I.str(n)){if(j.test(n)){let{target:t,key:i}=H(e,n.replace(j,""));Array.isArray(t[i])||(t[i]=[])}let{target:i,key:r}=H(e,n);t.__r3f.previousAttach=i[r],i[r]=t}else t.__r3f.previousAttach=n(e,t)}function B(e,t,n){var i,r;if(I.str(n)){let{target:i,key:r}=H(e,n),s=t.__r3f.previousAttach;void 0===s?delete i[r]:i[r]=s}else null==(i=t.__r3f)||null==i.previousAttach||i.previousAttach(e,t);null==(r=t.__r3f)||delete r.previousAttach}function N(e,t){var n;let{children:i,key:r,ref:s,...o}=t,{children:a,key:l,ref:c,...h}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],d=null!=(n=null==e?void 0:e.__r3f)?n:{},f=Object.entries(o),p=[];if(u){let e=Object.keys(h);for(let t=0;t<e.length;t++)o.hasOwnProperty(e[t])||f.unshift([e[t],M+"remove"])}f.forEach(t=>{var n;let[i,r]=t;if(null!=(n=e.__r3f)&&n.primitive&&"object"===i||I.equ(r,h[i]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(i))return p.push([i,r,!0,[]]);let s=[];for(let e in i.includes("-")&&(s=i.split("-")),p.push([i,r,!1,s]),o){let t=o[e];e.startsWith("".concat(i,"-"))&&p.push([e,t,!1,e.split("-")])}});let m={...o};return d.memoizedProps&&d.memoizedProps.args&&(m.args=d.memoizedProps.args),d.memoizedProps&&d.memoizedProps.attach&&(m.attach=d.memoizedProps.attach),{memoized:m,changes:p}}function Y(e,t){var n,i,r;let s=null!=(n=e.__r3f)?n:{},o=s.root,a=null!=(i=null==o?void 0:null==o.getState?void 0:o.getState())?i:{},{memoized:c,changes:h}=z(t)?t:N(e,t),u=s.eventCount;e.__r3f&&(e.__r3f.memoizedProps=c);for(let t=0;t<h.length;t++){let[n,i,r,o]=h[t];if(T(e)){let e="srgb",t="srgb-linear";"encoding"===n?(n="colorSpace",i=3001===i?e:t):"outputEncoding"===n&&(n="outputColorSpace",i=3001===i?e:t)}let c=e,u=c[n];if(o.length&&!((u=o.reduce((e,t)=>e[t],e))&&u.set)){let[t,...i]=o.reverse();c=i.reverse().reduce((e,t)=>e[t],e),n=t}if(i===M+"remove"){if(c.constructor){let e=U.get(c.constructor);e||(e=new c.constructor,U.set(c.constructor,e)),i=e[n]}else i=0}if(r)i?s.handlers[n]=i:delete s.handlers[n],s.eventCount=Object.keys(s.handlers).length;else if(u&&u.set&&(u.copy||u instanceof l.Layers)){if(Array.isArray(i))u.fromArray?u.fromArray(i):u.set(...i);else if(u.copy&&i&&i.constructor&&u.constructor===i.constructor)u.copy(i);else if(void 0!==i){let e=u instanceof l.Color;!e&&u.setScalar?u.setScalar(i):u instanceof l.Layers&&i instanceof l.Layers?u.mask=i.mask:u.set(i),x()||a.linear||!e||u.convertSRGBToLinear()}}else if(c[n]=i,c[n]instanceof l.Texture&&c[n].format===l.RGBAFormat&&c[n].type===l.UnsignedByteType){let e=c[n];T(e)&&T(a.gl)?e.colorSpace=a.gl.outputColorSpace:e.encoding=a.gl.outputEncoding}Z(e)}if(s.parent&&a.internal&&e.raycast&&u!==s.eventCount){let t=a.internal.interaction.indexOf(e);t>-1&&a.internal.interaction.splice(t,1),s.eventCount&&a.internal.interaction.push(e)}return!(1===h.length&&"onUpdate"===h[0][0])&&h.length&&null!=(r=e.__r3f)&&r.parent&&W(e),e}function Z(e){var t,n;let i=null==(t=e.__r3f)?void 0:null==(n=t.root)?void 0:null==n.getState?void 0:n.getState();i&&0===i.internal.frames&&i.invalidate()}function W(e){null==e.onUpdate||e.onUpdate(e)}function G(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function K(e,t,n,i){let r=n.get(t);r&&(n.delete(t),0===n.size&&(e.delete(i),r.target.releasePointerCapture(i)))}function X(e){function t(e){return e.filter(e=>["Move","Over","Enter","Out","Leave"].some(t=>{var n;return null==(n=e.__r3f)?void 0:n.handlers["onPointer"+t]}))}function n(t){let{internal:n}=e.getState();for(let e of n.hovered.values())if(!t.length||!t.find(t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId)){let i=e.eventObject.__r3f,r=null==i?void 0:i.handlers;if(n.hovered.delete(G(e)),null!=i&&i.eventCount){let n={...e,intersections:t};null==r.onPointerOut||r.onPointerOut(n),null==r.onPointerLeave||r.onPointerLeave(n)}}}function i(e,t){for(let n=0;n<t.length;n++){let i=t[n].__r3f;null==i||null==i.handlers.onPointerMissed||i.handlers.onPointerMissed(e)}}return{handlePointer:function(r){switch(r){case"onPointerLeave":case"onPointerCancel":return()=>n([]);case"onLostPointerCapture":return t=>{let{internal:i}=e.getState();"pointerId"in t&&i.capturedMap.has(t.pointerId)&&requestAnimationFrame(()=>{i.capturedMap.has(t.pointerId)&&(i.capturedMap.delete(t.pointerId),n([]))})}}return function(s){let{onPointerMissed:o,internal:a}=e.getState();a.lastEvent.current=s;let c="onPointerMove"===r,h="onClick"===r||"onContextMenu"===r||"onDoubleClick"===r,u=function(t,n){let i=e.getState(),r=new Set,s=[],o=n?n(i.internal.interaction):i.internal.interaction;for(let e=0;e<o.length;e++){let t=F(o[e]);t&&(t.raycaster.camera=void 0)}i.previousRoot||null==i.events.compute||i.events.compute(t,i);let a=o.flatMap(function(e){let n=F(e);if(!n||!n.events.enabled||null===n.raycaster.camera)return[];if(void 0===n.raycaster.camera){var i;null==n.events.compute||n.events.compute(t,n,null==(i=n.previousRoot)?void 0:i.getState()),void 0===n.raycaster.camera&&(n.raycaster.camera=null)}return n.raycaster.camera?n.raycaster.intersectObject(e,!0):[]}).sort((e,t)=>{let n=F(e.object),i=F(t.object);return n&&i&&i.events.priority-n.events.priority||e.distance-t.distance}).filter(e=>{let t=G(e);return!r.has(t)&&(r.add(t),!0)});for(let e of(i.events.filter&&(a=i.events.filter(a,i)),a)){let t=e.object;for(;t;){var l;null!=(l=t.__r3f)&&l.eventCount&&s.push({...e,eventObject:t}),t=t.parent}}if("pointerId"in t&&i.internal.capturedMap.has(t.pointerId))for(let e of i.internal.capturedMap.get(t.pointerId).values())r.has(G(e.intersection))||s.push(e.intersection);return s}(s,c?t:void 0),d=h?function(t){let{internal:n}=e.getState(),i=t.offsetX-n.initialClick[0],r=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(i*i+r*r))}(s):0;"onPointerDown"===r&&(a.initialClick=[s.offsetX,s.offsetY],a.initialHits=u.map(e=>e.eventObject)),h&&!u.length&&d<=2&&(i(s,a.interaction),o&&o(s)),c&&n(u),function(t,i,r,s){let o=e.getState();if(t.length){let e={stopped:!1};for(let a of t){let{raycaster:c,pointer:h,camera:u,internal:d}=F(a.object)||o,f=new l.Vector3(h.x,h.y,0).unproject(u),p=e=>{var t,n;return null!=(t=null==(n=d.capturedMap.get(e))?void 0:n.has(a.eventObject))&&t},m=e=>{let t={intersection:a,target:i.target};d.capturedMap.has(e)?d.capturedMap.get(e).set(a.eventObject,t):d.capturedMap.set(e,new Map([[a.eventObject,t]])),i.target.setPointerCapture(e)},_=e=>{let t=d.capturedMap.get(e);t&&K(d.capturedMap,a.eventObject,t,e)},v={};for(let e in i){let t=i[e];"function"!=typeof t&&(v[e]=t)}let g={...a,...v,pointer:h,intersections:t,stopped:e.stopped,delta:r,unprojectedPoint:f,ray:c.ray,camera:u,stopPropagation(){let r="pointerId"in i&&d.capturedMap.get(i.pointerId);(!r||r.has(a.eventObject))&&(g.stopped=e.stopped=!0,d.hovered.size&&Array.from(d.hovered.values()).find(e=>e.eventObject===a.eventObject)&&n([...t.slice(0,t.indexOf(a)),a]))},target:{hasPointerCapture:p,setPointerCapture:m,releasePointerCapture:_},currentTarget:{hasPointerCapture:p,setPointerCapture:m,releasePointerCapture:_},nativeEvent:i};if(s(g),!0===e.stopped)break}}}(u,s,d,function(e){let t=e.eventObject,n=t.__r3f,o=null==n?void 0:n.handlers;if(null!=n&&n.eventCount){if(c){if(o.onPointerOver||o.onPointerEnter||o.onPointerOut||o.onPointerLeave){let t=G(e),n=a.hovered.get(t);n?n.stopped&&e.stopPropagation():(a.hovered.set(t,e),null==o.onPointerOver||o.onPointerOver(e),null==o.onPointerEnter||o.onPointerEnter(e))}null==o.onPointerMove||o.onPointerMove(e)}else{let n=o[r];n?(!h||a.initialHits.includes(t))&&(i(s,a.interaction.filter(e=>!a.initialHits.includes(e))),n(e)):h&&a.initialHits.includes(t)&&i(s,a.interaction.filter(e=>!a.initialHits.includes(e)))}}})}}}}let q=e=>!!(null!=e&&e.render),Q=c.createContext(null),J=(e,t)=>{let n=function(e){let t="function"==typeof e?function(e){let t;let n=new Set,i=(e,i)=>{let r="function"==typeof e?e(t):e;if(r!==t){let e=t;t=i?r:Object.assign({},t,r),n.forEach(n=>n(t,e))}},r=()=>t,s=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is;console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let o=i(t);function a(){let n=i(t);if(!s(o,n)){let t=o;e(o=n,t)}}return n.add(a),()=>n.delete(a)},o={setState:i,getState:r,subscribe:(e,t,i)=>t||i?s(e,t,i):(n.add(e),()=>n.delete(e)),destroy:()=>n.clear()};return t=e(i,r,o),o}(e):e,n=function(){let e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.getState,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is,[,r]=(0,c.useReducer)(e=>e+1,0),s=t.getState(),o=(0,c.useRef)(s),a=(0,c.useRef)(n),l=(0,c.useRef)(i),h=(0,c.useRef)(!1),d=(0,c.useRef)();void 0===d.current&&(d.current=n(s));let f=!1;(o.current!==s||a.current!==n||l.current!==i||h.current)&&(e=n(s),f=!i(d.current,e)),u(()=>{f&&(d.current=e),o.current=s,a.current=n,l.current=i,h.current=!1});let p=(0,c.useRef)(s);u(()=>{let e=()=>{try{let e=t.getState(),n=a.current(e);l.current(d.current,n)||(o.current=e,d.current=n,r())}catch(e){h.current=!0,r()}},n=t.subscribe(e);return t.getState()!==p.current&&e(),n},[]);let m=f?e:d.current;return(0,c.useDebugValue)(m),m};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");let e=[n,t];return{next(){let t=e.length<=0;return{value:e.shift(),done:t}}}},n}((n,i)=>{let r;let s=new l.Vector3,o=new l.Vector3,a=new l.Vector3;function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i().camera,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i().size,{width:r,height:c,top:h,left:u}=n,d=r/c;t instanceof l.Vector3?a.copy(t):a.set(...t);let f=e.getWorldPosition(s).distanceTo(a);if(S(e))return{width:r/e.zoom,height:c/e.zoom,top:h,left:u,factor:1,distance:f,aspect:d};{let t=2*Math.tan(e.fov*Math.PI/180/2)*f,n=r/c*t;return{width:n,height:t,top:h,left:u,factor:r/n,distance:f,aspect:d}}}let u=e=>n(t=>({performance:{...t.performance,current:e}})),d=new l.Vector2;return{set:n,get:i,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e(i(),t)},advance:(e,n)=>t(e,n,i()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new l.Clock,pointer:d,mouse:d,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{let e=i();r&&clearTimeout(r),e.performance.current!==e.performance.min&&u(e.performance.min),r=setTimeout(()=>u(i().performance.max),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:h},setEvents:e=>n(t=>({...t,events:{...t.events,...e}})),setSize:(e,t,r,s,a)=>{let l=i().camera,c={width:e,height:t,top:s||0,left:a||0,updateStyle:r};n(e=>({size:c,viewport:{...e.viewport,...h(l,o,c)}}))},setDpr:e=>n(t=>{let n=R(e);return{viewport:{...t.viewport,dpr:n,initialDpr:t.viewport.initialDpr||n}}}),setFrameloop:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"always",t=i().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),n(()=>({frameloop:e}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:c.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(e,t,n)=>{let r=i().internal;return r.priority=r.priority+(t>0?1:0),r.subscribers.push({ref:e,priority:t,store:n}),r.subscribers=r.subscribers.sort((e,t)=>e.priority-t.priority),()=>{let n=i().internal;null!=n&&n.subscribers&&(n.priority=n.priority-(t>0?1:0),n.subscribers=n.subscribers.filter(t=>t.ref!==e))}}}}}),i=n.getState(),r=i.size,s=i.viewport.dpr,o=i.camera;return n.subscribe(()=>{let{camera:e,size:t,viewport:i,gl:a,set:l}=n.getState();if(t!==r||i.dpr!==s){var c;r=t,s=i.dpr,e.manual||(S(e)?(e.left=-(t.width/2),e.right=t.width/2,e.top=t.height/2,e.bottom=-(t.height/2)):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld()),a.setPixelRatio(i.dpr);let n=null!=(c=t.updateStyle)?c:"undefined"!=typeof HTMLCanvasElement&&a.domElement instanceof HTMLCanvasElement;a.setSize(t.width,t.height,n)}e!==o&&(o=e,l(t=>({viewport:{...t.viewport,...t.viewport.getCurrentViewport(e)}})))}),n.subscribe(t=>e(t)),n},$=new Set,ee=new Set,et=new Set;function en(e,t){if(e.size)for(let{callback:n}of e.values())n(t)}function ei(e,t){switch(e){case"before":return en($,t);case"after":return en(ee,t);case"tail":return en(et,t)}}function er(e,t,n){let o=t.clock.getDelta();for("never"===t.frameloop&&"number"==typeof e&&(o=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),r=t.internal.subscribers,i=0;i<r.length;i++)(s=r[i]).ref.current(s.store.getState(),o,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function es(e){let t=c.useRef(null);return L(()=>void(t.current=e.current.__r3f),[e]),t}function eo(){let e=c.useContext(Q);if(!e)throw Error("R3F: Hooks can only be used within the Canvas component!");return e}function ea(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e,t=arguments.length>1?arguments[1]:void 0;return eo()(e,t)}function el(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=eo(),i=n.getState().internal.subscribe,r=P(e);return L(()=>i(r,t,n),[t,i,n]),null}function ec(e,t){return function(n){for(var i=arguments.length,r=Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];let o=new n;return e&&e(o),Promise.all(r.map(e=>new Promise((n,i)=>o.load(e,e=>{e.scene&&Object.assign(e,function(e){let t={nodes:{},materials:{}};return e&&e.traverse(e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)}),t}(e.scene)),n(e)},t,t=>i(Error("Could not load ".concat(e,": ").concat(t.message,")")))))))}}function eh(e,t,n,i){let r=Array.isArray(t)?t:[t],s=y(ec(n,i),[e,...r],{equal:I.equ});return Array.isArray(t)?s:s[0]}eh.preload=function(e,t,n){let i=Array.isArray(t)?t:[t];return E(ec(n),[e,...i])},eh.clear=function(e,t){return b([e,...Array.isArray(t)?t:[t]])};let eu=new Map,{invalidate:ed,advance:ef}=function(e){let t,n,i,r=!1;function s(o){for(let l of(n=requestAnimationFrame(s),r=!0,t=0,ei("before",o),e.values())){var a;(i=l.store.getState()).internal.active&&("always"===i.frameloop||i.internal.frames>0)&&!(null!=(a=i.gl.xr)&&a.isPresenting)&&(t+=er(o,i))}if(ei("after",o),0===t)return ei("tail",o),r=!1,cancelAnimationFrame(n)}return{loop:s,invalidate:function t(n){var i;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!n)return e.forEach(e=>t(e.store.getState()),o);null!=(i=n.gl.xr)&&i.isPresenting||!n.internal.active||"never"===n.frameloop||(n.internal.frames=Math.min(60,n.internal.frames+o),r||(r=!0,requestAnimationFrame(s)))},advance:function(t){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(n&&ei("before",t),i)er(t,i,r);else for(let n of e.values())er(t,n.store.getState());n&&ei("after",t)}}}(eu),{reconciler:ep,applyProps:em}=function(e,t){function n(e,t,n){let i,{args:r=[],attach:s,...o}=t,a="".concat(e[0].toUpperCase()).concat(e.slice(1));if("primitive"===e){if(void 0===o.object)throw Error("R3F: Primitives without 'object' are invalid!");i=k(o.object,{type:e,root:n,attach:s,primitive:!0})}else{let t=O[a];if(!t)throw Error("R3F: ".concat(a," is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively"));if(!Array.isArray(r))throw Error("R3F: The args prop must be an array!");i=k(new t(...r),{type:e,root:n,attach:s,memoizedProps:{args:r}})}return void 0===i.__r3f.attach&&(i instanceof l.BufferGeometry?i.__r3f.attach="geometry":i instanceof l.Material&&(i.__r3f.attach="material")),"inject"!==a&&Y(i,o),i}function i(e,t){let n=!1;if(t){var i,r;null!=(i=t.__r3f)&&i.attach?V(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.add(t),n=!0),n||null==(r=e.__r3f)||r.objects.push(t),t.__r3f||k(t,{}),t.__r3f.parent=e,W(t),Z(t)}}function r(e,t,n){let i=!1;if(t){var r,s;if(null!=(r=t.__r3f)&&r.attach)V(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){t.parent=e,t.dispatchEvent({type:"added"});let r=e.children.filter(e=>e!==t),s=r.indexOf(n);e.children=[...r.slice(0,s),t,...r.slice(s)],i=!0}i||null==(s=e.__r3f)||s.objects.push(t),t.__r3f||k(t,{}),t.__r3f.parent=e,W(t),Z(t)}}function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&[...e].forEach(e=>o(t,e,n))}function o(e,t,n){if(t){var i,r,o,a,l;t.__r3f&&(t.__r3f.parent=null),null!=(i=e.__r3f)&&i.objects&&(e.__r3f.objects=e.__r3f.objects.filter(e=>e!==t)),null!=(r=t.__r3f)&&r.attach?B(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.remove(t),null!=(a=t.__r3f)&&a.root&&function(e,t){let{internal:n}=e.getState();n.interaction=n.interaction.filter(e=>e!==t),n.initialHits=n.initialHits.filter(e=>e!==t),n.hovered.forEach((e,i)=>{(e.eventObject===t||e.object===t)&&n.hovered.delete(i)}),n.capturedMap.forEach((e,i)=>{K(n.capturedMap,t,e,i)})}(t.__r3f.root,t));let c=null==(o=t.__r3f)?void 0:o.primitive,h=void 0===n?null!==t.dispose&&!c:n;c||(s(null==(l=t.__r3f)?void 0:l.objects,t,h),s(t.children,t,h)),delete t.__r3f,h&&t.dispose&&"Scene"!==t.type&&(0,p.unstable_scheduleCallback)(p.unstable_IdlePriority,()=>{try{t.dispose()}catch(e){}}),Z(e)}}let a=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:f()({createInstance:n,removeChild:o,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(e,t)=>{if(!t)return;let n=e.getState().scene;n.__r3f&&(n.__r3f.root=e,i(n,t))},removeChildFromContainer:(e,t)=>{t&&o(e.getState().scene,t)},insertInContainerBefore:(e,t,n)=>{if(!t||!n)return;let i=e.getState().scene;i.__r3f&&r(i,t,n)},getRootHostContext:()=>null,getChildHostContext:e=>e,finalizeInitialChildren(e){var t;return!!(null!=(t=null==e?void 0:e.__r3f)?t:{}).handlers},prepareUpdate(e,t,n,i){var r;if((null!=(r=null==e?void 0:e.__r3f)?r:{}).primitive&&i.object&&i.object!==e)return[!0];{let{args:t=[],children:r,...s}=i,{args:o=[],children:a,...l}=n;if(!Array.isArray(t))throw Error("R3F: the args prop must be an array!");if(t.some((e,t)=>e!==o[t]))return[!0];let c=N(e,s,l,!0);return c.changes.length?[!1,c]:null}},commitUpdate(e,t,r,s,a,l){let[c,h]=t;c?function(e,t,r,s){var a;let l=null==(a=e.__r3f)?void 0:a.parent;if(!l)return;let c=n(t,r,e.__r3f.root);if(e.children){for(let t of e.children)t.__r3f&&i(c,t);e.children=e.children.filter(e=>!e.__r3f)}e.__r3f.objects.forEach(e=>i(c,e)),e.__r3f.objects=[],e.__r3f.autoRemovedBeforeAppend||o(l,e),c.parent&&(c.__r3f.autoRemovedBeforeAppend=!0),i(l,c),c.raycast&&c.__r3f.eventCount&&c.__r3f.root.getState().internal.interaction.push(c),[s,s.alternate].forEach(e=>{null!==e&&(e.stateNode=c,e.ref&&("function"==typeof e.ref?e.ref(c):e.ref.current=c))})}(e,r,a,l):Y(e,h)},commitMount(e,t,n,i){var r;let s=null!=(r=e.__r3f)?r:{};e.raycast&&s.handlers&&s.eventCount&&e.__r3f.root.getState().internal.interaction.push(e)},getPublicInstance:e=>e,prepareForCommit:()=>null,preparePortalMount:e=>k(e.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(e){var t;let{attach:n,parent:i}=null!=(t=e.__r3f)?t:{};n&&i&&B(i,e,n),e.isObject3D&&(e.visible=!1),Z(e)},unhideInstance(e,t){var n;let{attach:i,parent:r}=null!=(n=e.__r3f)?n:{};i&&r&&V(r,e,i),(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0),Z(e)},createTextInstance:a,hideTextInstance:a,unhideTextInstance:a,getCurrentEventPriority:()=>t?t():h.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:"undefined"!=typeof performance&&I.fun(performance.now)?performance.now:I.fun(Date.now)?Date.now:()=>0,scheduleTimeout:I.fun(setTimeout)?setTimeout:void 0,cancelTimeout:I.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Y}}(0,function(){var e;let t="undefined"!=typeof self&&self||window;if(!t)return h.DefaultEventPriority;switch(null==(e=t.event)?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return h.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return h.ContinuousEventPriority;default:return h.DefaultEventPriority}}),e_={objects:"shallow",strict:!1},ev=(e,t)=>{let n="function"==typeof e?e(t):e;return q(n)?n:new l.WebGLRenderer({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function eg(e){let t,n;let i=eu.get(e),r=null==i?void 0:i.fiber,s=null==i?void 0:i.store;i&&console.warn("R3F.createRoot should only be called once!");let o="function"==typeof reportError?reportError:console.error,a=s||J(ed,ef),u=r||ep.createContainer(a,h.ConcurrentRoot,null,!1,null,"",o,null);i||eu.set(e,{fiber:u,store:a});let d=!1;return{configure(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{gl:r,size:s,scene:o,events:c,onCreated:h,shadows:u=!1,linear:f=!1,flat:p=!1,legacy:m=!1,orthographic:_=!1,frameloop:v="always",dpr:g=[1,2],performance:y,raycaster:E,camera:b,onPointerMissed:O}=i,w=a.getState(),T=w.gl;w.gl||w.set({gl:T=ev(r,e)});let S=w.raycaster;S||w.set({raycaster:S=new l.Raycaster});let{params:C,...L}=E||{};if(I.equ(L,S,e_)||em(S,{...L}),I.equ(C,S.params,e_)||em(S,{params:{...S.params,...C}}),!w.camera||w.camera===n&&!I.equ(n,b,e_)){n=b;let e=b instanceof l.Camera,t=e?b:_?new l.OrthographicCamera(0,0,0,0,.1,1e3):new l.PerspectiveCamera(75,0,.1,1e3);e||(t.position.z=5,b&&em(t,b),w.camera||null!=b&&b.rotation||t.lookAt(0,0,0)),w.set({camera:t})}if(!w.scene){let e;o instanceof l.Scene?e=o:(e=new l.Scene,o&&em(e,o)),w.set({scene:k(e)})}if(!w.xr){let e=(e,t)=>{let n=a.getState();"never"!==n.frameloop&&ef(e,!0,n,t)},t=()=>{let t=a.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||ed(t)},n={connect(){let e=a.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){let e=a.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};T.xr&&n.connect(),w.set({xr:n})}if(T.shadowMap){let e=T.shadowMap.enabled,t=T.shadowMap.type;if(T.shadowMap.enabled=!!u,I.boo(u))T.shadowMap.type=l.PCFSoftShadowMap;else if(I.str(u)){var P;let e={basic:l.BasicShadowMap,percentage:l.PCFShadowMap,soft:l.PCFSoftShadowMap,variance:l.VSMShadowMap};T.shadowMap.type=null!=(P=e[u])?P:l.PCFSoftShadowMap}else I.obj(u)&&Object.assign(T.shadowMap,u);(e!==T.shadowMap.enabled||t!==T.shadowMap.type)&&(T.shadowMap.needsUpdate=!0)}let A=x();A&&("enabled"in A?A.enabled=!m:"legacyMode"in A&&(A.legacyMode=m)),em(T,{outputEncoding:f?3e3:3001,toneMapping:p?l.NoToneMapping:l.ACESFilmicToneMapping}),w.legacy!==m&&w.set(()=>({legacy:m})),w.linear!==f&&w.set(()=>({linear:f})),w.flat!==p&&w.set(()=>({flat:p})),!r||I.fun(r)||q(r)||I.equ(r,T,e_)||em(T,r),c&&!w.events.handlers&&w.set({events:c(a)});let D=function(e,t){if(t)return t;if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){let{width:t,height:n,top:i,left:r}=e.parentElement.getBoundingClientRect();return{width:t,height:n,top:i,left:r}}return"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0}:{width:0,height:0,top:0,left:0}}(e,s);return I.equ(D,w.size,e_)||w.setSize(D.width,D.height,D.updateStyle,D.top,D.left),g&&w.viewport.dpr!==R(g)&&w.setDpr(g),w.frameloop!==v&&w.setFrameloop(v),w.onPointerMissed||w.set({onPointerMissed:O}),y&&!I.equ(y,w.performance,e_)&&w.set(e=>({performance:{...e.performance,...y}})),t=h,d=!0,this},render(n){return d||this.configure(),ep.updateContainer(c.createElement(ey,{store:a,children:n,onCreated:t,rootElement:e}),u,null,()=>void 0),a},unmount(){eE(e)}}}function ey(e){let{store:t,children:n,onCreated:i,rootElement:r}=e;return L(()=>{let e=t.getState();e.set(e=>({internal:{...e.internal,active:!0}})),i&&i(e),t.getState().events.connected||null==e.events.connect||e.events.connect(r)},[]),c.createElement(Q.Provider,{value:t},n)}function eE(e,t){let n=eu.get(e),i=null==n?void 0:n.fiber;if(i){let r=null==n?void 0:n.store.getState();r&&(r.internal.active=!1),ep.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var n,i,s,o;null==r.events.disconnect||r.events.disconnect(),null==(n=r.gl)||null==(i=n.renderLists)||null==i.dispose||i.dispose(),null==(s=r.gl)||null==s.forceContextLoss||s.forceContextLoss(),null!=(o=r.gl)&&o.xr&&r.xr.disconnect(),function(e){for(let t in e.dispose&&"Scene"!==e.type&&e.dispose(),e)null==t.dispose||t.dispose(),delete e[t]}(r),eu.delete(e),t&&t(e)}catch(e){}},500)})}}ep.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:c.version}),c.unstable_act},9631:function(e,t,n){n.d(t,{Xz:function(){return L}});var i=n(1653),r=n(2110),s=n(4090),o=n(6376),a=n(3802),l=n.n(a);let c=["x","y","top","bottom","left","right","width","height"],h=(e,t)=>c.every(n=>e[n]===t[n]);var u=Object.defineProperty,d=Object.defineProperties,f=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable,v=(e,t,n)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,g=(e,t)=>{for(var n in t||(t={}))m.call(t,n)&&v(e,n,t[n]);if(p)for(var n of p(t))_.call(t,n)&&v(e,n,t[n]);return e},y=(e,t)=>d(e,f(t));function E(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch(t){return e}}let b=E(s.createContext(null));class O extends s.Component{render(){return s.createElement(b.Provider,{value:this._reactInternals},this.props.children)}}let{ReactCurrentOwner:w,ReactCurrentDispatcher:T}=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;n(7777),n(4812),n(9514);let x={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function S(e){let{handlePointer:t}=(0,i.c)(e);return{priority:1,enabled:!0,compute(e,t,n){t.pointer.set(e.offsetX/t.size.width*2-1,-(e.offsetY/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(x).reduce((e,n)=>({...e,[n]:t(n)}),{}),update:()=>{var t;let{events:n,internal:i}=e.getState();null!=(t=i.lastEvent)&&t.current&&n.handlers&&n.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var n;let{set:i,events:r}=e.getState();null==r.disconnect||r.disconnect(),i(e=>({events:{...e.events,connected:t}})),Object.entries(null!=(n=r.handlers)?n:[]).forEach(e=>{let[n,i]=e,[r,s]=x[n];t.addEventListener(r,i,{passive:s})})},disconnect:()=>{let{set:t,events:n}=e.getState();if(n.connected){var i;Object.entries(null!=(i=n.handlers)?i:[]).forEach(e=>{let[t,i]=e;if(n&&n.connected instanceof HTMLElement){let[e]=x[t];n.connected.removeEventListener(e,i)}}),t(e=>({events:{...e.events,connected:void 0}}))}}}}let C=s.forwardRef(function(e,t){let{children:n,fallback:a,resize:c,style:u,gl:d,events:f=S,eventSource:p,eventPrefix:m,shadows:_,linear:v,flat:x,legacy:C,orthographic:L,frameloop:P,dpr:A,performance:D,raycaster:M,camera:U,onPointerMissed:z,onCreated:R,...F}=e;s.useMemo(()=>(0,i.e)(o),[]);let I=function(){let e=function(){var e,t;let n=function(){let e=s.useContext(b);if(null===e)throw Error("its-fine: useFiber must be called within a <FiberProvider />!");let t=s.useId();return s.useMemo(()=>{for(let n of[null==w?void 0:w.current,e,null==e?void 0:e.alternate]){if(!n)continue;let e=function e(t,n,i){if(!t)return;if(!0===i(t))return t;let r=n?t.return:t.child;for(;r;){let t=e(r,n,i);if(t)return t;r=n?null:r.sibling}}(n,!1,e=>{let n=e.memoizedState;for(;n;){if(n.memoizedState===t)return!0;n=n.next}});if(e)return e}},[e,t])}(),[i]=s.useState(()=>new Map);i.clear();let r=n;for(;r;){let n=null==(e=r.type)?void 0:e._context;n&&n!==b&&!i.has(n)&&i.set(n,null==(t=null==T?void 0:T.current)?void 0:t.readContext(E(n))),r=r.return}return i}();return s.useMemo(()=>Array.from(e.keys()).reduce((t,n)=>i=>s.createElement(t,null,s.createElement(n.Provider,y(g({},i),{value:e.get(n)}))),e=>s.createElement(O,g({},e))),[e])}(),[k,H]=function(e){var t;let{debounce:n,scroll:i,polyfill:r,offsetSize:o}=void 0===e?{debounce:0,scroll:!1,offsetSize:!1}:e,a=r||window.ResizeObserver;if(!a)throw Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");let[c,u]=(0,s.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),d=(0,s.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:c}),f=n?"number"==typeof n?n:n.scroll:null,p=n?"number"==typeof n?n:n.resize:null,m=(0,s.useRef)(!1);(0,s.useEffect)(()=>(m.current=!0,()=>void(m.current=!1)));let[_,v,g]=(0,s.useMemo)(()=>{let e=()=>{if(!d.current.element)return;let{left:e,top:t,width:n,height:i,bottom:r,right:s,x:a,y:l}=d.current.element.getBoundingClientRect(),c={left:e,top:t,width:n,height:i,bottom:r,right:s,x:a,y:l};d.current.element instanceof HTMLElement&&o&&(c.height=d.current.element.offsetHeight,c.width=d.current.element.offsetWidth),Object.freeze(c),m.current&&!h(d.current.lastBounds,c)&&u(d.current.lastBounds=c)};return[e,p?l()(e,p):e,f?l()(e,f):e]},[u,o,f,p]);function y(){d.current.scrollContainers&&(d.current.scrollContainers.forEach(e=>e.removeEventListener("scroll",g,!0)),d.current.scrollContainers=null),d.current.resizeObserver&&(d.current.resizeObserver.disconnect(),d.current.resizeObserver=null)}function E(){d.current.element&&(d.current.resizeObserver=new a(g),d.current.resizeObserver.observe(d.current.element),i&&d.current.scrollContainers&&d.current.scrollContainers.forEach(e=>e.addEventListener("scroll",g,{capture:!0,passive:!0})))}return t=!!i,(0,s.useEffect)(()=>{if(t)return window.addEventListener("scroll",g,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",g,!0)},[g,t]),(0,s.useEffect)(()=>(window.addEventListener("resize",v),()=>void window.removeEventListener("resize",v)),[v]),(0,s.useEffect)(()=>{y(),E()},[i,g,v]),(0,s.useEffect)(()=>y,[]),[e=>{e&&e!==d.current.element&&(y(),d.current.element=e,d.current.scrollContainers=function e(t){let n=[];if(!t||t===document.body)return n;let{overflow:i,overflowX:r,overflowY:s}=window.getComputedStyle(t);return[i,r,s].some(e=>"auto"===e||"scroll"===e)&&n.push(t),[...n,...e(t.parentElement)]}(e),E())},c,_]}({scroll:!0,debounce:{scroll:50,resize:0},...c}),j=s.useRef(null),V=s.useRef(null);s.useImperativeHandle(t,()=>j.current);let B=(0,i.u)(z),[N,Y]=s.useState(!1),[Z,W]=s.useState(!1);if(N)throw N;if(Z)throw Z;let G=s.useRef(null);(0,i.a)(()=>{let e=j.current;H.width>0&&H.height>0&&e&&(G.current||(G.current=(0,i.b)(e)),G.current.configure({gl:d,events:f,shadows:_,linear:v,flat:x,legacy:C,orthographic:L,frameloop:P,dpr:A,performance:D,raycaster:M,camera:U,size:H,onPointerMissed:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return null==B.current?void 0:B.current(...t)},onCreated:e=>{null==e.events.connect||e.events.connect(p?(0,i.i)(p)?p.current:p:V.current),m&&e.setEvents({compute:(e,t)=>{let n=e[m+"X"],i=e[m+"Y"];t.pointer.set(n/t.size.width*2-1,-(i/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==R||R(e)}}),G.current.render(s.createElement(I,null,s.createElement(i.E,{set:W},s.createElement(s.Suspense,{fallback:s.createElement(i.B,{set:Y})},n)))))}),s.useEffect(()=>{let e=j.current;if(e)return()=>(0,i.d)(e)},[]);let K=p?"none":"auto";return s.createElement("div",(0,r.Z)({ref:V,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:K,...u}},F),s.createElement("div",{ref:k,style:{width:"100%",height:"100%"}},s.createElement("canvas",{ref:j,style:{display:"block"}},a)))}),L=s.forwardRef(function(e,t){return s.createElement(O,null,s.createElement(C,(0,r.Z)({},e,{ref:t})))})},3802:function(e){function t(e,t,n){function i(){var c=Date.now()-a;c<t&&c>=0?r=setTimeout(i,t-c):(r=null,n||(l=e.apply(o,s),o=s=null))}null==t&&(t=100);var r,s,o,a,l,c=function(){o=this,s=arguments,a=Date.now();var c=n&&!r;return r||(r=setTimeout(i,t)),c&&(l=e.apply(o,s),o=s=null),l};return c.clear=function(){r&&(clearTimeout(r),r=null)},c.flush=function(){r&&(l=e.apply(o,s),o=s=null,clearTimeout(r),r=null)},c}t.debounce=t,e.exports=t},8025:function(e,t){/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */t.ConcurrentRoot=1,t.ContinuousEventPriority=4,t.DefaultEventPriority=16,t.DiscreteEventPriority=1},7777:function(e,t,n){e.exports=n(8025)},4812:function(e,t,n){e.exports=n(5224)},1803:function(e,t){/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function n(e,t){var n=e.length;for(e.push(t);0<n;){var i=n-1>>>1,r=e[i];if(0<s(r,t))e[i]=t,e[n]=r,n=i;else break}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;for(var i=0,r=e.length,o=r>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,h=e[c];if(0>s(l,n))c<r&&0>s(h,l)?(e[i]=h,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else if(c<r&&0>s(h,n))e[i]=h,e[c]=n,i=c;else break}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var o,a=performance;t.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var h=[],u=[],d=1,f=null,p=3,m=!1,_=!1,v=!1,g="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,E="undefined"!=typeof setImmediate?setImmediate:null;function b(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else if(t.startTime<=e)r(u),t.sortIndex=t.expirationTime,n(h,t);else break;t=i(u)}}function O(e){if(v=!1,b(e),!_){if(null!==i(h))_=!0,U(w);else{var t=i(u);null!==t&&z(O,t.startTime-e)}}}function w(e,n){_=!1,v&&(v=!1,y(S),S=-1),m=!0;var s=p;try{for(b(n),f=i(h);null!==f&&(!(f.expirationTime>n)||e&&!P());){var o=f.callback;if("function"==typeof o){f.callback=null,p=f.priorityLevel;var a=o(f.expirationTime<=n);n=t.unstable_now(),"function"==typeof a?f.callback=a:f===i(h)&&r(h),b(n)}else r(h);f=i(h)}if(null!==f)var l=!0;else{var c=i(u);null!==c&&z(O,c.startTime-n),l=!1}return l}finally{f=null,p=s,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var T=!1,x=null,S=-1,C=5,L=-1;function P(){return!(t.unstable_now()-L<C)}function A(){if(null!==x){var e=t.unstable_now();L=e;var n=!0;try{n=x(!0,e)}finally{n?o():(T=!1,x=null)}}else T=!1}if("function"==typeof E)o=function(){E(A)};else if("undefined"!=typeof MessageChannel){var D=new MessageChannel,M=D.port2;D.port1.onmessage=A,o=function(){M.postMessage(null)}}else o=function(){g(A,0)};function U(e){x=e,T||(T=!0,o())}function z(e,n){S=g(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){_||m||(_=!0,U(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(h)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,s){var o=t.unstable_now();switch(s="object"==typeof s&&null!==s&&"number"==typeof(s=s.delay)&&0<s?o+s:o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return a=s+a,e={id:d++,callback:r,priorityLevel:e,startTime:s,expirationTime:a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===i(h)&&e===i(u)&&(v?(y(S),S=-1):v=!0,z(O,s-o))):(e.sortIndex=a,n(h,e),_||m||(_=!0,U(w))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},9514:function(e,t,n){e.exports=n(1803)},699:function(e,t,n){/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i=n(4090),r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=i.useState,o=i.useEffect,a=i.useLayoutEffect,l=i.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!r(e,n)}catch(e){return!0}}var h=void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),i=s({inst:{value:n,getSnapshot:t}}),r=i[0].inst,h=i[1];return a(function(){r.value=n,r.getSnapshot=t,c(r)&&h({inst:r})},[e,n,t]),o(function(){return c(r)&&h({inst:r}),e(function(){c(r)&&h({inst:r})})},[e]),l(n),n};t.useSyncExternalStore=void 0!==i.useSyncExternalStore?i.useSyncExternalStore:h},220:function(e,t,n){/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i=n(4090),r=n(2362),s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=r.useSyncExternalStore,a=i.useRef,l=i.useEffect,c=i.useMemo,h=i.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,i,r){var u=a(null);if(null===u.current){var d={hasValue:!1,value:null};u.current=d}else d=u.current;var f=o(e,(u=c(function(){function e(e){if(!l){if(l=!0,o=e,e=i(e),void 0!==r&&d.hasValue){var t=d.value;if(r(t,e))return a=t}return a=e}if(t=a,s(o,e))return t;var n=i(e);return void 0!==r&&r(t,n)?t:(o=e,a=n)}var o,a,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,i,r]))[0],u[1]);return l(function(){d.hasValue=!0,d.value=f},[f]),h(f),f}},2362:function(e,t,n){e.exports=n(699)},9292:function(e,t,n){e.exports=n(220)},2110:function(e,t,n){n.d(t,{Z:function(){return i}});function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}},4620:function(e,t,n){let i;n.d(t,{x:function(){return u}});var r=n(3827),s=n(6376),o=n(4090),a=n(1653),l=n(3502);let c=(0,o.createContext)(null),h=e=>(e.getAttributes()&l.VB.CONVOLUTION)===l.VB.CONVOLUTION,u=o.memo((0,o.forwardRef)((e,t)=>{let{children:n,camera:u,scene:d,resolutionScale:f,enabled:p=!0,renderPriority:m=1,autoClear:_=!0,depthBuffer:v,disableNormalPass:g,stencilBuffer:y,multisampling:E=8,frameBufferType:b=s.HalfFloatType}=e,{gl:O,scene:w,camera:T,size:x}=(0,a.z)(),S=d||w,C=u||T,[L,P,A]=(0,o.useMemo)(()=>{let e=function(){var e;if(void 0!==i)return i;try{let t;let n=document.createElement("canvas");return i=!!(window.WebGL2RenderingContext&&(t=n.getContext("webgl2"))),t&&(null==(e=t.getExtension("WEBGL_lose_context"))||e.loseContext()),i}catch(e){return i=!1}}(),t=new l.xC(O,{depthBuffer:v,stencilBuffer:y,multisampling:E>0&&e?E:0,frameBufferType:b});t.addPass(new l.CD(S,C));let n=null,r=null;return!g&&((r=new l.gh(S,C)).enabled=!1,t.addPass(r),void 0!==f&&e&&((n=new l.xs({normalBuffer:r.texture,resolutionScale:f})).enabled=!1,t.addPass(n))),[t,r,n]},[C,O,v,y,E,b,S,g,f]);(0,o.useEffect)(()=>null==L?void 0:L.setSize(x.width,x.height),[L,x]),(0,a.A)((e,t)=>{if(p){let e=O.autoClear;O.autoClear=_,y&&!_&&O.clearStencil(),L.render(t),O.autoClear=e}},p?m:0);let D=(0,o.useRef)(null),M=(0,a.x)(D);(0,o.useLayoutEffect)(()=>{let e=[];if(D.current&&M.current&&L){let t=M.current.objects;for(let n=0;n<t.length;n++){let i=t[n];if(i instanceof l.Qm){let r=[i];if(!h(i)){let e=null;for(;(e=t[n+1])instanceof l.Qm&&!h(e);)r.push(e),n++}let s=new l.H5(C,...r);e.push(s)}else i instanceof l.w2&&e.push(i)}for(let t of e)null==L||L.addPass(t);P&&(P.enabled=!0),A&&(A.enabled=!0)}return()=>{for(let t of e)null==L||L.removePass(t);P&&(P.enabled=!1),A&&(A.enabled=!1)}},[L,n,C,P,A,M]);let U=(0,o.useMemo)(()=>({composer:L,normalPass:P,downSamplingPass:A,resolutionScale:f,camera:C,scene:S}),[L,P,A,f,C,S]);return(0,o.useImperativeHandle)(t,()=>L,[L]),(0,r.jsx)(c.Provider,{value:U,children:(0,r.jsx)("group",{ref:D,children:n})})}))},5523:function(e,t,n){n.d(t,{d:function(){return r}});var i=n(3502);let r=(0,n(4615).p1)(i.rk,{blendFunction:i.YQ.ADD})},5230:function(e,t,n){n.d(t,{c:function(){return r}});var i=n(3502);let r=(0,n(4615).p1)(i.xV,{blendFunction:i.YQ.COLOR_DODGE})},4615:function(e,t,n){n.d(t,{p1:function(){return l}});var i=n(3827),r=n(4090),s=n(1653);let o=0,a=new WeakMap,l=(e,t)=>r.forwardRef(function(n,l){let{blendFunction:c=null==t?void 0:t.blendFunction,opacity:h=null==t?void 0:t.opacity,...u}=n,d=a.get(e);if(!d){let t="@react-three/postprocessing/".concat(e.name,"-").concat(o++);(0,s.e)({[t]:e}),a.set(e,d=t)}let f=(0,s.z)(e=>e.camera),p=r.useMemo(()=>{var e,n;return[...null!=(e=null==t?void 0:t.args)?e:[],...null!=(n=u.args)?n:[{...t,...u}]]},[JSON.stringify(u)]);return(0,i.jsx)(d,{camera:f,"blendMode-blendFunction":c,"blendMode-opacity-value":h,...u,ref:l,args:p})})},2020:function(e,t,n){n.d(t,{Ue:function(){return d}});let i=e=>{let t;let n=new Set,i=(e,i)=>{let r="function"==typeof e?e(t):e;if(!Object.is(r,t)){let e=t;t=(null!=i?i:"object"!=typeof r||null===r)?r:Object.assign({},t,r),n.forEach(n=>n(t,e))}},r=()=>t,s={setState:i,getState:r,getInitialState:()=>o,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},o=t=e(i,r,s);return s},r=e=>e?i(e):i;var s=n(4090),o=n(9292);let{useDebugValue:a}=s,{useSyncExternalStoreWithSelector:l}=o,c=!1,h=e=>e,u=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?r(e):e,n=(e,n)=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h,n=arguments.length>2?arguments[2]:void 0;n&&!c&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),c=!0);let i=l(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return a(i),i})(t,e,n);return Object.assign(n,t),n},d=e=>e?u(e):u},7966:function(e,t,n){n.d(t,{n:function(){return Y}});var i,r=Symbol.for("immer-nothing"),s=Symbol.for("immer-draftable"),o=Symbol.for("immer-state");function a(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw Error("[Immer] minified error nr: ".concat(e,". Full error at: https://bit.ly/3cXEKWf"))}var l=Object.getPrototypeOf;function c(e){return!!e&&!!e[o]}function h(e){var t;return!!e&&(d(e)||Array.isArray(e)||!!e[s]||!!(null===(t=e.constructor)||void 0===t?void 0:t[s])||v(e)||g(e))}var u=Object.prototype.constructor.toString();function d(e){if(!e||"object"!=typeof e)return!1;let t=l(e);if(null===t)return!0;let n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===u}function f(e,t){0===p(e)?Object.entries(e).forEach(n=>{let[i,r]=n;t(i,r,e)}):e.forEach((n,i)=>t(i,n,e))}function p(e){let t=e[o];return t?t.type_:Array.isArray(e)?1:v(e)?2:g(e)?3:0}function m(e,t){return 2===p(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function _(e,t,n){let i=p(e);2===i?e.set(t,n):3===i?e.add(n):e[t]=n}function v(e){return e instanceof Map}function g(e){return e instanceof Set}function y(e){return e.copy_||e.base_}function E(e,t){if(v(e))return new Map(e);if(g(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!t&&d(e))return l(e)?{...e}:Object.assign(Object.create(null),e);let n=Object.getOwnPropertyDescriptors(e);delete n[o];let i=Reflect.ownKeys(n);for(let t=0;t<i.length;t++){let r=i[t],s=n[r];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(n[r]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[r]})}return Object.create(l(e),n)}function b(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return w(e)||c(e)||!h(e)||(p(e)>1&&(e.set=e.add=e.clear=e.delete=O),Object.freeze(e),t&&f(e,(e,t)=>b(t,!0),!0)),e}function O(){a(2)}function w(e){return Object.isFrozen(e)}var T={};function x(e){let t=T[e];return t||a(0,e),t}function S(e,t){t&&(x("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function C(e){L(e),e.drafts_.forEach(A),e.drafts_=null}function L(e){e===i&&(i=e.parent_)}function P(e){return i={drafts_:[],parent_:i,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function A(e){let t=e[o];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function D(e,t){t.unfinalizedDrafts_=t.drafts_.length;let n=t.drafts_[0];return void 0!==e&&e!==n?(n[o].modified_&&(C(t),a(4)),h(e)&&(e=M(t,e),t.parent_||z(t,e)),t.patches_&&x("Patches").generateReplacementPatches_(n[o].base_,e,t.patches_,t.inversePatches_)):e=M(t,n,[]),C(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==r?e:void 0}function M(e,t,n){if(w(t))return t;let i=t[o];if(!i)return f(t,(r,s)=>U(e,i,t,r,s,n),!0),t;if(i.scope_!==e)return t;if(!i.modified_)return z(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;let t=i.copy_,r=t,s=!1;3===i.type_&&(r=new Set(t),t.clear(),s=!0),f(r,(r,o)=>U(e,i,t,r,o,n,s)),z(e,t,!1),n&&e.patches_&&x("Patches").generatePatches_(i,n,e.patches_,e.inversePatches_)}return i.copy_}function U(e,t,n,i,r,s,o){if(c(r)){let o=M(e,r,s&&t&&3!==t.type_&&!m(t.assigned_,i)?s.concat(i):void 0);if(_(n,i,o),!c(o))return;e.canAutoFreeze_=!1}else o&&n.add(r);if(h(r)&&!w(r)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;M(e,r),t&&t.scope_.parent_||z(e,r)}}function z(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&b(t,n)}var R={get(e,t){if(t===o)return e;let n=y(e);if(!m(n,t))return function(e,t,n){var i;let r=k(t,n);return r?"value"in r?r.value:null===(i=r.get)||void 0===i?void 0:i.call(e.draft_):void 0}(e,n,t);let i=n[t];return e.finalized_||!h(i)?i:i===I(e.base_,t)?(j(e),e.copy_[t]=V(i,e)):i},has:(e,t)=>t in y(e),ownKeys:e=>Reflect.ownKeys(y(e)),set(e,t,n){let i=k(y(e),t);if(null==i?void 0:i.set)return i.set.call(e.draft_,n),!0;if(!e.modified_){let i=I(y(e),t),r=null==i?void 0:i[o];if(r&&r.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if((n===i?0!==n||1/n==1/i:n!=n&&i!=i)&&(void 0!==n||m(e.base_,t)))return!0;j(e),H(e)}return!!(e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t]))||(e.copy_[t]=n,e.assigned_[t]=!0,!0)},deleteProperty:(e,t)=>(void 0!==I(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,j(e),H(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){let n=y(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:i.enumerable,value:n[t]}:i},defineProperty(){a(11)},getPrototypeOf:e=>l(e.base_),setPrototypeOf(){a(12)}},F={};function I(e,t){let n=e[o];return(n?y(n):e)[t]}function k(e,t){if(!(t in e))return;let n=l(e);for(;n;){let e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=l(n)}}function H(e){!e.modified_&&(e.modified_=!0,e.parent_&&H(e.parent_))}function j(e){e.copy_||(e.copy_=E(e.base_,e.scope_.immer_.useStrictShallowCopy_))}function V(e,t){let n=v(e)?x("MapSet").proxyMap_(e,t):g(e)?x("MapSet").proxySet_(e,t):function(e,t){let n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:i,modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},s=r,o=R;n&&(s=[r],o=F);let{revoke:a,proxy:l}=Proxy.revocable(s,o);return r.draft_=l,r.revoke_=a,l}(e,t);return(t?t.scope_:i).drafts_.push(n),n}f(R,(e,t)=>{F[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),F.deleteProperty=function(e,t){return F.set.call(this,e,t,void 0)},F.set=function(e,t,n){return R.set.call(this,e[0],t,n,e[0])};var B=new class{createDraft(e){var t;h(e)||a(8),c(e)&&(c(t=e)||a(10,t),e=function e(t){let n;if(!h(t)||w(t))return t;let i=t[o];if(i){if(!i.modified_)return i.base_;i.finalized_=!0,n=E(t,i.scope_.immer_.useStrictShallowCopy_)}else n=E(t,!0);return f(n,(t,i)=>{_(n,t,e(i))}),i&&(i.finalized_=!1),n}(t));let n=P(this),i=V(e,void 0);return i[o].isManual_=!0,L(n),i}finishDraft(e,t){let n=e&&e[o];n&&n.isManual_||a(9);let{scope_:i}=n;return S(i,t),D(void 0,i)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){let i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}n>-1&&(t=t.slice(n+1));let i=x("Patches").applyPatches_;return c(e)?i(e,t):this.produce(e,e=>i(e,t))}constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{let i;if("function"==typeof e&&"function"!=typeof t){let n=t;t=e;let i=this;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;for(var r=arguments.length,s=Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return i.produce(e,e=>t.call(this,e,...s))}}if("function"!=typeof t&&a(6),void 0!==n&&"function"!=typeof n&&a(7),h(e)){let r=P(this),s=V(e,void 0),o=!0;try{i=t(s),o=!1}finally{o?C(r):L(r)}return S(r,n),D(i,r)}if(e&&"object"==typeof e)a(1,e);else{if(void 0===(i=t(e))&&(i=e),i===r&&(i=void 0),this.autoFreeze_&&b(i,!0),n){let t=[],r=[];x("Patches").generateReplacementPatches_(e,i,t,r),n(t,r)}return i}},this.produceWithPatches=(e,t)=>{let n,i;if("function"==typeof e){var r=this;return function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return r.produceWithPatches(t,t=>e(t,...i))}}return[this.produce(e,t,(e,t)=>{n=e,i=t}),n,i]},"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof(null==e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}},N=B.produce;B.produceWithPatches.bind(B),B.setAutoFreeze.bind(B),B.setUseStrictShallowCopy.bind(B),B.applyPatches.bind(B),B.createDraft.bind(B),B.finishDraft.bind(B);let Y=e=>(t,n,i)=>(i.setState=function(e,n){for(var i=arguments.length,r=Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];return t("function"==typeof e?N(e):e,n,...r)},e(i.setState,n,i))}}]);