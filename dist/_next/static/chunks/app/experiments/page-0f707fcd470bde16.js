(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[992],{206:function(e,t,r){Promise.resolve().then(r.bind(r,9704))},9704:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return I}});var n=r(7437),a=r(2265),o=r(4220),s=r(7871),i=r(3719),u=r(8384),l=r(2803),c=r(2079),m=r(5375),h=r(7776),p=r(9373),d=r(2325),x=r(8942),f=r(878),g=r(1675),M=r(6209);let y=e=>{let{start:t,end:r,color:a,thickness:o=.1}=e,s=new h.Vector3().subVectors(r,t),i=.5*s.length(),u=s.normalize(),l=new h.Quaternion,c=new h.Vector3(0,1,0);l.setFromUnitVectors(c,u);let m=i-.8;return(0,n.jsx)("group",{position:t,children:(0,n.jsxs)("group",{quaternion:l,children:[(0,n.jsxs)("mesh",{position:[0,m/2,0],children:[(0,n.jsx)("cylinderGeometry",{args:[o,o,m,8]}),(0,n.jsx)("meshStandardMaterial",{color:a,emissive:a})]}),(0,n.jsxs)("mesh",{position:[0,i-.4,0],children:[(0,n.jsx)("coneGeometry",{args:[.4,.8,16]}),(0,n.jsx)("meshStandardMaterial",{color:a,emissive:a,emissiveIntensity:.8,transparent:!0,opacity:.5})]})]})})};var v=e=>{let{moonRef:t,planetRef:r,length:a=3}=e;if(!t?.current?.position||!r?.current?.position)return null;let o=t.current.position.clone(),s=new h.Vector3(0,0,0),i=new h.Vector3().subVectors(s,o).normalize().multiplyScalar(Math.min(25,8*a)),u=new h.Vector3().subVectors(o,s).normalize().multiplyScalar(Math.min(25,8*a)),l=new h.Vector3(o.x+i.x,o.y+i.y,o.z+i.z),c=new h.Vector3(s.x+u.x,s.y+u.y,s.z+u.z);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y,{start:o,end:l,color:"orange",thickness:.04}),(0,n.jsx)(y,{start:s,end:c,color:"green",thickness:.04})]})},w=r(1577);function j(e){let{meanMotion:t,eccentricity:r,orbitalRadius:n,orbitalInclination:a,currentAngle:o,deltaTime:s}=e,i=o+t*s,u=i;for(let e=0;e<10;e++){let e=(u-r*Math.sin(u)-i)/(1-r*Math.cos(u));if(u-=e,1e-6>Math.abs(e))break}let l=2*Math.atan(Math.sqrt((1+r)/(1-r))*Math.tan(u/2)),c=n*(1-r*r)/(1+r*Math.cos(l)),m=c*Math.sin(l),p=Math.PI/180*a,d=Math.sin(p)*m,x=Math.cos(p)*m;return{position:new h.Vector3(c*Math.cos(l),d,x),angle:i}}var P=r(4851),b=e=>{let{target:t,color:r="white",width:o=3,opacity:s=1,active:i=!0,minPoints:u=150,maxPoints:l=300,pause:c=!1}=e,[m,d]=(0,a.useState)([]),x=(0,a.useRef)(0),f=(0,a.useRef)(null);(0,p.A)(()=>{if(i&&t?.current&&!c){if(x.current++,!f.current&&m.length<u){f.current=t.current.position.clone(),d(Array(u).fill(f.current.clone()));return}x.current%2==0&&d(e=>{if(e.length<u){let r=e[e.length-1]||t.current.position.clone(),n=Array(u-e.length).fill(r);return[...e,...n]}let r=[...e,t.current.position.clone()];if(r.length>l&&(r=r.slice(r.length-l)),r.length<u){let e=r[r.length-1];for(;r.length<u;)r.unshift(e.clone())}return r})}}),(0,a.useEffect)(()=>{if(!i){if(t?.current){let e=t.current.position.clone();d(Array(u).fill(e))}else d([]);f.current=null}},[i,u]);let g=m.map((e,t)=>{let n=t/Math.max(m.length-1,1);return new h.Color(r).multiplyScalar(n)});return m.length>1?(0,n.jsx)(P.x,{points:m,vertexColors:g,lineWidth:o,depthWrite:!1,transparent:!0,opacity:s}):null},R=e=>{let{moonData:t,planetRef:r,parentName:o,scaledPlanetRadius:i}=e,{name:m,orbitalRadius:d,radius:g,color:y,orbitalPeriod:P,orbitalInclination:R,eccentricity:E}=t,{simSpeed:z,toggleDetailsMenu:V}=(0,u.ZP)(),{selectedMoon:S,setSelectedMoon:T,updateMoonPosition:k,updateMoonWorldPosition:A,displayLabels:I,orbitPaths:Z,planetsData:L}=(0,u.d2)(),{activeCamera:C,switchToMoonCamera:D}=(0,u.g5)(),{experimentStatus:W,setExperimentStatus:Y,experimentType:N}=(0,l.Z)(),U=(0,a.useMemo)(()=>({radius:g*x.sh,orbitalRadius:d*x.H_,meanMotion:2*Math.PI/(86400*P)}),[g,d,P]),B=U.radius+i,_=c.ZP[o].mass,X=L[o].mass/_,F=(0,a.useRef)(),G=(0,a.useRef)(0),$=(0,a.useRef)(0),O=(0,a.useRef)(new h.Vector3(U.orbitalRadius,0,0)),q=(0,a.useRef)(null),Q=(0,a.useRef)(!1),[H,J]=(0,a.useState)(!1),[K,ee]=(0,a.useState)(!1),et=S&&S.name===m,er="Moon"===m?(0,s.m)("../assets/earth/moon/moon.jpg"):null;return(0,a.useEffect)(()=>{if(("completed"!==W||!W)&&F.current){F.current.position.set(U.orbitalRadius,0,0),O.current.set(U.orbitalRadius,0,0),G.current=0,$.current=0,q.current=null,Q.current=!1,J(!1),ee(!1);let e=F.current.getWorldPosition(new h.Vector3);k(m,{x:e.x,y:e.y,z:e.z})}},[W,U.orbitalRadius,m]),(0,p.A)((e,t)=>{if(H||"completed"===W)return;if("started"!==W){if(F.current){let e=F.current.getWorldPosition(new h.Vector3);k(m,{x:e.x,y:e.y,z:e.z})}return}let r=X<=.5,n=t*z;if(F.current){if(r){Q.current||(O.current.copy(F.current.position),q.current=new h.Vector3(-F.current.position.y,F.current.position.x,0).normalize().multiplyScalar(U.meanMotion*U.orbitalRadius),Q.current=!0,ee(!0));let{position:e,velocity:t}=function(e){let{meanMotion:t,orbitalRadius:r,currentAngle:n,startAngle:a=null,deltaTime:o,initialVelocity:s=null,position:i=null}=e;if(!s||!i){let e=t*r*1.02,a=new h.Vector2(-e*Math.sin(n),e*Math.cos(n));return{position:new h.Vector3(r*Math.cos(n),0,r*Math.sin(n)),velocity:a,angle:n}}let u=Math.sqrt(i.x*i.x+i.z*i.z),l=4e-6/(u*u),c=new h.Vector2(-i.x/u,-i.z/u),m=s.clone();m.x+=c.x*l*o*.1,m.y+=c.y*l*o*.1;let p=m.clone().normalize();m.x+=1e-10*p.x*o,m.y+=1e-10*p.y*o;let d=i.clone();d.x+=m.x*o,d.z+=m.y*o;let x=Math.atan2(d.z,d.x);return{position:d,velocity:m,angle:x}}({meanMotion:U.meanMotion,orbitalRadius:U.orbitalRadius,currentAngle:$.current,deltaTime:n,initialVelocity:q.current,position:O.current});if(O.current.copy(e),q.current=t,F.current.position.copy(e),e.length()>6*U.orbitalRadius){Y("completed");return}}else if(.1>Math.abs(X-2)){let{position:e,angle:t}=function(e){let{meanMotion:t,orbitalRadius:r,currentAngle:n,startAngle:a,deltaTime:o}=e,s=r*Math.exp(-(Math.abs(a-n)/(2*Math.PI)*2.2)),i=n+t*Math.pow(r/s,.8)*5*o,u=s*Math.cos(i),l=s*Math.sin(i);return{position:new h.Vector3(u,0,l),angle:i,radius:s}}({meanMotion:U.meanMotion,orbitalRadius:U.orbitalRadius,currentAngle:$.current,startAngle:G.current,deltaTime:n});F.current.position.copy(e),$.current=t}else if(.1>Math.abs(X-1.5)){let{position:e,angle:t}=function(e){let{meanMotion:t,eccentricity:r,orbitalRadius:n,orbitalInclination:a,currentAngle:o,deltaTime:s,radiusModifier:i=.7,eccentricityModifier:u=.3}=e;return j({meanMotion:1.2*t,eccentricity:Math.min(.7,r+u),orbitalRadius:n*i,orbitalInclination:a,currentAngle:o,deltaTime:s})}({meanMotion:U.meanMotion,eccentricity:E,orbitalRadius:U.orbitalRadius,orbitalInclination:R,currentAngle:$.current,deltaTime:n,radiusModifier:.7,eccentricityModifier:.3});F.current.position.copy(e),$.current=t}else{let{position:e,angle:t}=j({meanMotion:U.meanMotion,eccentricity:E,orbitalRadius:U.orbitalRadius,orbitalInclination:R,currentAngle:$.current,deltaTime:n});F.current.position.copy(e),$.current=t}if(F.current.position.length()<=B&&!r){J(!0),Y("completed");return}let e=F.current.getWorldPosition(new h.Vector3);k(m,{x:e.x,y:e.y,z:e.z}),"Moon"===m&&F.current.lookAt(new h.Vector3(0,0,0));let t=F.current.getWorldPosition(new h.Vector3);A(m,{x:t.x,y:t.y,z:t.z})}}),(0,n.jsxs)(n.Fragment,{children:[C?.name===m&&F.current&&(0,n.jsx)(M.Z,{target:F.current,targetName:m,size:U.radius,bodyType:"moon"},m+"-satellite-camera"),"newton-1"===N?(0,n.jsx)(b,{target:F,color:y,width:2,active:W&&Z,minPoints:(()=>{switch(X){case .5:return 300;case 1:return 100;default:return 80}})(),maxPoints:(()=>{switch(X){case .5:return 500;case 1:return 100;default:return 90}})(),pause:"completed"===W},W?"moon-trail-active":"moon-trail"):(0,n.jsx)(f.Z,{radius:U.orbitalRadius,eccentricity:E,orbitalInclination:R,color:y,name:`${m}-orbit-path`,hiRes:!0,lineWidth:1,position:F.current?.position,arcLength:.9}),(0,n.jsxs)("group",{ref:F,children:[(0,n.jsxs)("mesh",{rotation:"Moon"===m?[0,3.5*Math.PI,0]:[0,0,0],children:[(0,n.jsx)("sphereGeometry",{args:[U.radius,et?38:24,et?28:16]}),(0,n.jsx)("meshBasicMaterial",{metalness:H?.8:.5,roughness:H?.2:.5,map:H?null:er,color:H?"red":er?null:y})]},"moon-mesh"+H+W),I&&(0,n.jsx)(w.Z,{text:m,size:16,position:[0,1.2*U.radius,0],color:y})]}),F.current&&"newton-1"===N&&(0,n.jsx)(v,{moonRef:F,planetRef:r,length:U.radius*X*100/(F.current.position.length()||1)})]})},E=r(4242),z=r(8236);let V=e=>(e%(2*Math.PI)+2*Math.PI)%(2*Math.PI);var S=e=>{let{planetName:t="Earth",planetRef:r,angleRef:o,numTriangles:s=5,radius:i,eccentricity:c=0,orbitalInclination:m}=e,{planetsData:h,updatePlanetAngle:d,updatePlanetData:x}=(0,u.d2)(),{experimentStatus:f}=(0,l.Z)(),[g,M]=(0,a.useState)(null),[y,v]=(0,a.useState)([]),[w,j]=(0,a.useState)(0),[b,R]=(0,a.useState)(null),E=(0,a.useRef)([]),z=(0,a.useRef)(!1);(0,a.useEffect)(()=>{v([]),j(0),M(null),R(null),E.current=[],z.current=!0},[t,i,h[t].eccentricity,m,s,x]),(0,a.useEffect)(()=>{null===f&&(v([]),j(0),M(null),R(null),E.current=[],z.current=!0)},[f]);let S=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,n=[];e=V(e),t=V(t);for(let e=0;e<20;e++)n.push([0,0,0]);let a=t-e;a<0&&(a+=2*Math.PI);for(let t=0;t<=r;t++){let o=e+t/r*a;n.push(k(o))}for(let e=0;e<20;e++)n.push([0,0,0]);return n},T=(0,a.useMemo)(()=>{let e=[];for(let t=0;t<=s;t++){let r=t/s*2*Math.PI,n=r;for(let e=0;e<10;e++){let e=(n-c*Math.sin(n)-r)/(1-c*Math.cos(n));if(n-=e,1e-6>Math.abs(e))break}let a=2*Math.atan(Math.sqrt((1+c)/(1-c))*Math.tan(n/2));e.push(V(a))}return e},[s,c]),k=e=>{let t=i*(1-c*c)/(1+c*Math.cos(e)),r=t*Math.sin(e),n=Math.PI/180*m;return[t*Math.cos(e),Math.sin(n)*r,Math.cos(n)*r]},A=(e,t,r)=>(e=V(e),(t=V(t))<=(r=V(r)))?e>=t&&e<=r:e>=t||e<=r;return(0,p.A)(()=>{if(!r.current)return;let e=r.current.position,t=V(Math.atan2(e.z,e.x));if(E.current.push(t),E.current.length>3&&E.current.shift(),null===b){R(t);return}let n=E.current,a=n.some(e=>e>5),o=n.some(e=>e<1);if(a&&o&&t<b){v([]),j(0),M(null),R(t),E.current=[t];return}if(w<s){let e=T[w],r=T[w+1];g?!A(t,e,r)&&A(b,e,r)?(v(t=>[...t,{points:S(e,r),color:g.color}]),w<s-1?(j(e=>e+1),M({startAngle:r,endAngle:t,color:`hsl(${(w+1)*360/s}, 70%, 50%)`})):M(null)):M(e=>({...e,endAngle:t})):M({startAngle:e,endAngle:t,color:`hsl(${360*w/s}, 70%, 50%)`})}R(t)}),(0,n.jsxs)("group",{children:[y.map((e,t)=>(0,n.jsx)(P.x,{points:e.points,color:e.color,lineWidth:2},`complete-${t}`)),g&&(0,n.jsx)(P.x,{points:S(g.startAngle,g.endAngle),color:g.color,lineWidth:4})]},t)},T=e=>{let{name:t="Earth",textures:r}=e,{planetsData:o}=(0,u.d2)(),{experimentType:s,experimentPlanet:i,experimentStatus:m}=(0,l.Z)(),{radius:M=1,orbitalOrigin:y,orbitalRadius:v=1,orbitalPeriod:w=1,orbitalInclination:j=0,axialTilt:P=0,rotationPeriod:b=1,color:V="#ffffff",initialOrbitalAngle:T=0,eccentricity:k=0,mass:A}={...o[t]},{simSpeed:I,toggleDetailsMenu:Z}=(0,u.ZP)(),{planetAngles:L,updatePlanetPosition:C,selectedPlanet:D,setSelectedPlanet:W,displayLabels:Y,selectedMoon:N,setSelectedMoon:U,orbitPaths:B}=(0,u.d2)(),{isSurfaceCameraActive:_,satelliteCamera:X,toggleSatelliteCamera:F,setAutoRotate:G,autoRotate:$,activeCamera:O,switchToPlanetCamera:q}=(0,u.g5)();c.ZP[t].mass;let Q=(0,a.useRef)(),H=(0,a.useRef)(0),J=(0,a.useRef)(),K=(0,a.useRef)(null),[ee,et]=(0,a.useState)(!1),[er,en]=(0,a.useState)(!1),[ea,eo]=(0,a.useState)(!1),es=(0,a.useRef)({x:0,y:0}),ei=Math.max(.1,v*(_?1e-4:c.Hm)),eu=Math.max(.1,M*c.YB);c.E_;let el="newton-1"===s||D&&D.name===t,ec=()=>!!el||N?.parentName===t,em=el||ec()?128:32,[eh,ep]=(0,a.useState)(eu),ed=(0,a.useRef)(1),[ex,ef]=(0,a.useState)(!1),[eg,eM]=(0,a.useState)(1),[ey,ev]=(0,a.useState)(0);(0,a.useEffect)(()=>{null===m&&(H.current=-.000001,ev(0))},[m]),(0,a.useEffect)(()=>{K.current&&(K.current.rotation.order="YXZ",K.current.rotation.y=0,K.current.rotation.x=h.MathUtils.degToRad(P))},[P,D]),(0,a.useEffect)(()=>{r?.map&&(r.map.colorSpace=h.SRGBColorSpace,r.map.needsUpdate=!0),r?.clouds&&(r.clouds.colorSpace=h.SRGBColorSpace,r.clouds.needsUpdate=!0)},[]),(0,p.A)((e,r)=>{let n=r*I;if("completed"===m)return;if("newton-1"===s){if(b&&K.current){let e=2*Math.PI/(3600*b)*n,t=new h.Vector3(0,1,0);K.current.rotateOnAxis(t,e),J.current&&(J.current.rotation.y+=1.1*e)}if(Q.current){if(!Q.current.userData.initialPositionSet){let e=ei*(1-k);Q.current.position.set(e,0,0),C(t,{x:e,y:0,z:0}),Q.current.userData.initialPositionSet=!0}let r=Q.current.position.distanceTo(e.camera.position);ep(r/1e3<=eu?eu:r/1e3),ef("moon"===O.type||r<500);let n=100*eu,a=1*eu;eM(Math.max(0,Math.min(1,(r-a)/(n-a)))),ed.current&&(ed.current=.02*r)}return}H.current-=2*Math.PI/(86400*w)*n;let a=H.current;for(let e=0;e<10;e++){let e=(a-k*Math.sin(a)-H.current)/(1-k*Math.cos(a));if(a-=e,1e-6>Math.abs(e))break}let o=2*Math.atan(Math.sqrt((1+k)/(1-k))*Math.tan(a/2)),i=ei*(1-k*k)/(1+k*Math.cos(o)),u=i*Math.cos(-o),l=i*Math.sin(-o);if(Q.current){let r=Math.PI/180*j,a=Math.sin(r)*l,o=Math.cos(r)*l;if(Q.current.position.set(u,a,o),C(t,{x:u,y:a,z:o}),b&&K.current){let e=2*Math.PI/(3600*b)*n,t=new h.Vector3(0,1,0);K.current.rotateOnAxis(t,e);let r=n/86400;ev(e=>e+r),Q.current.rotation.y>=2*Math.PI&&el&&(Q.current.rotation.y%=2*Math.PI),J.current&&(J.current.rotation.y+=1.1*e)}let s=Q.current.position.distanceTo(e.camera.position);ep(Math.max(.1,s/1e3<=eu?eu:s/1e3)),ef("moon"===O.type||s<500);let i=100*eu,c=1*eu;eM(Math.max(0,Math.min(1,(s-c)/(i-c)))),ed.current&&(ed.current=Math.max(.1,.02*s))}});let ew=e=>{e.stopPropagation(),en(!1),es.current={x:e.clientX,y:e.clientY}},ej=e=>{Math.sqrt(Math.pow(e.clientX-es.current.x,2)+Math.pow(e.clientY-es.current.y,2))>5&&en(!0)},eP=e=>{en(!1)},eb=e=>{e.stopPropagation(),document.body.style.cursor="pointer",eo(!0)},eR=e=>{e.stopPropagation(),document.body.style.cursor="auto",eo(!1)},eE=x.ZP[t]||[],ez=Math.max(.1,ec()?eu:8*eh),eV=Math.max(.1,ec()?eu:8*eh),eS=Math.max(.1,1.005*eu),eT=Math.max(.1,1.008*eu);return(0,n.jsxs)(n.Fragment,{children:[O?.name===t&&Q.current&&(0,n.jsx)(g.Z,{target:Q.current,targetName:t,size:eu}),(0,n.jsxs)("group",{ref:Q,children:[(0,n.jsx)("mesh",{visible:!1,onPointerDown:ew,onPointerMove:ej,onPointerUp:eP,onPointerOver:eb,onPointerOut:eR,children:O?.name!==t&&(0,n.jsx)("sphereGeometry",{args:[ez,8,8]})}),(0,n.jsxs)("mesh",{ref:K,children:[(0,n.jsx)("sphereGeometry",{args:[eV,em,em/2]}),el||ec()||!ee?(0,n.jsxs)(n.Fragment,{children:["Earth"===t&&el&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("mesh",{ref:J,children:[(0,n.jsx)("sphereGeometry",{args:[eS,em,em/2]}),(0,n.jsx)("meshBasicMaterial",{alphaMap:r?.clouds,transparent:!0,opacity:.8})]},`${t}-cloud_texture`),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("sphereGeometry",{args:[eT,em,em/2]}),(0,n.jsx)("shaderMaterial",{args:[E.e]})]},`${t}-atmosphere_texture`)]}),(0,n.jsx)("meshBasicMaterial",{metalness:.6,roughness:.8,map:r?.map,onBuild:()=>et(!0)})]}):(0,n.jsx)("meshBasicMaterial",{color:V})]},el?t+"-textured":t+"-basic"),"Saturn"===t&&ex&&(0,n.jsx)(z.Z,{innerRadius:Math.max(.1,1.2*eu),outerRadius:Math.max(.1,2*eu),height:0,rotation:[h.MathUtils.degToRad(P),0,0],texture:el?r?.ringTexture:null,detail:Math.max(em,32)},em+t+"-ring"),"Uranus"===t&&ex&&(0,n.jsx)(z.Z,{innerRadius:Math.max(.1,1.5*eu),outerRadius:Math.max(.1,1.9*eu),height:0,texture:el?r?.ringTexture:null,detail:Math.max(em,32),rotation:[h.MathUtils.degToRad(P),0,0]},em+t+"-ring"),Y&&el&&(0,n.jsx)(d.V,{as:"span",wrapperClass:"label-wrapper",center:!0,"position-y":el?eh+.25*eh:4*eh,zIndexRange:[100,0],style:{pointerEvents:"none"},children:(0,n.jsx)("span",{className:"planet-label",style:{color:V},onPointerDown:ew,onPointerMove:ej,onPointerUp:eP,onPointerOver:eb,onPointerOut:eR,children:t})}),ec()&&eE.map((e,r)=>{let a=["Saturn","Uranus"].includes(t);return(0,n.jsx)("group",{rotation:a?[h.MathUtils.degToRad(P),0,0]:[0,0,0],children:(0,n.jsx)(R,{moonData:e,planetRef:Q,parentName:t,scaledPlanetRadius:eu},`${t}-moon-${r}`)},`${t}-moon-group-${r}`)})]}),B&&"newton-1"!==s&&(0,n.jsx)(f.Z,{position:Q.current?.position,...(()=>{switch(s){case"kepler-2":return{name:t+"orbital-path",color:"#fff",lineWidth:1,opacity:1,hiRes:!0,transparent:!0,arcLength:.8,origin:y,radius:ei,eccentricity:k,orbitalInclination:j};case"kepler-3":return{name:t+"orbital-path",color:V,lineWidth:5,opacity:.1,hiRes:!0,transparent:!0,arcLength:.8,origin:y,radius:ei,eccentricity:k,orbitalInclination:j};default:return{name:t+"orbital-path",color:V,lineWidth:2,opacity:1,transparent:!0,hiRes:!0,arcLength:.8,origin:y,radius:ei,eccentricity:k,orbitalInclination:j}}})()}),"kepler-2"===s&&(0,n.jsx)(S,{planetName:t,planetRef:Q,angleRef:H,numTriangles:6,radius:ei,eccentricity:k,orbitalInclination:j},t)]})},k=r(3920),A=()=>{let{sunSettings:e,simSpeed:t,setSimSpeed:r,prevSpeed:o,setPrevSpeed:d,setViewOnlyMode:x}=(0,u.ZP)(),{planetPositions:f,selectedPlanet:g,setSelectedPlanet:M,selectedMoon:y,setSelectedMoon:v,planetsData:w,moonsData:j,moonPositions:P,resetPlanetsData:b}=(0,u.d2)(),{satelliteCamera:R,isCameraTransitioning:E,toggleCameraTransitioning:z,isZoomingToSun:V,resetCamera:S,toggleZoomingToSun:A,activeCamera:I,setActiveCamera:Z,switchToCustomCamera:L,satelliteCameraState:C,setSatelliteCameraState:D}=(0,u.g5)(),{experimentPlanet:W,experimentType:Y}=(0,l.Z)(),N=(0,a.useRef)(),[U,B]=(0,a.useState)(200),[_,X]=(0,a.useState)(!1),F=[1e5,1e5,1e5],G=[2e4,2e4,2e4],$=[0,0,0];(0,a.useEffect)(()=>{N.current&&!_&&(N.current.setPosition(...F,!1),N.current.setTarget(...$,!1),setTimeout(()=>{N.current.setPosition(...G,!0),N.current.setTarget(...$,!0),X(!0)},100))},[N.current]);let O=e=>"moon"===I.type?Math.max(.5*e,.01):4.2*e,q=(e,t)=>{let r=j[t];return r?r.find(t=>t.name===e):null};(0,p.A)(()=>{if(N.current){if(C?.position&&E){let{position:e,targetPosition:t}=C;N.current.setPosition(e.x,e.y,e.z,!1),N.current.setTarget(t.x,t.y,t.z,!1),N.current.updateCameraUp(),N.current.update(),D(null)}if("planet"===I.type&&"Sun"!==I.name){let e=f[g.name];if(v(null),e){let t=O(w[g.name].radius*c.YB);B(t/2),N.current.setTarget(e.x,e.y,e.z,!0),N.current.dollyTo(t,!0),A(!1)}}if("moon"===I.type){let e=P[I.name],t=q(I.name,I.parentName);if(e&&t){let r=t.radius*c.YB,n=O(r);B(2*r),N.current.setTarget(e.x,e.y,e.z,!0),N.current.dollyTo(4*n,!0);let a=new h.Vector3;N.current.getTarget(a),.1>a.distanceTo(new h.Vector3(e.x,e.y,e.z))&&z(!1)}}if("Sun"===I.name&&"planet"===I.type&&(B(200),N.current.setTarget(0,0,0,!0),N.current.maxDistance=1e3,z(!1),N.current.distance>300&&V?N.current.dollyTo(200,!0):A(!1)),"Asteroid Belt"===I.name){let e=I.position;if(e&&"number"==typeof e.x){N.current.setPosition(e.x,e.y,e.z,!0),N.current.setTarget(0,0,0,!0),B(4250),N.current.maxDistance=9e3;let t=new h.Vector3;N.current.getPosition(t),100>t.distanceTo(new h.Vector3(e.x,e.y,e.z))&&z(!1)}}if("default"===I.name&&E){let e=I.position,t=I.lookAt,r=new h.Vector3,n=new h.Vector3;N.current.getPosition(r),N.current.getTarget(n),r.distanceTo(e)>100&&N.current.setLookAt(e.x,e.y,e.z,t.x,t.y,t.z,!0),z(!1),B(200)}if("orbit"!==I.type||E||(B(200),N.current.maxDistance=16e4),"kepler"===I.name&&W&&E){let e=w[W],t=e.orbitalRadius*c.Hm,r=t/2*e.eccentricity;N.current.setPosition(r,5*t,0,!0),N.current.setTarget(r,0,0,!0),B(t),N.current.maxDistance=2e6,z(!1)}if("newton"===I.name&&W&&E){let e=w.Earth,t={x:1494.5039999707724,y:816068867940263e-23,z:.009351460384996825},r=e.radius*c.YB,n=10*r*4;N.current.setLookAt(t.x+n,.5*n,t.z,t.x,t.y,t.z,!0),B(6*r),N.current.maxDistance=20*n,z(!1)}}}),(0,a.useEffect)(()=>{N.current&&!_&&(N.current.setPosition(...F,!1),N.current.setTarget(...$,!1),N.current.camera.updateProjectionMatrix(),setTimeout(()=>{S(),X(!0)},100))},[N.current]),(0,a.useEffect)(()=>{I.name,("planet"===I.type||"moon"===I.type)&&(console.log("Transitioning camera"),z(!0),d(t),r(0)),"orbit"===I.type&&"default"===I.name&&0===t&&r(o),g||y||0!==t||r(o),"Sun"===I.name&&(A(!0),0===t&&r(o)),N.current?.camera.updateProjectionMatrix()},[g,y,I]),(0,a.useEffect)(()=>{Y&&(Y.includes("kepler")?L("kepler",w[W]):"newton-1"===Y&&L("newton",w.Earth))},[Y,W]),(0,a.useEffect)(()=>{let e=e=>{1===e.button&&e.preventDefault(),N.current&&(N.current.mouseButtons.right=1)};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}},[]);let Q=(0,s.m)({map:"../assets/earth/earth_daymap.jpg",clouds:"../assets/earth/earth_clouds.jpg"}),H=(0,s.m)({map:"../assets/sun/sun.jpg"}),J=(0,s.m)({map:"../assets/venus/venus_surface.jpg"}),K=(0,s.m)({map:"../assets/mercury/mercury.jpg"}),ee=(0,s.m)({map:"../assets/mars/mars.jpg"}),et=(0,s.m)({map:"../assets/jupiter/jupiter.jpg"}),er=(0,s.m)({map:"../assets/saturn/saturn.jpg",ringTexture:"../assets/saturn/saturn-rings.png"}),en=(0,s.m)({map:"../assets/uranus/uranus.jpg",ringTexture:"../assets/uranus/uranus-rings.png"}),ea=(0,s.m)({map:"../assets/neptune/neptune.jpg"});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.B,{ref:N,makeDefault:!R,maxDistance:12e5,minDistance:U,smoothTime:.6,enableDamping:!0,near:.01,far:15e5,autoRotate:!0,enabled:!R}),(0,n.jsx)(k.Z,{}),(()=>{switch(W){case"Mars":return(0,n.jsx)(T,{name:"Mars",textures:ee},W);case"Venus":return(0,n.jsx)(T,{name:"Venus",textures:J},W);case"Mercury":return(0,n.jsx)(T,{name:"Mercury",textures:K},W);case"Jupiter":return(0,n.jsx)(T,{name:"Jupiter",textures:et},W);case"Saturn":return(0,n.jsx)(T,{name:"Saturn",textures:er},W);case"Uranus":return(0,n.jsx)(T,{name:"Uranus",textures:en},W);case"Neptune":return(0,n.jsx)(T,{name:"Neptune",textures:ea},W);default:return(0,n.jsx)(T,{name:"Earth",textures:Q},W)}})(),(0,n.jsx)(m.Z,{textures:H,position:e.position,resetCamera:S},"Sun-plain")]})};r(7045);var I=()=>{let{experimentMode:e,toggleExperimentMode:t}=(0,l.Z)();return(0,a.useEffect)(()=>{t(!0)},[t]),(0,n.jsx)(o.Z,{mode:e?"experiments":"main",children:(0,n.jsx)(A,{})})}},8236:function(e,t,r){"use strict";var n=r(7437),a=r(2265),o=r(7776);t.Z=e=>{let{innerRadius:t,outerRadius:r,height:s=0,rotation:i,texture:u,detail:l=16}=e,c=(0,a.useMemo)(()=>{let e=new o.CylinderGeometry(r,t,s,l,1,!0),n=e.attributes.uv;for(let e=0;e<n.count;e++){let t=n.getX(e),r=n.getY(e);n.setXY(e,t,r)}return e},[t,r,s]),m=(0,a.useMemo)(()=>new o.MeshBasicMaterial({map:u,side:o.DoubleSide,transparent:!0}),[u]);return(0,n.jsx)("mesh",{geometry:c,material:m,rotation:i})}},1675:function(e,t,r){"use strict";var n=r(7437),a=r(2265),o=r(9373),s=r(5533),i=r(7776),u=r(8384);t.Z=e=>{let{target:t,size:r,targetName:l,bodyType:c="planet"}=e,{toggleCameraTransitioning:m,setAutoRotate:h,autoRotate:p,toggleSatelliteCamera:d,satelliteCamera:x,activeCamera:f,setSatelliteCameraState:g}=(0,u.g5)(),{prevSpeed:M,setSimSpeed:y}=(0,u.ZP)(),{gl:v,camera:w}=(0,o.z)(),j=(0,a.useRef)(),P=(0,a.useRef)(!1),b=(0,a.useRef)({x:0,y:0}),R=(0,a.useRef)(new i.Spherical(6*r,Math.PI/2,0)),E=2.8*r,z=(0,a.useCallback)(()=>{h(!1)},[h]),V=(0,a.useCallback)(e=>{P.current=!0,b.current={x:e.clientX,y:e.clientY}},[]),S=(0,a.useCallback)(()=>{P.current=!1},[]),T=(0,a.useCallback)(e=>{if(!P.current)return;z();let t=e.clientX-b.current.x,r=e.clientY-b.current.y,n=R.current.phi-.45*r*.01,a=R.current.theta-.45*t*.01;R.current.phi=Math.max(.1,Math.min(Math.PI-.1,n)),R.current.theta=a,b.current={x:e.clientX,y:e.clientY}},[z]),k=(0,a.useCallback)(e=>{if(!x)return;let t=.1*e.deltaY,r=i.MathUtils.clamp(R.current.radius+t,E,1e3);R.current.radius=r,z()},[x,r,c,z]),A=(0,a.useCallback)(e=>{P.current=!0,e.touches?(e.preventDefault(),b.current={x:e.touches[0].clientX,y:e.touches[0].clientY}):b.current={x:e.clientX,y:e.clientY}},[]),I=(0,a.useCallback)(e=>{if(!P.current)return;z();let t=e.touches?e.touches[0].clientX:e.clientX,r=e.touches?e.touches[0].clientY:e.clientY,n=t-b.current.x,a=r-b.current.y,o=R.current.phi-.003*a,s=R.current.theta-.003*n;R.current.phi=Math.max(.1,Math.min(Math.PI-.1,o)),R.current.theta=s,b.current={x:t,y:r}},[z]);(0,o.A)((e,n)=>{if(!j.current||!t)return;let a=new i.Vector3;t.getWorldPosition(a);let o=t.position.clone();p&&(R.current.theta+=.05*n);let s=new i.Vector3().setFromSpherical(R.current).add(o);if(j.current.position.copy(s),j.current.lookAt(o),j.current.updateMatrixWorld(),x){let e=new i.Vector3;j.current.getWorldPosition(e);let t=new i.Quaternion;j.current.getWorldQuaternion(t),g(e,new i.Euler().setFromQuaternion(t),a)}f.name===l&&!x&&w.position.distanceTo(a)<=4.5*r&&Z(w,a)});let Z=(0,a.useCallback)((e,r)=>{let n=e.position.clone(),a=t.parent.matrixWorld.clone().invert(),o=n.applyMatrix4(a),s=t.position.clone(),u=o.sub(s);R.current.setFromVector3(u),R.current.radius=i.MathUtils.clamp(R.current.radius,E,1e3),j.current.position.copy(o),j.current.lookAt(s),d(!0),m(!1),y(M)},[t,c,r,d,m,y,M]);return(0,a.useEffect)(()=>{let e=v.domElement;return e.addEventListener("mousedown",V),window.addEventListener("mousemove",T),window.addEventListener("mouseup",S),e.addEventListener("wheel",k,{passive:!0}),e.addEventListener("touchstart",A),e.addEventListener("touchmove",I),e.addEventListener("touchend",S),e.addEventListener("contextmenu",e=>e.preventDefault()),()=>{e.removeEventListener("mousedown",V),window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",S),e.removeEventListener("wheel",k),e.removeEventListener("touchstart",A),e.removeEventListener("touchmove",I),e.removeEventListener("touchend",S),e.removeEventListener("contextmenu",e=>e.preventDefault()),x&&d(!1)}},[V,T,S,k,A,I,v.domElement,x,d]),(0,n.jsx)(s.c,{ref:j,name:"planet-satellite-camera-"+l,makeDefault:x,fov:50,near:1e-4,far:12e5},l)}},4242:function(e,t,r){"use strict";r.d(t,{e:function(){return n}});let n={uniforms:{glowColor:{value:new(r(7776)).Color(3377407)},glowIntensity:{value:.6}},vertexShader:`
      varying vec3 vNormal;
      varying vec3 vViewPosition;
      
      void main() {
        vNormal = normalize(normalMatrix * normal);
        vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
        vViewPosition = -mvPosition.xyz;
        gl_Position = projectionMatrix * mvPosition;
      }
    `,fragmentShader:`
      uniform vec3 glowColor;
      uniform float glowIntensity;
      varying vec3 vNormal;
      varying vec3 vViewPosition;
      
      void main() {
        float rim = 1.0 - max(dot(normalize(vViewPosition), vNormal), 0.0);
        rim = pow(rim, 3.0); // Increased power for sharper falloff
        gl_FragColor = vec4(glowColor, rim * glowIntensity);
      }
    `}},7045:function(){}},function(e){e.O(0,[260,689,723,802,122,971,190,744],function(){return e(e.s=206)}),_N_E=e.O()}]);