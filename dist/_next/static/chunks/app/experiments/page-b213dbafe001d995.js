(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[992],{206:function(e,t,r){Promise.resolve().then(r.bind(r,1931))},1931:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return V}});var n=r(7437),a=r(2265),o=r(9369),s=r(7871),u=r(3719),i=r(8384),c=r(2803),l=r(2079),m=r(5375),d=r(7776),p=r(9373),h=r(2325),x=r(8942),f=r(878),M=r(1675),g=r(6209),y=r(4851),j=e=>{let{moonRef:t,planetPosition:r,length:a=3}=e;if(!t?.current||!r)return null;let o=t.current.position,s=new d.Vector3(0,0,0),u=new d.Vector3().subVectors(s,o).normalize().multiplyScalar(a),i=new d.Vector3().subVectors(o,s).normalize().multiplyScalar(a);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.x,{points:[[o.x,o.y,o.z],[o.x+u.x,o.y+u.y,o.z+u.z]],color:"orange",lineWidth:3}),(0,n.jsx)(y.x,{points:[[s.x,s.y,s.z],[s.x+i.x,s.y+i.y,s.z+i.z]],color:"green",lineWidth:3})]})};function P(e){let{meanMotion:t,eccentricity:r,orbitalRadius:n,orbitalInclination:a,currentAngle:o,deltaTime:s}=e,u=o-t*s,i=u;for(let e=0;e<10;e++){let e=(i-r*Math.sin(i)-u)/(1-r*Math.cos(i));if(i-=e,1e-6>Math.abs(e))break}let c=2*Math.atan(Math.sqrt((1+r)/(1-r))*Math.tan(i/2)),l=n*(1-r*r)/(1+r*Math.cos(c)),m=l*Math.sin(-c),p=Math.PI/180*a,h=Math.sin(p)*m,x=Math.cos(p)*m;return{position:new d.Vector3(l*Math.cos(-c),h,x),angle:u}}r(8584);let R=(0,a.forwardRef)((e,t)=>{let{moonData:r,planetRef:o,parentName:u,scaledPlanetRadius:m}=e,{name:M,orbitalRadius:y,radius:R,color:b,orbitalPeriod:v,orbitalInclination:w,eccentricity:E}=r,{simSpeed:z,toggleDetailsMenu:T}=(0,i.ZP)(),{selectedMoon:k,moonAngles:S,setSelectedMoon:V,updateMoonPosition:I,updateMoonWorldPosition:Z,displayLabels:A,orbitPaths:C,planetsData:L}=(0,i.d2)(),{satelliteCamera:W,activeCamera:D,switchToMoonCamera:Y}=(0,i.g5)(),{experimentStatus:U,setExperimentStatus:_,experimentType:N}=(0,c.Z)(),X=(0,a.useMemo)(()=>({radius:R*x.sh,orbitalRadius:y*x.H_,meanMotion:2*Math.PI/(86400*v)}),[R,y,v]),$=X.radius+m,F=l.ZP[u].mass,B=L[u].mass/F,O=t||(0,a.useRef)(),G=(0,a.useRef)(S[M]||2*Math.random()*Math.PI),q=(0,a.useRef)(null),Q=(0,a.useRef)();(0,a.useRef)();let H=(0,a.useRef)([]),J=(0,a.useRef)(0),[K,ee]=(0,a.useState)(!1),et=k&&k.name===M,er="Moon"===M?(0,s.m)("../assets/earth/moon/2k_moon.jpg"):null;(0,a.useRef)(null);let[en,ea]=(0,a.useState)(!1),eo=(0,a.useRef)(null),es=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(null===U){if(O.current){let e=O.current.position;G.current=Math.atan2(e.z,e.x)}q.current=null,H.current=[],ee(!1),Q.current&&(Q.current.material.color.set(er?"white":b),Q.current.material.emissive.set("black"))}},[U,b,er]),(0,p.A)((e,t)=>{if(K||"completed"===U)return;if("started"!==U){O.current&&O.current.position.set(X.orbitalRadius,0,0);return}let r=B<=.5;if(null===q.current){let e=O.current.position;if(G.current=Math.atan2(e.z,e.x),q.current=G.current,r){let e=new d.Vector3;O.current.getWorldPosition(e);let t=L[u].orbitalSpeed*l.Hm,r=new d.Vector2(-t*Math.sin(q.current),t*Math.cos(q.current)),n=X.meanMotion*X.orbitalRadius,a=new d.Vector2(-n*Math.sin(G.current),n*Math.cos(G.current)).add(r);eo.current=e,es.current=a,O.current.parent.parent.attach(O.current),ea(!0)}}let n=t*z;if(O.current){if(J.current+=1,J.current>=1){if(r||en){let e=O.current.getWorldPosition(new d.Vector3);H.current.push([e.x,e.y,e.z])}else{let e=O.current.position.clone();H.current.push([e.x,e.y,e.z])}H.current.length>300&&(H.current=H.current.slice(H.current.length-300)),J.current=0}if(r||en){let e=eo.current,t=es.current;if(e.x+=t.x*n,e.z+=t.y*n,O.current.position.copy(e),e.length()>3*X.orbitalRadius){_("completed");return}}else if(.1>Math.abs(B-2)){let{position:e,angle:t}=function(e){let{meanMotion:t,orbitalRadius:r,currentAngle:n,startAngle:a,deltaTime:o}=e,s=r*Math.exp(-((a-n)/(2*Math.PI))*Math.PI),u=n-t*(1+15*Math.pow(1-s/r,2))*o,i=s*Math.cos(u),c=s*Math.sin(u);return{position:new d.Vector3(i,0,c),angle:u,radius:s}}({meanMotion:X.meanMotion,orbitalRadius:X.orbitalRadius,currentAngle:G.current,startAngle:q.current,deltaTime:n});O.current.position.copy(e),G.current=t}else if(.1>Math.abs(B-1.5)){let{position:e,angle:t}=function(e){let{meanMotion:t,eccentricity:r,orbitalRadius:n,orbitalInclination:a,currentAngle:o,deltaTime:s,radiusModifier:u=.7,eccentricityModifier:i=.3}=e;return P({meanMotion:1.2*t,eccentricity:Math.min(.7,r+i),orbitalRadius:n*u,orbitalInclination:a,currentAngle:o,deltaTime:s})}({meanMotion:X.meanMotion,eccentricity:E,orbitalRadius:X.orbitalRadius,orbitalInclination:w,currentAngle:G.current,deltaTime:n,radiusModifier:.7,eccentricityModifier:.3});O.current.position.copy(e),G.current=t}else{let{position:e,angle:t}=P({meanMotion:X.meanMotion,eccentricity:E,orbitalRadius:X.orbitalRadius,orbitalInclination:w,currentAngle:G.current,deltaTime:n});O.current.position.copy(e),G.current=t}if(O.current.position.length()<=$&&!r){ee(!0),_("completed"),Q.current&&(Q.current.material.color.set("red"),Q.current.material.emissive.set("darkred"));return}let t=O.current.getWorldPosition(new d.Vector3);I(M,{x:t.x,y:t.y,z:t.z}),"Moon"===M&&O.current.lookAt(new d.Vector3(0,0,0));let a=new d.Vector3;e.camera.getWorldPosition(a),O.current.parent.worldToLocal(a);let o=O.current.getWorldPosition(new d.Vector3);Z(M,{x:o.x,y:o.y,z:o.z})}});let eu=e=>{e.stopPropagation(),et||(T(!0),V(r),Y(u,M))};return(0,n.jsxs)(n.Fragment,{children:[D?.name===M&&O.current&&(0,n.jsx)(g.Z,{target:O.current,targetName:M,size:X.radius,bodyType:"moon"},M+"-satellite-camera"),(0,n.jsxs)("group",{ref:O,children:[(0,n.jsxs)("mesh",{ref:Q,rotation:"Moon"===M?[0,3.5*Math.PI,0]:[0,0,0],onClick:eu,children:[(0,n.jsx)("sphereGeometry",{args:[X.radius,et?38:24,et?28:16]}),(0,n.jsx)("meshStandardMaterial",{metalness:K?.8:.5,roughness:K?.2:.5,map:K?null:er,color:K?"red":er?null:b,emissive:K?"darkred":"black"})]},M+"-textured"),(A||et)&&(0,n.jsx)(h.V,{position:[0,1.2*X.radius,0],center:!0,zIndexRange:[100,0],occlude:z<2e4,style:et?{pointerEvents:"none"}:{},children:(0,n.jsx)("span",{className:"planet-label",onClick:eu,style:{color:b,fontSize:et?"14px":"12px",cursor:"pointer"},children:M})})]}),C&&(0,n.jsx)(f.Z,{origin:[0,0,0],radius:X.orbitalRadius,eccentricity:E,orbitalInclination:w,color:b,name:`${M}-orbit-path`,hiRes:!0,lineType:"solid",lineWidth:1,position:O.current?.position}),O.current&&"newton-1"===N&&(0,n.jsx)(j,{moonRef:O,planetPosition:o?.current?.position,length:X.radius*B*100/(O.current.position.length()||1)})]})}),b=(0,a.forwardRef)((e,t)=>{let{moonData:r,planetRef:o,parentName:u,scaledPlanetRadius:l}=e,{name:m,orbitalRadius:f,radius:M,color:g,orbitalPeriod:j}=r,{simSpeed:P,toggleDetailsMenu:R}=(0,i.ZP)(),{selectedMoon:b,setSelectedMoon:v,updateMoonPosition:w,updateMoonWorldPosition:E,displayLabels:z,planetPositions:T}=(0,i.d2)(),{activeCamera:k,switchToMoonCamera:S}=(0,i.g5)(),{experimentStatus:V,setExperimentStatus:I}=(0,c.Z)(),Z=(0,a.useMemo)(()=>({radius:M*x.sh,orbitalRadius:f*x.H_,meanMotion:2*Math.PI/(86400*j)}),[M,f,j]),A=(0,a.useRef)(),C=(0,a.useRef)(),L=(0,a.useRef)(null),W=(0,a.useRef)(null),D=(0,a.useRef)([]),[Y,U]=(0,a.useState)(!1),_=b&&b.name===m,N="Moon"===m?(0,s.m)("../assets/earth/moon/moon.jpg"):null;(0,a.useEffect)(()=>{if("started"===V){let e=T[u]||{x:0,y:0,z:0},t=new d.Vector3(e.x+Z.orbitalRadius,e.y,e.z);A.current&&A.current.position.copy(t),W.current=t.clone(),D.current=[[t.x,t.y,t.z]];let r=Z.meanMotion*Z.orbitalRadius;L.current={x:.8*r,y:.3*r,z:.5*r}}},[V]);let X=0;(0,p.A)((e,t)=>{if(Y||"completed"===V||"started"!==V||!L.current)return;++X%60==0&&(console.log("Current Position:",A.current?.position),console.log("Trail Points Length:",D.current.length),console.log("Last Trail Point:",D.current[D.current.length-1]));let r=t*P;if(A.current){let e=A.current.position;e.x+=L.current.x*r,e.y+=L.current.y*r,e.z+=L.current.z*r,D.current.push([e.x,e.y,e.z]),D.current.length>100&&(D.current=D.current.slice(-100));let t=T[u]||{x:0,y:0,z:0};if(new d.Vector3(e.x-t.x,e.y-t.y,e.z-t.z).length()>3*Z.orbitalRadius){console.log("Escape Completed"),I("completed");return}w(m,e.clone()),E(m,e.clone())}});let $=e=>{e.stopPropagation(),_||(R(!0),v(r),S(u,m))};return(0,n.jsxs)(n.Fragment,{children:["started"===V&&D.current.length>1&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(y.x,{points:D.current,color:Y?"red":"hotpink",lineWidth:2,transparent:!0,opacity:.6})}),(0,n.jsxs)("group",{ref:A,children:[(0,n.jsxs)("mesh",{ref:C,rotation:"Moon"===m?[0,3.5*Math.PI,0]:[0,0,0],onClick:$,children:[(0,n.jsx)("sphereGeometry",{args:[Z.radius,_?38:24,_?28:16]}),(0,n.jsx)("meshStandardMaterial",{metalness:Y?.8:.5,roughness:Y?.2:.5,map:Y?null:N,color:Y?"red":N?null:g,emissive:Y?"darkred":null})]},m+"-textured"),(z||_)&&(0,n.jsx)(h.V,{position:[0,1.2*Z.radius,0],center:!0,zIndexRange:[100,0],occlude:P<2e4,style:_?{pointerEvents:"none"}:{},children:(0,n.jsx)("span",{className:"planet-label",onClick:$,style:{color:g,fontSize:_?"14px":"12px",cursor:"pointer"},children:m})})]})]})});var v=r(1045),w=r(8236);let E=e=>(e%(2*Math.PI)+2*Math.PI)%(2*Math.PI);var z=e=>{let{planetName:t="Earth",planetRef:r,angleRef:o,numTriangles:s=5,radius:u,eccentricity:l=0,orbitalInclination:m}=e,{planetsData:d,updatePlanetAngle:h,updatePlanetData:x}=(0,i.d2)(),{experimentStatus:f}=(0,c.Z)(),[M,g]=(0,a.useState)(null),[j,P]=(0,a.useState)([]),[R,b]=(0,a.useState)(0),[v,w]=(0,a.useState)(null),z=(0,a.useRef)([]),T=(0,a.useRef)(!1);(0,a.useEffect)(()=>{P([]),b(0),g(null),w(null),z.current=[],T.current=!0},[t,u,d[t].eccentricity,m,s,x]),(0,a.useEffect)(()=>{null===f&&(P([]),b(0),g(null),w(null),z.current=[],T.current=!0)},[f]);let k=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,n=[];e=E(e),t=E(t);for(let e=0;e<20;e++)n.push([0,0,0]);let a=t-e;a<0&&(a+=2*Math.PI);for(let t=0;t<=r;t++){let o=e+t/r*a;n.push(V(o))}for(let e=0;e<20;e++)n.push([0,0,0]);return n},S=(0,a.useMemo)(()=>{let e=[];for(let t=0;t<=s;t++){let r=t/s*2*Math.PI,n=r;for(let e=0;e<10;e++){let e=(n-l*Math.sin(n)-r)/(1-l*Math.cos(n));if(n-=e,1e-6>Math.abs(e))break}let a=2*Math.atan(Math.sqrt((1+l)/(1-l))*Math.tan(n/2));e.push(E(a))}return e},[s,l]),V=e=>{let t=u*(1-l*l)/(1+l*Math.cos(e)),r=t*Math.sin(e),n=Math.PI/180*m;return[t*Math.cos(e),Math.sin(n)*r,Math.cos(n)*r]},I=(e,t,r)=>(e=E(e),(t=E(t))<=(r=E(r)))?e>=t&&e<=r:e>=t||e<=r;return(0,p.A)(()=>{if(!r.current)return;let e=r.current.position,t=E(Math.atan2(e.z,e.x));if(z.current.push(t),z.current.length>3&&z.current.shift(),null===v){w(t);return}let n=z.current,a=n.some(e=>e>5),o=n.some(e=>e<1);if(a&&o&&t<v){P([]),b(0),g(null),w(t),z.current=[t];return}if(R<s){let e=S[R],r=S[R+1];M?!I(t,e,r)&&I(v,e,r)?(P(t=>[...t,{points:k(e,r),color:M.color}]),R<s-1?(b(e=>e+1),g({startAngle:r,endAngle:t,color:`hsl(${(R+1)*360/s}, 70%, 50%)`})):g(null)):g(e=>({...e,endAngle:t})):g({startAngle:e,endAngle:t,color:`hsl(${360*R/s}, 70%, 50%)`})}w(t)}),(0,n.jsxs)("group",{children:[j.map((e,t)=>(0,n.jsx)(y.x,{points:e.points,color:e.color,lineWidth:2.5},`complete-${t}`)),M&&(0,n.jsx)(y.x,{points:k(M.startAngle,M.endAngle),color:M.color,lineWidth:4})]},t)},T=e=>{let{name:t="Earth",textures:r}=e,{planetsData:o}=(0,i.d2)(),{experimentType:s,experimentPlanet:u,experimentStatus:m}=(0,c.Z)(),g={...o[t]},{radius:y=1,orbitalOrigin:j,orbitalRadius:P=1,orbitalPeriod:E=1,orbitalInclination:T=0,axialTilt:k=0,rotationPeriod:S=1,color:V="#ffffff",initialOrbitalAngle:I=0,eccentricity:Z=0,mass:A}=g,{simSpeed:C,toggleDetailsMenu:L}=(0,i.ZP)(),{planetAngles:W,updatePlanetPosition:D,selectedPlanet:Y,setSelectedPlanet:U,displayLabels:_,selectedMoon:N,setSelectedMoon:X,orbitPaths:$}=(0,i.d2)(),{isSurfaceCameraActive:F,satelliteCamera:B,toggleSatelliteCamera:O,setAutoRotate:G,autoRotate:q,activeCamera:Q,switchToPlanetCamera:H}=(0,i.g5)(),J=A/l.ZP[t].mass,K=(0,a.useRef)(),ee=(0,a.useRef)(0),et=(0,a.useRef)(),er=(0,a.useRef)(null),[en,ea]=(0,a.useState)(!1),[eo,es]=(0,a.useState)(!1),[eu,ei]=(0,a.useState)(!1),ec=(0,a.useRef)({x:0,y:0}),el=Math.max(.1,P*(F?1e-4:l.Hm)),em=Math.max(.1,y*l.YB);l.E_;let ed=Y&&Y.name===t,ep=()=>!!ed||N?.parentName===t,eh=ed||ep()?64:16,[ex,ef]=(0,a.useState)(em),eM=(0,a.useRef)(1),[eg,ey]=(0,a.useState)(!1),[ej,eP]=(0,a.useState)(1),[eR,eb]=(0,a.useState)(0);(0,a.useEffect)(()=>{null===m&&(ee.current=-.000001,eb(0))},[m]),(0,p.A)((e,r)=>{let n=r*C;if("completed"===m)return;ee.current-=2*Math.PI/(86400*E)*n;let a=ee.current;for(let e=0;e<10;e++){let e=(a-Z*Math.sin(a)-ee.current)/(1-Z*Math.cos(a));if(a-=e,1e-6>Math.abs(e))break}let o=2*Math.atan(Math.sqrt((1+Z)/(1-Z))*Math.tan(a/2)),s=el*(1-Z*Z)/(1+Z*Math.cos(o)),u=s*Math.cos(-o),i=s*Math.sin(-o);if(K.current){let r=Math.PI/180*T,a=Math.sin(r)*i,o=Math.cos(r)*i;if(K.current.position.set(u,a,o),D(t,{x:u,y:a,z:o}),S&&er.current){let e=2*Math.PI/(3600*S)*n,t=new d.Vector3(0,1,0);er.current.rotateOnAxis(t,e);let r=n/86400;eb(e=>e+r),K.current.rotation.y>=2*Math.PI&&ed&&(K.current.rotation.y%=2*Math.PI),et.current&&(et.current.rotation.y+=1.1*e)}let s=K.current.position.distanceTo(e.camera.position);ef(Math.max(.1,s/1e3<=em?em:s/1e3)),ey("moon"===Q.type||s<500);let c=100*em,l=1*em;eP(Math.max(0,Math.min(1,(s-l)/(c-l)))),eM.current&&(eM.current=Math.max(.1,.02*s))}}),(0,a.useEffect)(()=>{er.current&&(er.current.rotation.order="YXZ",er.current.rotation.y=0,er.current.rotation.x=d.MathUtils.degToRad(k))},[k,Y]);let ev=e=>{e.stopPropagation(),eo||Q.name===t||(L(!0),X(null),U(g),H(t))},ew=e=>{e.stopPropagation(),es(!1),ec.current={x:e.clientX,y:e.clientY}},eE=e=>{Math.sqrt(Math.pow(e.clientX-ec.current.x,2)+Math.pow(e.clientY-ec.current.y,2))>5&&es(!0)},ez=e=>{es(!1)},eT=e=>{e.stopPropagation(),document.body.style.cursor="pointer",ei(!0)},ek=e=>{e.stopPropagation(),document.body.style.cursor="auto",ei(!1)},eS=x.ZP[t]||[],eV=Math.max(.1,ep()?em:8*ex),eI=Math.max(.1,ep()?em:8*ex),eZ=Math.max(.1,1.008*em),eA=Math.max(.1,1.02*em);return(0,n.jsxs)(n.Fragment,{children:[Q?.name===t&&K.current&&(0,n.jsx)(M.Z,{target:K.current,targetName:t,size:em}),(0,n.jsxs)("group",{ref:K,children:[(0,n.jsx)("mesh",{visible:!1,onClick:ev,onPointerDown:ew,onPointerMove:eE,onPointerUp:ez,onPointerOver:eT,onPointerOut:ek,children:Q?.name!==t&&(0,n.jsx)("sphereGeometry",{args:[eV,8,8]})}),(0,n.jsxs)("mesh",{ref:er,onDoubleClick:e=>{e.stopPropagation(),G(!q)},children:[(0,n.jsx)("sphereGeometry",{args:[eI,eh,eh/2]}),ed||ep()||!en?(0,n.jsxs)(n.Fragment,{children:["Earth"===t&&ed&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("mesh",{ref:et,children:[(0,n.jsx)("sphereGeometry",{args:[eZ,eh,eh/2]}),(0,n.jsx)("meshStandardMaterial",{alphaMap:r?.clouds,transparent:!0,opacity:.8})]},`${t}-cloud_texture`),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("sphereGeometry",{args:[eA,eh,eh/2]}),(0,n.jsx)("shaderMaterial",{args:[v.et]})]},`${t}-atmosphere_texture`)]}),(0,n.jsx)("meshStandardMaterial",{metalness:.6,roughness:.8,map:r?.map,onBuild:()=>ea(!0)})]}):(0,n.jsx)("meshBasicMaterial",{color:V})]},ed?t+"-textured":t+"-basic"),"Saturn"===t&&eg&&(0,n.jsx)(w.Z,{innerRadius:Math.max(.1,1.2*em),outerRadius:Math.max(.1,2*em),height:0,rotation:[d.MathUtils.degToRad(k),0,0],texture:ed?r?.ringTexture:null,detail:Math.max(eh,32)},eh+t+"-ring"),"Uranus"===t&&eg&&(0,n.jsx)(w.Z,{innerRadius:Math.max(.1,1.5*em),outerRadius:Math.max(.1,1.9*em),height:0,texture:ed?r?.ringTexture:null,detail:Math.max(eh,32),rotation:[d.MathUtils.degToRad(k),0,0]},eh+t+"-ring"),_&&ed&&(0,n.jsx)(h.V,{as:"span",wrapperClass:"label-wrapper",center:!0,"position-y":ed?ex+.25*ex:4*ex,zIndexRange:[100,0],style:{pointerEvents:"none"},children:(0,n.jsx)("span",{className:"planet-label",style:{color:V},onClick:ev,onPointerDown:ew,onPointerMove:eE,onPointerUp:ez,onPointerOver:eT,onPointerOut:ek,children:t})}),ep()&&eS.map((e,r)=>{if(!(m&&J<=.5)){let a=["Saturn","Uranus"].includes(t);return(0,n.jsx)("group",{rotation:a?[d.MathUtils.degToRad(k),0,0]:[0,0,0],children:(0,n.jsx)(R,{moonData:e,planetRef:K,parentName:t,scaledPlanetRadius:em},`${t}-moon-${r}`)},`${t}-moon-group-${r}`)}return null})]}),$&&(0,n.jsx)(f.Z,{origin:j,radius:el,eccentricity:Z,orbitalInclination:T,color:V,name:t+"-orbit-path",lineWidth:2,opacity:.5,hiRes:ed,position:K.current?.position}),"kepler-2"===s&&(0,n.jsx)(z,{planetName:t,planetRef:K,angleRef:ee,numTriangles:6,radius:el,eccentricity:Z,orbitalInclination:T},t),ep()&&m&&J<=.5&&eS.map((e,r)=>(0,n.jsx)(b,{moonData:e,planetRef:K,parentName:t,scaledPlanetRadius:em},`${t}-escaped-moon-${r}`))]})},k=r(3920),S=()=>{let{sunSettings:e,simSpeed:t,setSimSpeed:r,prevSpeed:o,setPrevSpeed:h,setViewOnlyMode:x}=(0,i.ZP)(),{planetPositions:f,selectedPlanet:M,selectedMoon:g,setSelectedMoon:y,planetsData:j,moonsData:P,moonPositions:R,resetPlanetsData:b}=(0,i.d2)(),{satelliteCamera:v,isCameraTransitioning:w,toggleCameraTransitioning:E,isZoomingToSun:z,resetCamera:S,toggleZoomingToSun:V,activeCamera:I,setActiveCamera:Z,setSceneCameras:A,sceneCameras:C,satelliteCameraState:L,setSatelliteCameraState:W}=(0,i.g5)(),{experimentPlanet:D}=(0,c.Z)(),Y=(0,a.useRef)(),[U,_]=(0,a.useState)(200),[N,X]=(0,a.useState)(!1),$=[1e5,1e5,1e5],F=[2e4,2e4,2e4],B=[0,0,0];(0,a.useEffect)(()=>{Y.current&&!N&&(Y.current.setPosition(...$,!1),Y.current.setTarget(...B,!1),setTimeout(()=>{Y.current.setPosition(...F,!0),Y.current.setTarget(...B,!0),X(!0)},100))},[Y.current]);let O=e=>"moon"===I.type?Math.max(.5*e,.01):4.2*e,G=(e,t)=>{let r=P[t];return r?r.find(t=>t.name===e):null};(0,p.A)(()=>{if(Y.current){if(L?.position&&w){let{position:e,targetPosition:t}=L;Y.current.setPosition(e.x,e.y,e.z,!1),Y.current.setTarget(t.x,t.y,t.z,!1),Y.current.updateCameraUp(),Y.current.update(),W(null)}if("planet"===I.type&&"Sun"!==I.name){let e=f[M.name];if(y(null),e){let t=O(j[M.name].radius*l.YB);_(t/2),Y.current.setTarget(e.x,e.y,e.z,!0),Y.current.dollyTo(t,!0),V(!1)}}if("moon"===I.type){let e=R[I.name],t=G(I.name,I.parentName);if(e&&t){let r=t.radius*l.YB,n=O(r);_(2*r),Y.current.setTarget(e.x,e.y,e.z,!0),Y.current.dollyTo(4*n,!0);let a=new d.Vector3;Y.current.getTarget(a),.1>a.distanceTo(new d.Vector3(e.x,e.y,e.z))&&E(!1)}}if("Sun"===I.name&&"planet"===I.type&&(_(200),Y.current.setTarget(0,0,0,!0),Y.current.maxDistance=1e3,E(!1),Y.current.distance>300&&z?Y.current.dollyTo(200,!0):V(!1)),"Asteroid Belt"===I.name){let e=I.position;if(e&&"number"==typeof e.x){Y.current.setPosition(e.x,e.y,e.z,!0),Y.current.setTarget(0,0,0,!0),_(4250),Y.current.maxDistance=9e3;let t=new d.Vector3;Y.current.getPosition(t),100>t.distanceTo(new d.Vector3(e.x,e.y,e.z))&&E(!1)}}if("default"===I.name&&w){let e=I.position,t=I.lookAt,r=new d.Vector3,n=new d.Vector3;Y.current.getPosition(r),Y.current.getTarget(n),r.distanceTo(e)>100&&Y.current.setLookAt(e.x,e.y,e.z,t.x,t.y,t.z,!0),E(!1),_(200)}"orbit"!==I.type||w||(_(200),Y.current.maxDistance=16e4)}}),(0,a.useEffect)(()=>{Y.current&&!N&&(Y.current.setPosition(...$,!1),Y.current.setTarget(...B,!1),Y.current.camera.updateProjectionMatrix(),setTimeout(()=>{S(),X(!0)},100))},[Y.current]),(0,a.useEffect)(()=>{I.name,("planet"===I.type||"moon"===I.type)&&(console.log("Transitioning camera"),E(!0),h(t),r(0)),"orbit"===I.type&&"default"===I.name&&0===t&&r(o),M||g||0!==t||r(o),"Sun"===I.name&&(V(!0),0===t&&r(o)),Y.current?.camera.updateProjectionMatrix()},[M,g,I]),(0,a.useEffect)(()=>{let e=e=>{1===e.button&&e.preventDefault(),Y.current&&(Y.current.mouseButtons.right=1)};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}},[]);let q=(0,s.m)({map:"../assets/earth/earth_daymap.jpg",clouds:"../assets/earth/earth_clouds.jpg"}),Q=(0,s.m)({map:"../assets/sun/sun.jpg"}),H=(0,s.m)({map:"../assets/venus/venus_surface.jpg"}),J=(0,s.m)({map:"../assets/mercury/mercury.jpg"}),K=(0,s.m)({map:"../assets/mars/mars.jpg"}),ee=(0,s.m)({map:"../assets/jupiter/jupiter.jpg"}),et=(0,s.m)({map:"../assets/saturn/saturn.jpg",ringTexture:"../assets/saturn/saturn-rings.png"}),er=(0,s.m)({map:"../assets/uranus/uranus.jpg",ringTexture:"../assets/uranus/uranus-rings.png"}),en=(0,s.m)({map:"../assets/neptune/neptune.jpg"});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.B,{ref:Y,makeDefault:!v,maxDistance:12e5,minDistance:U,smoothTime:.6,enableDamping:!0,near:.01,far:15e5,autoRotate:!0,enabled:!v}),(0,n.jsx)(k.Z,{}),(()=>{switch(D){case"Earth":default:return(0,n.jsx)(T,{name:"Earth",textures:q});case"Mars":return(0,n.jsx)(T,{name:"Mars",textures:K});case"Venus":return(0,n.jsx)(T,{name:"Venus",textures:H});case"Mercury":return(0,n.jsx)(T,{name:"Mercury",textures:J});case"Jupiter":return(0,n.jsx)(T,{name:"Jupiter",textures:ee});case"Saturn":return(0,n.jsx)(T,{name:"Saturn",textures:et});case"Uranus":return(0,n.jsx)(T,{name:"Uranus",textures:er});case"Neptune":return(0,n.jsx)(T,{name:"Neptune",textures:en})}})(),(0,n.jsx)(m.Z,{textures:Q,position:e.position,resetCamera:S},"Sun-plain")]})};r(7045);var V=()=>{let{experimentMode:e,toggleExperimentMode:t}=(0,c.Z)();return(0,a.useEffect)(()=>{t(!0)},[]),(0,n.jsx)(o.Z,{mode:e?"experiments":"main",children:(0,n.jsx)(S,{})})}},8584:function(e,t,r){"use strict";r.d(t,{Z:function(){return m}});var n=r(7437),a=r(2988),o=r(2265),s=r(7776),u=r(9373);let i=o.forwardRef(function({children:e,follow:t=!0,lockX:r=!1,lockY:n=!1,lockZ:i=!1,...c},l){let m=o.useRef(null),d=o.useRef(null),p=new s.Quaternion;return(0,u.A)(({camera:e})=>{if(!t||!d.current)return;let a=d.current.rotation.clone();d.current.updateMatrix(),d.current.updateWorldMatrix(!1,!1),d.current.getWorldQuaternion(p),e.getWorldQuaternion(m.current.quaternion).premultiply(p.invert()),r&&(d.current.rotation.x=a.x),n&&(d.current.rotation.y=a.y),i&&(d.current.rotation.z=a.z)}),o.useImperativeHandle(l,()=>d.current,[]),o.createElement("group",(0,a.Z)({ref:d,matrixAutoUpdate:!1,matrixWorldAutoUpdate:!1},c),o.createElement("group",{ref:m},e))});var c=r(9429);let l=o.forwardRef(({sdfGlyphSize:e=64,anchorX:t="center",anchorY:n="middle",font:s,fontSize:i=1,children:l,characters:m,onSync:d,...p},h)=>{let{Text:x,preloadFont:f}=(0,c.Rq)(async()=>Promise.all([r.e(918),r.e(610)]).then(r.bind(r,5212)),[]),M=(0,u.z)(({invalidate:e})=>e),[g]=o.useState(()=>new x),[y,j]=o.useMemo(()=>{let e=[],t="";return o.Children.forEach(l,r=>{"string"==typeof r||"number"==typeof r?t+=r:e.push(r)}),[e,t]},[l]);return(0,c.Rq)(()=>new Promise(e=>f({font:s,characters:m},e)),["troika-text",s,m]),o.useLayoutEffect(()=>void g.sync(()=>{M(),d&&d(g)})),o.useEffect(()=>()=>g.dispose(),[g]),o.createElement("primitive",(0,a.Z)({object:g,ref:h,font:s,text:j,anchorX:t,anchorY:n,fontSize:i,sdfGlyphSize:e},p),y)});var m=function(e){let{name:t,text:r,size:a=1,position:o=[0,3,0],color:s,handleClick:u,handlePointerDown:c,font:m="../assets/fonts/Termina_Black.ttf"}=e;return(0,n.jsx)(i,{onClick:u,onPointerDown:c,onPointerOver:()=>{u&&(document.body.style.cursor="pointer")},onPointerOut:()=>{u&&(document.body.style.cursor="auto")},children:(0,n.jsx)(l,{position:o,scale:a,color:s,font:m,anchorX:"center",anchorY:"middle",children:r.toUpperCase()})})}},8236:function(e,t,r){"use strict";var n=r(7437),a=r(2265),o=r(7776);t.Z=e=>{let{innerRadius:t,outerRadius:r,height:s=0,rotation:u,texture:i,detail:c=16}=e,l=(0,a.useMemo)(()=>{let e=new o.CylinderGeometry(r,t,s,c,1,!0),n=e.attributes.uv;for(let e=0;e<n.count;e++){let t=n.getX(e),r=n.getY(e);n.setXY(e,t,r)}return e},[t,r,s]),m=(0,a.useMemo)(()=>new o.MeshBasicMaterial({map:i,side:o.DoubleSide,transparent:!0}),[i]);return(0,n.jsx)("mesh",{geometry:l,material:m,rotation:u})}},1675:function(e,t,r){"use strict";var n=r(7437),a=r(2265),o=r(9373),s=r(5533),u=r(7776),i=r(8384);t.Z=e=>{let{target:t,size:r,targetName:c,bodyType:l="planet"}=e,{toggleCameraTransitioning:m,setAutoRotate:d,autoRotate:p,toggleSatelliteCamera:h,satelliteCamera:x,activeCamera:f,setSatelliteCameraState:M}=(0,i.g5)(),{prevSpeed:g,setSimSpeed:y}=(0,i.ZP)(),{gl:j,camera:P}=(0,o.z)(),R=(0,a.useRef)(),b=(0,a.useRef)(!1),v=(0,a.useRef)({x:0,y:0}),w=(0,a.useRef)(new u.Spherical(6*r,Math.PI/2,0)),E=2.8*r,z=(0,a.useCallback)(()=>{d(!1)},[d]),T=(0,a.useCallback)(e=>{b.current=!0,v.current={x:e.clientX,y:e.clientY}},[]),k=(0,a.useCallback)(()=>{b.current=!1},[]),S=(0,a.useCallback)(e=>{if(!b.current)return;z();let t=e.clientX-v.current.x,r=e.clientY-v.current.y,n=w.current.phi-.45*r*.01,a=w.current.theta-.45*t*.01;w.current.phi=Math.max(.1,Math.min(Math.PI-.1,n)),w.current.theta=a,v.current={x:e.clientX,y:e.clientY}},[z]),V=(0,a.useCallback)(e=>{if(!x)return;let t=.1*e.deltaY,r=u.MathUtils.clamp(w.current.radius+t,E,300);w.current.radius=r,z()},[x,r,l,z]),I=(0,a.useCallback)(e=>{b.current=!0,e.touches?(e.preventDefault(),v.current={x:e.touches[0].clientX,y:e.touches[0].clientY}):v.current={x:e.clientX,y:e.clientY}},[]),Z=(0,a.useCallback)(e=>{if(!b.current)return;z();let t=e.touches?e.touches[0].clientX:e.clientX,r=e.touches?e.touches[0].clientY:e.clientY,n=t-v.current.x,a=r-v.current.y,o=w.current.phi-.003*a,s=w.current.theta-.003*n;w.current.phi=Math.max(.1,Math.min(Math.PI-.1,o)),w.current.theta=s,v.current={x:t,y:r}},[z]);(0,o.A)((e,n)=>{if(!R.current||!t)return;let a=new u.Vector3;t.getWorldPosition(a);let o=t.position.clone();p&&(w.current.theta+=.05*n);let s=new u.Vector3().setFromSpherical(w.current).add(o);if(R.current.position.copy(s),R.current.lookAt(o),R.current.updateMatrixWorld(),x){let e=new u.Vector3;R.current.getWorldPosition(e);let t=new u.Quaternion;R.current.getWorldQuaternion(t),M(e,new u.Euler().setFromQuaternion(t),a)}f.name===c&&!x&&P.position.distanceTo(a)<=4.5*r&&A(P,a)});let A=(0,a.useCallback)((e,r)=>{let n=e.position.clone(),a=t.parent.matrixWorld.clone().invert(),o=n.applyMatrix4(a),s=t.position.clone(),i=o.sub(s);w.current.setFromVector3(i),w.current.radius=u.MathUtils.clamp(w.current.radius,E,300),R.current.position.copy(o),R.current.lookAt(s),h(!0),m(!1),y(g)},[t,l,r,h,m,y,g]);return(0,a.useEffect)(()=>{let e=j.domElement;return e.addEventListener("mousedown",T),window.addEventListener("mousemove",S),window.addEventListener("mouseup",k),e.addEventListener("wheel",V,{passive:!0}),e.addEventListener("touchstart",I),e.addEventListener("touchmove",Z),e.addEventListener("touchend",k),e.addEventListener("contextmenu",e=>e.preventDefault()),()=>{e.removeEventListener("mousedown",T),window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",k),e.removeEventListener("wheel",V),e.removeEventListener("touchstart",I),e.removeEventListener("touchmove",Z),e.removeEventListener("touchend",k),e.removeEventListener("contextmenu",e=>e.preventDefault()),x&&h(!1)}},[T,S,k,V,I,Z,j.domElement,x,h]),(0,n.jsx)(s.c,{ref:R,name:"satellite-camera-"+c,makeDefault:x,fov:50,near:.01,far:12e5},c)}},7045:function(){}},function(e){e.O(0,[260,689,251,927,971,190,744],function(){return e(e.s=206)}),_N_E=e.O()}]);