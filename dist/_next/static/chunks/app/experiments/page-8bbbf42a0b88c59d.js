(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[992],{206:function(e,t,r){Promise.resolve().then(r.bind(r,8474))},8474:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return A}});var n=r(7437),a=r(2265),o=r(4220),s=r(7871),i=r(3719),u=r(8384),l=r(2803),c=r(2079),m=r(5375),h=r(7776),d=r(9373),p=r(2325),x=r(8942),f=r(878),g=r(1675),M=r(6209);let y=e=>{let{start:t,end:r,color:a,thickness:o=.1}=e,s=new h.Vector3().subVectors(r,t),i=.5*s.length(),u=s.normalize(),l=new h.Quaternion,c=new h.Vector3(0,1,0);l.setFromUnitVectors(c,u);let m=i-1;return(0,n.jsx)("group",{position:t,children:(0,n.jsxs)("group",{quaternion:l,children:[(0,n.jsxs)("mesh",{position:[0,m/2,0],children:[(0,n.jsx)("cylinderGeometry",{args:[o,o,m,8]}),(0,n.jsx)("meshStandardMaterial",{color:a,emissive:a})]}),(0,n.jsxs)("mesh",{position:[0,i-.5,0],children:[(0,n.jsx)("coneGeometry",{args:[.3,1,8]}),(0,n.jsx)("meshStandardMaterial",{color:a,emissive:a})]})]})})};var j=e=>{let{moonRef:t,planetRef:r,length:a=3}=e;if(!t?.current?.position||!r?.current?.position)return null;let o=t.current.position.clone(),s=new h.Vector3(0,0,0),i=new h.Vector3().subVectors(s,o).normalize().multiplyScalar(Math.max(5,a)),u=new h.Vector3().subVectors(o,s).normalize().multiplyScalar(Math.max(5,a)),l=new h.Vector3(o.x+i.x,o.y+i.y,o.z+i.z),c=new h.Vector3(s.x+u.x,s.y+u.y,s.z+u.z);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y,{start:o,end:l,color:"orange",thickness:.04}),(0,n.jsx)(y,{start:s,end:c,color:"green",thickness:.04})]})};function w(e){let{meanMotion:t,eccentricity:r,orbitalRadius:n,orbitalInclination:a,currentAngle:o,deltaTime:s}=e,i=o-t*s,u=i;for(let e=0;e<10;e++){let e=(u-r*Math.sin(u)-i)/(1-r*Math.cos(u));if(u-=e,1e-6>Math.abs(e))break}let l=2*Math.atan(Math.sqrt((1+r)/(1-r))*Math.tan(u/2)),c=n*(1-r*r)/(1+r*Math.cos(l)),m=c*Math.sin(-l),d=Math.PI/180*a,p=Math.sin(d)*m,x=Math.cos(d)*m;return{position:new h.Vector3(c*Math.cos(-l),p,x),angle:i}}r(1577);var v=r(4851),P=e=>{let{target:t,color:r="white",width:o=3,opacity:s=1,active:i=!0,minPoints:u=150,maxPoints:l=300}=e,[c,m]=(0,a.useState)([]),p=(0,a.useRef)(0),x=(0,a.useRef)(null);(0,d.A)(()=>{if(i&&t?.current){if(p.current++,!x.current&&c.length<u){x.current=t.current.position.clone(),m(Array(u).fill(x.current.clone()));return}p.current%2==0&&m(e=>{if(e.length<u){let r=e[e.length-1]||t.current.position.clone(),n=Array(u-e.length).fill(r);return[...e,...n]}let r=[...e,t.current.position.clone()];if(r.length>l&&(r=r.slice(r.length-l)),r.length<u){let e=r[r.length-1];for(;r.length<u;)r.unshift(e.clone())}return r})}}),(0,a.useEffect)(()=>{if(!i){if(t?.current){let e=t.current.position.clone();m(Array(u).fill(e))}else m([]);x.current=null}},[i,u]);let f=c.map((e,t)=>{let n=t/Math.max(c.length-1,1);return new h.Color(r).multiplyScalar(n)});return c.length>1?(0,n.jsx)(v.x,{points:c,vertexColors:f,lineWidth:o,depthWrite:!1,transparent:!0,opacity:s}):null};let b=(0,a.forwardRef)((e,t)=>{let{moonData:r,planetRef:o,parentName:i,scaledPlanetRadius:m}=e,{name:g,orbitalRadius:y,radius:v,color:b,orbitalPeriod:R,orbitalInclination:V,eccentricity:E}=r,{simSpeed:S,toggleDetailsMenu:z}=(0,u.ZP)(),{selectedMoon:k,moonAngles:T,setSelectedMoon:I,updateMoonPosition:C,updateMoonWorldPosition:A,displayLabels:Z,orbitPaths:D,planetsData:L}=(0,u.d2)(),{satelliteCamera:N,activeCamera:Y,switchToMoonCamera:W}=(0,u.g5)(),{experimentStatus:_,setExperimentStatus:U,experimentType:X}=(0,l.Z)(),F=(0,a.useMemo)(()=>({radius:v*x.sh,orbitalRadius:y*x.H_,meanMotion:2*Math.PI/(86400*R)}),[v,y,R]),$=F.radius+m,B=c.ZP[i].mass,G=L[i].mass/B,O=t||(0,a.useRef)(),q=(0,a.useRef)(T[g]||2*Math.random()*Math.PI),H=(0,a.useRef)(null),Q=(0,a.useRef)(),[J,K]=(0,a.useState)(!1),ee=k&&k.name===g,et="Moon"===g?(0,s.m)("../assets/earth/moon/moon.jpg"):null,[er,en]=(0,a.useState)(!1),ea=(0,a.useRef)(null),eo=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(null===_){if(O.current){let e=O.current.position;q.current=Math.atan2(e.z,e.x)}H.current=null,K(!1),Q.current&&(Q.current.material.color.set(et?"white":b),Q.current.material.emissive.set("black"))}},[_,b,et]),(0,d.A)((e,t)=>{if(J||"completed"===_)return;if("started"!==_){O.current&&O.current.position.set(F.orbitalRadius,0,0);return}let r=G<=.5;if(null===H.current){let e=O.current.position;if(q.current=Math.atan2(e.z,e.x),H.current=q.current,r){let e=new h.Vector3;O.current.getWorldPosition(e);let t=L[i].orbitalSpeed*c.Hm,r=new h.Vector2(-t*Math.sin(H.current),t*Math.cos(H.current)),n=F.meanMotion*F.orbitalRadius,a=new h.Vector2(-n*Math.sin(q.current),n*Math.cos(q.current)).add(r);ea.current=e,eo.current=a,O.current.parent.parent.attach(O.current),en(!0)}}let n=t*S;if(O.current){if(r||er){let e=ea.current,t=eo.current;if(e.x+=t.x*n,e.z+=t.y*n,O.current.position.copy(e),e.length()>3*F.orbitalRadius){U("completed");return}}else if(.1>Math.abs(G-2)){let{position:e,angle:t}=function(e){let{meanMotion:t,orbitalRadius:r,currentAngle:n,startAngle:a,deltaTime:o}=e,s=r*Math.exp(-((a-n)/(2*Math.PI))*Math.PI),i=n-t*(1+15*Math.pow(1-s/r,2))*o,u=s*Math.cos(i),l=s*Math.sin(i);return{position:new h.Vector3(u,0,l),angle:i,radius:s}}({meanMotion:F.meanMotion,orbitalRadius:F.orbitalRadius,currentAngle:q.current,startAngle:H.current,deltaTime:n});O.current.position.copy(e),q.current=t}else if(.1>Math.abs(G-1.5)){let{position:e,angle:t}=function(e){let{meanMotion:t,eccentricity:r,orbitalRadius:n,orbitalInclination:a,currentAngle:o,deltaTime:s,radiusModifier:i=.7,eccentricityModifier:u=.3}=e;return w({meanMotion:1.2*t,eccentricity:Math.min(.7,r+u),orbitalRadius:n*i,orbitalInclination:a,currentAngle:o,deltaTime:s})}({meanMotion:F.meanMotion,eccentricity:E,orbitalRadius:F.orbitalRadius,orbitalInclination:V,currentAngle:q.current,deltaTime:n,radiusModifier:.7,eccentricityModifier:.3});O.current.position.copy(e),q.current=t}else{let{position:e,angle:t}=w({meanMotion:F.meanMotion,eccentricity:E,orbitalRadius:F.orbitalRadius,orbitalInclination:V,currentAngle:q.current,deltaTime:n});O.current.position.copy(e),q.current=t}if(O.current.position.length()<=$&&!r){K(!0),U("completed"),Q.current&&(Q.current.material.color.set("red"),Q.current.material.emissive.set("darkred"));return}let t=O.current.getWorldPosition(new h.Vector3);C(g,{x:t.x,y:t.y,z:t.z}),"Moon"===g&&O.current.lookAt(new h.Vector3(0,0,0));let a=new h.Vector3;e.camera.getWorldPosition(a),O.current.parent.worldToLocal(a);let o=O.current.getWorldPosition(new h.Vector3);A(g,{x:o.x,y:o.y,z:o.z})}});let es=e=>{e.stopPropagation(),ee||(z(!0),I(r),W(i,g))};return(0,n.jsxs)(n.Fragment,{children:[Y?.name===g&&O.current&&(0,n.jsx)(M.Z,{target:O.current,targetName:g,size:F.radius,bodyType:"moon"},g+"-satellite-camera"),"newton-1"===X?(0,n.jsx)(P,{target:O,color:b,width:2,active:_&&D,minPoints:100,maxPoints:150}):(0,n.jsx)(f.Z,{radius:F.orbitalRadius,eccentricity:E,orbitalInclination:V,color:b,name:`${g}-orbit-path`,hiRes:!0,lineWidth:1,position:O.current?.position,arcLength:.8}),(0,n.jsxs)("group",{ref:O,children:[(0,n.jsxs)("mesh",{ref:Q,rotation:"Moon"===g?[0,3.5*Math.PI,0]:[0,0,0],onClick:es,children:[(0,n.jsx)("sphereGeometry",{args:[F.radius,ee?38:24,ee?28:16]}),(0,n.jsx)("meshStandardMaterial",{metalness:J?.8:.5,roughness:J?.2:.5,map:J?null:et,color:J?"red":et?null:b,emissive:J?"darkred":"black"})]},g+"-textured"),(Z||ee)&&(0,n.jsx)(p.V,{position:[0,1.2*F.radius,0],center:!0,zIndexRange:[100,0],style:ee?{pointerEvents:"none"}:{},children:(0,n.jsx)("span",{className:"planet-label",onClick:es,style:{color:b,fontSize:ee?"14px":"12px",cursor:"pointer"},children:g})})]}),O.current&&"newton-1"===X&&(0,n.jsx)(j,{moonRef:O,planetRef:o,length:F.radius*G*100/(O.current.position.length()||1)})]})});var R=r(8811);let V=(0,a.forwardRef)((e,t)=>{let{moonData:r,planetRef:o,parentName:i,scaledPlanetRadius:c}=e,{name:m,orbitalRadius:f,radius:g,color:y,orbitalPeriod:j}=r,{simSpeed:w,toggleDetailsMenu:v}=(0,u.ZP)(),{selectedMoon:P,setSelectedMoon:b,updateMoonPosition:V,updateMoonWorldPosition:E,displayLabels:S,planetPositions:z}=(0,u.d2)(),{activeCamera:k,switchToMoonCamera:T}=(0,u.g5)(),{experimentStatus:I,setExperimentStatus:C}=(0,l.Z)(),A=(0,a.useMemo)(()=>({radius:g*x.sh,orbitalRadius:f*x.H_,meanMotion:2*Math.PI/(86400*j)}),[g,f,j]),Z=(0,a.useRef)(),D=(0,a.useRef)(null),L=(0,a.useRef)(null),N=(0,a.useRef)(null),Y=P&&P.name===m,W="Moon"===m?(0,s.m)("../assets/earth/moon/moon.jpg"):null;(0,a.useEffect)(()=>{if("started"===I){let e=z[i]||{x:0,y:0,z:0};D.current=new h.Vector3(e.x,e.y,e.z),L.current=new h.Vector3(A.orbitalRadius,0,0);let t=A.meanMotion*A.orbitalRadius;if(N.current=new h.Vector3(.8*t,.3*t,.5*t),Z.current){let e=new h.Vector3().addVectors(D.current,L.current);Z.current.position.copy(e)}}},[I]),(0,d.A)((e,t)=>{if(!Z.current||"started"!==I||!L.current||!N.current)return;L.current.add(N.current.clone().multiplyScalar(t*w));let r=z[i]||{x:0,y:0,z:0},n=new h.Vector3(r.x,r.y,r.z),a=new h.Vector3().addVectors(n,L.current);Z.current.position.copy(a),L.current.length()>3*A.orbitalRadius&&C("completed"),V(m,L.current.clone()),E(m,a.clone())});let _=e=>{e.stopPropagation(),Y||(v(!0),b(r),T(i,m))};return(0,n.jsxs)(n.Fragment,{children:[k?.name===m&&Z.current&&(0,n.jsx)(M.Z,{target:Z.current,targetName:m,size:A.radius,parentName:i}),"started"===I?(0,n.jsx)("group",{children:(0,n.jsx)(R.Q,{width:2,length:50,color:new h.Color("hotpink"),attenuation:e=>e*e,children:(0,n.jsxs)("group",{ref:Z,children:[(0,n.jsxs)("mesh",{rotation:"Moon"===m?[0,3.5*Math.PI,0]:[0,0,0],onClick:_,children:[(0,n.jsx)("sphereGeometry",{args:[A.radius,Y?38:24,Y?28:16]}),(0,n.jsx)("meshStandardMaterial",{metalness:.5,roughness:.5,map:W,color:W?null:y})]},m+"-textured"),(S||Y)&&(0,n.jsx)(p.V,{position:[0,1.2*A.radius,0],center:!0,zIndexRange:[100,0],children:(0,n.jsx)("span",{className:"planet-label",onClick:_,style:{color:y,fontSize:Y?"14px":"12px",cursor:"pointer"},children:m})})]})})}):(0,n.jsxs)("group",{ref:Z,children:[(0,n.jsxs)("mesh",{rotation:"Moon"===m?[0,3.5*Math.PI,0]:[0,0,0],onClick:_,children:[(0,n.jsx)("sphereGeometry",{args:[A.radius,Y?38:24,Y?28:16]}),(0,n.jsx)("meshStandardMaterial",{metalness:.5,roughness:.5,map:W,color:W?null:y})]},m+"-textured"),(S||Y)&&(0,n.jsx)(p.V,{position:[0,1.2*A.radius,0],center:!0,zIndexRange:[100,0],children:(0,n.jsx)("span",{className:"planet-label",onClick:_,style:{color:y,fontSize:Y?"14px":"12px",cursor:"pointer"},children:m})})]})]})});var E=r(4242),S=r(8236);let z=e=>(e%(2*Math.PI)+2*Math.PI)%(2*Math.PI);var k=e=>{let{planetName:t="Earth",planetRef:r,angleRef:o,numTriangles:s=5,radius:i,eccentricity:c=0,orbitalInclination:m}=e,{planetsData:h,updatePlanetAngle:p,updatePlanetData:x}=(0,u.d2)(),{experimentStatus:f}=(0,l.Z)(),[g,M]=(0,a.useState)(null),[y,j]=(0,a.useState)([]),[w,P]=(0,a.useState)(0),[b,R]=(0,a.useState)(null),V=(0,a.useRef)([]),E=(0,a.useRef)(!1);(0,a.useEffect)(()=>{j([]),P(0),M(null),R(null),V.current=[],E.current=!0},[t,i,h[t].eccentricity,m,s,x]),(0,a.useEffect)(()=>{null===f&&(j([]),P(0),M(null),R(null),V.current=[],E.current=!0)},[f]);let S=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,n=[];e=z(e),t=z(t);for(let e=0;e<20;e++)n.push([0,0,0]);let a=t-e;a<0&&(a+=2*Math.PI);for(let t=0;t<=r;t++){let o=e+t/r*a;n.push(T(o))}for(let e=0;e<20;e++)n.push([0,0,0]);return n},k=(0,a.useMemo)(()=>{let e=[];for(let t=0;t<=s;t++){let r=t/s*2*Math.PI,n=r;for(let e=0;e<10;e++){let e=(n-c*Math.sin(n)-r)/(1-c*Math.cos(n));if(n-=e,1e-6>Math.abs(e))break}let a=2*Math.atan(Math.sqrt((1+c)/(1-c))*Math.tan(n/2));e.push(z(a))}return e},[s,c]),T=e=>{let t=i*(1-c*c)/(1+c*Math.cos(e)),r=t*Math.sin(e),n=Math.PI/180*m;return[t*Math.cos(e),Math.sin(n)*r,Math.cos(n)*r]},I=(e,t,r)=>(e=z(e),(t=z(t))<=(r=z(r)))?e>=t&&e<=r:e>=t||e<=r;return(0,d.A)(()=>{if(!r.current)return;let e=r.current.position,t=z(Math.atan2(e.z,e.x));if(V.current.push(t),V.current.length>3&&V.current.shift(),null===b){R(t);return}let n=V.current,a=n.some(e=>e>5),o=n.some(e=>e<1);if(a&&o&&t<b){j([]),P(0),M(null),R(t),V.current=[t];return}if(w<s){let e=k[w],r=k[w+1];g?!I(t,e,r)&&I(b,e,r)?(j(t=>[...t,{points:S(e,r),color:g.color}]),w<s-1?(P(e=>e+1),M({startAngle:r,endAngle:t,color:`hsl(${(w+1)*360/s}, 70%, 50%)`})):M(null)):M(e=>({...e,endAngle:t})):M({startAngle:e,endAngle:t,color:`hsl(${360*w/s}, 70%, 50%)`})}R(t)}),(0,n.jsxs)("group",{children:[y.map((e,t)=>(0,n.jsx)(v.x,{points:e.points,color:e.color,lineWidth:2},`complete-${t}`)),g&&(0,n.jsx)(v.x,{points:S(g.startAngle,g.endAngle),color:g.color,lineWidth:4})]},t)},T=e=>{let{name:t="Earth",textures:r}=e,{planetsData:o}=(0,u.d2)(),{experimentType:s,experimentPlanet:i,experimentStatus:m}=(0,l.Z)(),{radius:M=1,orbitalOrigin:y,orbitalRadius:j=1,orbitalPeriod:w=1,orbitalInclination:v=0,axialTilt:P=0,rotationPeriod:R=1,color:z="#ffffff",initialOrbitalAngle:T=0,eccentricity:I=0,mass:C}={...o[t]},{simSpeed:A,toggleDetailsMenu:Z}=(0,u.ZP)(),{planetAngles:D,updatePlanetPosition:L,selectedPlanet:N,setSelectedPlanet:Y,displayLabels:W,selectedMoon:_,setSelectedMoon:U,orbitPaths:X}=(0,u.d2)(),{isSurfaceCameraActive:F,satelliteCamera:$,toggleSatelliteCamera:B,setAutoRotate:G,autoRotate:O,activeCamera:q,switchToPlanetCamera:H}=(0,u.g5)(),Q=C/c.ZP[t].mass,J=(0,a.useRef)(),K=(0,a.useRef)(0),ee=(0,a.useRef)(),et=(0,a.useRef)(null),[er,en]=(0,a.useState)(!1),[ea,eo]=(0,a.useState)(!1),[es,ei]=(0,a.useState)(!1),eu=(0,a.useRef)({x:0,y:0}),el=Math.max(.1,j*(F?1e-4:c.Hm)),ec=Math.max(.1,M*c.YB);c.E_;let em="newton-1"===s||N&&N.name===t,eh=()=>!!em||_?.parentName===t,ed=em||eh()?128:32,[ep,ex]=(0,a.useState)(ec),ef=(0,a.useRef)(1),[eg,eM]=(0,a.useState)(!1),[ey,ej]=(0,a.useState)(1),[ew,ev]=(0,a.useState)(0);(0,a.useEffect)(()=>{null===m&&(K.current=-.000001,ev(0))},[m]),(0,d.A)((e,r)=>{let n=r*A;if("completed"===m)return;if("newton-1"===s){if(R&&et.current){let e=2*Math.PI/(3600*R)*n,t=new h.Vector3(0,1,0);et.current.rotateOnAxis(t,e),ee.current&&(ee.current.rotation.y+=1.1*e)}if(J.current){if(!J.current.userData.initialPositionSet){let e=el*(1-I);J.current.position.set(e,0,0),L(t,{x:e,y:0,z:0}),J.current.userData.initialPositionSet=!0}let r=J.current.position.distanceTo(e.camera.position);ex(r/1e3<=ec?ec:r/1e3),eM("moon"===q.type||r<500);let n=100*ec,a=1*ec;ej(Math.max(0,Math.min(1,(r-a)/(n-a)))),ef.current&&(ef.current=.02*r)}return}K.current-=2*Math.PI/(86400*w)*n;let a=K.current;for(let e=0;e<10;e++){let e=(a-I*Math.sin(a)-K.current)/(1-I*Math.cos(a));if(a-=e,1e-6>Math.abs(e))break}let o=2*Math.atan(Math.sqrt((1+I)/(1-I))*Math.tan(a/2)),i=el*(1-I*I)/(1+I*Math.cos(o)),u=i*Math.cos(-o),l=i*Math.sin(-o);if(J.current){let r=Math.PI/180*v,a=Math.sin(r)*l,o=Math.cos(r)*l;if(J.current.position.set(u,a,o),L(t,{x:u,y:a,z:o}),R&&et.current){let e=2*Math.PI/(3600*R)*n,t=new h.Vector3(0,1,0);et.current.rotateOnAxis(t,e);let r=n/86400;ev(e=>e+r),J.current.rotation.y>=2*Math.PI&&em&&(J.current.rotation.y%=2*Math.PI),ee.current&&(ee.current.rotation.y+=1.1*e)}let s=J.current.position.distanceTo(e.camera.position);ex(Math.max(.1,s/1e3<=ec?ec:s/1e3)),eM("moon"===q.type||s<500);let i=100*ec,c=1*ec;ej(Math.max(0,Math.min(1,(s-c)/(i-c)))),ef.current&&(ef.current=Math.max(.1,.02*s))}}),(0,a.useEffect)(()=>{et.current&&(et.current.rotation.order="YXZ",et.current.rotation.y=0,et.current.rotation.x=h.MathUtils.degToRad(P))},[P,N]);let eP=e=>{e.stopPropagation(),eo(!1),eu.current={x:e.clientX,y:e.clientY}},eb=e=>{Math.sqrt(Math.pow(e.clientX-eu.current.x,2)+Math.pow(e.clientY-eu.current.y,2))>5&&eo(!0)},eR=e=>{eo(!1)},eV=e=>{e.stopPropagation(),document.body.style.cursor="pointer",ei(!0)},eE=e=>{e.stopPropagation(),document.body.style.cursor="auto",ei(!1)},eS=x.ZP[t]||[],ez=Math.max(.1,eh()?ec:8*ep),ek=Math.max(.1,eh()?ec:8*ep),eT=Math.max(.1,1.005*ec),eI=Math.max(.1,1.008*ec);return(0,n.jsxs)(n.Fragment,{children:[q?.name===t&&J.current&&(0,n.jsx)(g.Z,{target:J.current,targetName:t,size:ec}),(0,n.jsxs)("group",{ref:J,children:[(0,n.jsx)("mesh",{visible:!1,onPointerDown:eP,onPointerMove:eb,onPointerUp:eR,onPointerOver:eV,onPointerOut:eE,children:q?.name!==t&&(0,n.jsx)("sphereGeometry",{args:[ez,8,8]})}),(0,n.jsxs)("mesh",{ref:et,onDoubleClick:e=>{e.stopPropagation(),G(!O)},children:[(0,n.jsx)("sphereGeometry",{args:[ek,ed,ed/2]}),em||eh()||!er?(0,n.jsxs)(n.Fragment,{children:["Earth"===t&&em&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("mesh",{ref:ee,children:[(0,n.jsx)("sphereGeometry",{args:[eT,ed,ed/2]}),(0,n.jsx)("meshStandardMaterial",{alphaMap:r?.clouds,transparent:!0,opacity:.8})]},`${t}-cloud_texture`),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("sphereGeometry",{args:[eI,ed,ed/2]}),(0,n.jsx)("shaderMaterial",{args:[E.e]})]},`${t}-atmosphere_texture`)]}),(0,n.jsx)("meshStandardMaterial",{metalness:.6,roughness:.8,map:r?.map,onBuild:()=>en(!0)})]}):(0,n.jsx)("meshBasicMaterial",{color:z})]},em?t+"-textured":t+"-basic"),"Saturn"===t&&eg&&(0,n.jsx)(S.Z,{innerRadius:Math.max(.1,1.2*ec),outerRadius:Math.max(.1,2*ec),height:0,rotation:[h.MathUtils.degToRad(P),0,0],texture:em?r?.ringTexture:null,detail:Math.max(ed,32)},ed+t+"-ring"),"Uranus"===t&&eg&&(0,n.jsx)(S.Z,{innerRadius:Math.max(.1,1.5*ec),outerRadius:Math.max(.1,1.9*ec),height:0,texture:em?r?.ringTexture:null,detail:Math.max(ed,32),rotation:[h.MathUtils.degToRad(P),0,0]},ed+t+"-ring"),W&&em&&(0,n.jsx)(p.V,{as:"span",wrapperClass:"label-wrapper",center:!0,"position-y":em?ep+.25*ep:4*ep,zIndexRange:[100,0],style:{pointerEvents:"none"},children:(0,n.jsx)("span",{className:"planet-label",style:{color:z},onPointerDown:eP,onPointerMove:eb,onPointerUp:eR,onPointerOver:eV,onPointerOut:eE,children:t})}),eh()&&eS.map((e,r)=>{if(!(m&&Q<=.5)){let a=["Saturn","Uranus"].includes(t);return(0,n.jsx)("group",{rotation:a?[h.MathUtils.degToRad(P),0,0]:[0,0,0],children:(0,n.jsx)(b,{moonData:e,planetRef:J,parentName:t,scaledPlanetRadius:ec},`${t}-moon-${r}`)},`${t}-moon-group-${r}`)}return null})]}),X&&"newton-1"!==s&&(0,n.jsx)(f.Z,{position:J.current?.position,...(()=>{switch(s){case"kepler-2":return{name:t+"orbital-path",color:"#fff",lineWidth:1,opacity:1,hiRes:!0,transparent:!0,arcLength:.8,origin:y,radius:el,eccentricity:I,orbitalInclination:v};case"kepler-3":return{name:t+"orbital-path",color:z,lineWidth:5,opacity:.1,hiRes:!0,transparent:!0,arcLength:.8,origin:y,radius:el,eccentricity:I,orbitalInclination:v};default:return{name:t+"orbital-path",color:z,lineWidth:2,opacity:1,transparent:!0,hiRes:!0,arcLength:.8,origin:y,radius:el,eccentricity:I,orbitalInclination:v}}})()}),"kepler-2"===s&&(0,n.jsx)(k,{planetName:t,planetRef:J,angleRef:K,numTriangles:6,radius:el,eccentricity:I,orbitalInclination:v},t),eh()&&m&&Q<=.5&&eS.map((e,r)=>(0,n.jsx)(V,{moonData:e,planetRef:J,parentName:t,scaledPlanetRadius:ec},`${t}-escaped-moon-${r}`))]})},I=r(3920),C=()=>{let{sunSettings:e,simSpeed:t,setSimSpeed:r,prevSpeed:o,setPrevSpeed:p,setViewOnlyMode:x}=(0,u.ZP)(),{planetPositions:f,selectedPlanet:g,setSelectedPlanet:M,selectedMoon:y,setSelectedMoon:j,planetsData:w,moonsData:v,moonPositions:P,resetPlanetsData:b}=(0,u.d2)(),{satelliteCamera:R,isCameraTransitioning:V,toggleCameraTransitioning:E,isZoomingToSun:S,resetCamera:z,toggleZoomingToSun:k,activeCamera:C,setActiveCamera:A,switchToCustomCamera:Z,satelliteCameraState:D,setSatelliteCameraState:L}=(0,u.g5)(),{experimentPlanet:N,experimentType:Y}=(0,l.Z)(),W=(0,a.useRef)(),[_,U]=(0,a.useState)(200),[X,F]=(0,a.useState)(!1),$=[1e5,1e5,1e5],B=[2e4,2e4,2e4],G=[0,0,0];(0,a.useEffect)(()=>{W.current&&!X&&(W.current.setPosition(...$,!1),W.current.setTarget(...G,!1),setTimeout(()=>{W.current.setPosition(...B,!0),W.current.setTarget(...G,!0),F(!0)},100))},[W.current]);let O=e=>"moon"===C.type?Math.max(.5*e,.01):4.2*e,q=(e,t)=>{let r=v[t];return r?r.find(t=>t.name===e):null};(0,d.A)(()=>{if(W.current){if(D?.position&&V){let{position:e,targetPosition:t}=D;W.current.setPosition(e.x,e.y,e.z,!1),W.current.setTarget(t.x,t.y,t.z,!1),W.current.updateCameraUp(),W.current.update(),L(null)}if("planet"===C.type&&"Sun"!==C.name){let e=f[g.name];if(j(null),e){let t=O(w[g.name].radius*c.YB);U(t/2),W.current.setTarget(e.x,e.y,e.z,!0),W.current.dollyTo(t,!0),k(!1)}}if("moon"===C.type){let e=P[C.name],t=q(C.name,C.parentName);if(e&&t){let r=t.radius*c.YB,n=O(r);U(2*r),W.current.setTarget(e.x,e.y,e.z,!0),W.current.dollyTo(4*n,!0);let a=new h.Vector3;W.current.getTarget(a),.1>a.distanceTo(new h.Vector3(e.x,e.y,e.z))&&E(!1)}}if("Sun"===C.name&&"planet"===C.type&&(U(200),W.current.setTarget(0,0,0,!0),W.current.maxDistance=1e3,E(!1),W.current.distance>300&&S?W.current.dollyTo(200,!0):k(!1)),"Asteroid Belt"===C.name){let e=C.position;if(e&&"number"==typeof e.x){W.current.setPosition(e.x,e.y,e.z,!0),W.current.setTarget(0,0,0,!0),U(4250),W.current.maxDistance=9e3;let t=new h.Vector3;W.current.getPosition(t),100>t.distanceTo(new h.Vector3(e.x,e.y,e.z))&&E(!1)}}if("default"===C.name&&V){let e=C.position,t=C.lookAt,r=new h.Vector3,n=new h.Vector3;W.current.getPosition(r),W.current.getTarget(n),r.distanceTo(e)>100&&W.current.setLookAt(e.x,e.y,e.z,t.x,t.y,t.z,!0),E(!1),U(200)}if("orbit"!==C.type||V||(U(200),W.current.maxDistance=16e4),"kepler"===C.name&&N&&V){let e=w[N],t=e.orbitalRadius*c.Hm,r=t/2*e.eccentricity;W.current.setPosition(r,5*t,0,!0),W.current.setTarget(r,0,0,!0),U(t),W.current.maxDistance=2e6,E(!1)}if("newton"===C.name&&N&&V){let e=w[N].radius*c.YB,t=f[N];if(!t)return;let r=10*e*4;W.current.setPosition(t.x+r,.5*r,t.z,!0),W.current.setTarget(t.x,t.y,t.z,!0),U(6*e),W.current.maxDistance=20*r,E(!1)}}}),(0,a.useEffect)(()=>{W.current&&!X&&(W.current.setPosition(...$,!1),W.current.setTarget(...G,!1),W.current.camera.updateProjectionMatrix(),setTimeout(()=>{z(),F(!0)},100))},[W.current]),(0,a.useEffect)(()=>{C.name,("planet"===C.type||"moon"===C.type)&&(console.log("Transitioning camera"),E(!0),p(t),r(0)),"orbit"===C.type&&"default"===C.name&&0===t&&r(o),g||y||0!==t||r(o),"Sun"===C.name&&(k(!0),0===t&&r(o)),W.current?.camera.updateProjectionMatrix()},[g,y,C]),(0,a.useEffect)(()=>{Y&&(Y.includes("kepler")?Z("kepler",w[N]):"newton-1"===Y&&(M(N),Z("newton",w[N])))},[Y]),(0,a.useEffect)(()=>{let e=e=>{1===e.button&&e.preventDefault(),W.current&&(W.current.mouseButtons.right=1)};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}},[]);let H=(0,s.m)({map:"../assets/earth/earth_daymap.jpg",clouds:"../assets/earth/earth_clouds.jpg"}),Q=(0,s.m)({map:"../assets/sun/sun.jpg"}),J=(0,s.m)({map:"../assets/venus/venus_surface.jpg"}),K=(0,s.m)({map:"../assets/mercury/mercury.jpg"}),ee=(0,s.m)({map:"../assets/mars/mars.jpg"}),et=(0,s.m)({map:"../assets/jupiter/jupiter.jpg"}),er=(0,s.m)({map:"../assets/saturn/saturn.jpg",ringTexture:"../assets/saturn/saturn-rings.png"}),en=(0,s.m)({map:"../assets/uranus/uranus.jpg",ringTexture:"../assets/uranus/uranus-rings.png"}),ea=(0,s.m)({map:"../assets/neptune/neptune.jpg"});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.B,{ref:W,makeDefault:!R,maxDistance:12e5,minDistance:_,smoothTime:.6,enableDamping:!0,near:.01,far:15e5,autoRotate:!0,enabled:!R}),(0,n.jsx)(I.Z,{}),(()=>{switch(N){case"Earth":default:return(0,n.jsx)(T,{name:"Earth",textures:H});case"Mars":return(0,n.jsx)(T,{name:"Mars",textures:ee});case"Venus":return(0,n.jsx)(T,{name:"Venus",textures:J});case"Mercury":return(0,n.jsx)(T,{name:"Mercury",textures:K});case"Jupiter":return(0,n.jsx)(T,{name:"Jupiter",textures:et});case"Saturn":return(0,n.jsx)(T,{name:"Saturn",textures:er});case"Uranus":return(0,n.jsx)(T,{name:"Uranus",textures:en});case"Neptune":return(0,n.jsx)(T,{name:"Neptune",textures:ea})}})(),(0,n.jsx)(m.Z,{textures:Q,position:e.position,resetCamera:z},"Sun-plain")]})};r(7045);var A=()=>{let{experimentMode:e,toggleExperimentMode:t}=(0,l.Z)();return(0,a.useEffect)(()=>{t(!0)},[]),(0,n.jsx)(o.Z,{mode:e?"experiments":"main",children:(0,n.jsx)(C,{})})}},1577:function(e,t,r){"use strict";var n=r(7437),a=r(3537),o=r(4379);t.Z=function(e){let{name:t,text:r,size:s=1,position:i=[0,3,0],color:u,handleClick:l,handlePointerDown:c,font:m="../assets/fonts/Termina_Black.ttf"}=e;return(0,n.jsx)(a.V,{onClick:l,onPointerDown:e=>c(e,"down"),onPointerOver:()=>{l&&(document.body.style.cursor="pointer")},onPointerOut:()=>{l&&(document.body.style.cursor="auto")},children:(0,n.jsx)(o.x,{position:i,scale:s,color:u,font:m,anchorX:"center",anchorY:"middle",children:r.toUpperCase()})})}},8236:function(e,t,r){"use strict";var n=r(7437),a=r(2265),o=r(7776);t.Z=e=>{let{innerRadius:t,outerRadius:r,height:s=0,rotation:i,texture:u,detail:l=16}=e,c=(0,a.useMemo)(()=>{let e=new o.CylinderGeometry(r,t,s,l,1,!0),n=e.attributes.uv;for(let e=0;e<n.count;e++){let t=n.getX(e),r=n.getY(e);n.setXY(e,t,r)}return e},[t,r,s]),m=(0,a.useMemo)(()=>new o.MeshBasicMaterial({map:u,side:o.DoubleSide,transparent:!0}),[u]);return(0,n.jsx)("mesh",{geometry:c,material:m,rotation:i})}},1675:function(e,t,r){"use strict";var n=r(7437),a=r(2265),o=r(9373),s=r(5533),i=r(7776),u=r(8384);t.Z=e=>{let{target:t,size:r,targetName:l,bodyType:c="planet"}=e,{toggleCameraTransitioning:m,setAutoRotate:h,autoRotate:d,toggleSatelliteCamera:p,satelliteCamera:x,activeCamera:f,setSatelliteCameraState:g}=(0,u.g5)(),{prevSpeed:M,setSimSpeed:y}=(0,u.ZP)(),{gl:j,camera:w}=(0,o.z)(),v=(0,a.useRef)(),P=(0,a.useRef)(!1),b=(0,a.useRef)({x:0,y:0}),R=(0,a.useRef)(new i.Spherical(6*r,Math.PI/2,0)),V=2.8*r,E=(0,a.useCallback)(()=>{h(!1)},[h]),S=(0,a.useCallback)(e=>{P.current=!0,b.current={x:e.clientX,y:e.clientY}},[]),z=(0,a.useCallback)(()=>{P.current=!1},[]),k=(0,a.useCallback)(e=>{if(!P.current)return;E();let t=e.clientX-b.current.x,r=e.clientY-b.current.y,n=R.current.phi-.45*r*.01,a=R.current.theta-.45*t*.01;R.current.phi=Math.max(.1,Math.min(Math.PI-.1,n)),R.current.theta=a,b.current={x:e.clientX,y:e.clientY}},[E]),T=(0,a.useCallback)(e=>{if(!x)return;let t=.1*e.deltaY,r=i.MathUtils.clamp(R.current.radius+t,V,1e3);R.current.radius=r,E()},[x,r,c,E]),I=(0,a.useCallback)(e=>{P.current=!0,e.touches?(e.preventDefault(),b.current={x:e.touches[0].clientX,y:e.touches[0].clientY}):b.current={x:e.clientX,y:e.clientY}},[]),C=(0,a.useCallback)(e=>{if(!P.current)return;E();let t=e.touches?e.touches[0].clientX:e.clientX,r=e.touches?e.touches[0].clientY:e.clientY,n=t-b.current.x,a=r-b.current.y,o=R.current.phi-.003*a,s=R.current.theta-.003*n;R.current.phi=Math.max(.1,Math.min(Math.PI-.1,o)),R.current.theta=s,b.current={x:t,y:r}},[E]);(0,o.A)((e,n)=>{if(!v.current||!t)return;let a=new i.Vector3;t.getWorldPosition(a);let o=t.position.clone();d&&(R.current.theta+=.05*n);let s=new i.Vector3().setFromSpherical(R.current).add(o);if(v.current.position.copy(s),v.current.lookAt(o),v.current.updateMatrixWorld(),x){let e=new i.Vector3;v.current.getWorldPosition(e);let t=new i.Quaternion;v.current.getWorldQuaternion(t),g(e,new i.Euler().setFromQuaternion(t),a)}f.name===l&&!x&&w.position.distanceTo(a)<=4.5*r&&A(w,a)});let A=(0,a.useCallback)((e,r)=>{let n=e.position.clone(),a=t.parent.matrixWorld.clone().invert(),o=n.applyMatrix4(a),s=t.position.clone(),u=o.sub(s);R.current.setFromVector3(u),R.current.radius=i.MathUtils.clamp(R.current.radius,V,1e3),v.current.position.copy(o),v.current.lookAt(s),p(!0),m(!1),y(M)},[t,c,r,p,m,y,M]);return(0,a.useEffect)(()=>{let e=j.domElement;return e.addEventListener("mousedown",S),window.addEventListener("mousemove",k),window.addEventListener("mouseup",z),e.addEventListener("wheel",T,{passive:!0}),e.addEventListener("touchstart",I),e.addEventListener("touchmove",C),e.addEventListener("touchend",z),e.addEventListener("contextmenu",e=>e.preventDefault()),()=>{e.removeEventListener("mousedown",S),window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",z),e.removeEventListener("wheel",T),e.removeEventListener("touchstart",I),e.removeEventListener("touchmove",C),e.removeEventListener("touchend",z),e.removeEventListener("contextmenu",e=>e.preventDefault()),x&&p(!1)}},[S,k,z,T,I,C,j.domElement,x,p]),(0,n.jsx)(s.c,{ref:v,name:"satellite-camera-"+l,makeDefault:x,fov:50,near:1e-4,far:12e5},l)}},4242:function(e,t,r){"use strict";r.d(t,{e:function(){return n}});let n={uniforms:{glowColor:{value:new(r(7776)).Color(3377407)},glowIntensity:{value:.6}},vertexShader:`
      varying vec3 vNormal;
      varying vec3 vViewPosition;
      
      void main() {
        vNormal = normalize(normalMatrix * normal);
        vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
        vViewPosition = -mvPosition.xyz;
        gl_Position = projectionMatrix * mvPosition;
      }
    `,fragmentShader:`
      uniform vec3 glowColor;
      uniform float glowIntensity;
      varying vec3 vNormal;
      varying vec3 vViewPosition;
      
      void main() {
        float rim = 1.0 - max(dot(normalize(vViewPosition), vNormal), 0.0);
        rim = pow(rim, 3.0); // Increased power for sharper falloff
        gl_FragColor = vec4(glowColor, rim * glowIntensity);
      }
    `}},7045:function(){}},function(e){e.O(0,[260,689,723,540,75,646,971,190,744],function(){return e(e.s=206)}),_N_E=e.O()}]);