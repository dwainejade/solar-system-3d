(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[992],{206:function(e,t,r){Promise.resolve().then(r.bind(r,9704))},9704:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return I}});var n=r(7437),a=r(2265),o=r(4220),s=r(7871),i=r(3719),u=r(8384),l=r(2803),c=r(2079),m=r(5375),h=r(7776),p=r(9373),d=r(2325),f=r(8942),x=r(878),g=r(1675),M=r(6209);let y=e=>{let{start:t,end:r,color:a,thickness:o=.1}=e,s=new h.Vector3().subVectors(r,t),i=.5*s.length(),u=s.normalize(),l=new h.Quaternion,c=new h.Vector3(0,1,0);l.setFromUnitVectors(c,u);let m=i-.8;return(0,n.jsx)("group",{position:t,children:(0,n.jsxs)("group",{quaternion:l,children:[(0,n.jsxs)("mesh",{position:[0,m/2,0],children:[(0,n.jsx)("cylinderGeometry",{args:[o,o,m,8]}),(0,n.jsx)("meshStandardMaterial",{color:a,emissive:a})]}),(0,n.jsxs)("mesh",{position:[0,i-.4,0],children:[(0,n.jsx)("coneGeometry",{args:[.4,.8,16]}),(0,n.jsx)("meshStandardMaterial",{color:a,emissive:a,emissiveIntensity:.8,transparent:!0,opacity:.5})]})]})})};var v=e=>{let{moonRef:t,planetRef:r,length:a=3}=e;if(!t?.current?.position||!r?.current?.position)return null;let o=t.current.position.clone(),s=new h.Vector3(0,0,0),i=new h.Vector3().subVectors(s,o).normalize().multiplyScalar(Math.min(25,8*a)),u=new h.Vector3().subVectors(o,s).normalize().multiplyScalar(Math.min(25,8*a)),l=new h.Vector3(o.x+i.x,o.y+i.y,o.z+i.z),c=new h.Vector3(s.x+u.x,s.y+u.y,s.z+u.z);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y,{start:o,end:l,color:"orange",thickness:.04}),(0,n.jsx)(y,{start:s,end:c,color:"green",thickness:.04})]})};function w(e){let{meanMotion:t,eccentricity:r,orbitalRadius:n,orbitalInclination:a,currentAngle:o,deltaTime:s}=e,i=o+t*s,u=i;for(let e=0;e<10;e++){let e=(u-r*Math.sin(u)-i)/(1-r*Math.cos(u));if(u-=e,1e-6>Math.abs(e))break}let l=2*Math.atan(Math.sqrt((1+r)/(1-r))*Math.tan(u/2)),c=n*(1-r*r)/(1+r*Math.cos(l)),m=c*Math.sin(l),p=Math.PI/180*a,d=Math.sin(p)*m,f=Math.cos(p)*m;return{position:new h.Vector3(c*Math.cos(l),d,f),angle:i}}function j(e){let{meanMotion:t,orbitalRadius:r,currentAngle:n,startAngle:a=null,deltaTime:o,initialVelocity:s=null,position:i=null}=e;if(!s||!i){let e=t*r*1.05,a=new h.Vector2(-e*Math.sin(n),e*Math.cos(n));return{position:new h.Vector3(r*Math.cos(n),0,r*Math.sin(n)),velocity:a,angle:n}}let u=i.clone().normalize(),l=s.clone();l.x+=2e-6*u.x*o,l.y+=2e-6*u.z*o,l.multiplyScalar(.999);let c=i.clone();c.x+=l.x*o,c.z+=l.y*o;let m=Math.atan2(c.z,c.x);return{position:c,velocity:l,angle:m}}r(1577);var P=r(4851),b=e=>{let{target:t,color:r="white",width:o=3,opacity:s=1,active:i=!0,minPoints:u=150,maxPoints:l=300}=e,[c,m]=(0,a.useState)([]),d=(0,a.useRef)(0),f=(0,a.useRef)(null);(0,p.A)(()=>{if(i&&t?.current){if(d.current++,!f.current&&c.length<u){f.current=t.current.position.clone(),m(Array(u).fill(f.current.clone()));return}d.current%2==0&&m(e=>{if(e.length<u){let r=e[e.length-1]||t.current.position.clone(),n=Array(u-e.length).fill(r);return[...e,...n]}let r=[...e,t.current.position.clone()];if(r.length>l&&(r=r.slice(r.length-l)),r.length<u){let e=r[r.length-1];for(;r.length<u;)r.unshift(e.clone())}return r})}}),(0,a.useEffect)(()=>{if(!i){if(t?.current){let e=t.current.position.clone();m(Array(u).fill(e))}else m([]);f.current=null}},[i,u]);let x=c.map((e,t)=>{let n=t/Math.max(c.length-1,1);return new h.Color(r).multiplyScalar(n)});return c.length>1?(0,n.jsx)(P.x,{points:c,vertexColors:x,lineWidth:o,depthWrite:!1,transparent:!0,opacity:s}):null},R=e=>{let{moonData:t,planetRef:r,parentName:o,scaledPlanetRadius:i}=e,{name:m,orbitalRadius:g,radius:y,color:P,orbitalPeriod:R,orbitalInclination:E,eccentricity:V}=t,{simSpeed:S,toggleDetailsMenu:T}=(0,u.ZP)(),{selectedMoon:z,moonAngles:k,setSelectedMoon:A,updateMoonPosition:I,updateMoonWorldPosition:L,displayLabels:Z,orbitPaths:C,planetsData:D}=(0,u.d2)(),{satelliteCamera:N,activeCamera:W,switchToMoonCamera:Y}=(0,u.g5)(),{experimentStatus:_,setExperimentStatus:U,experimentType:X}=(0,l.Z)(),F=(0,a.useMemo)(()=>({radius:y*f.sh,orbitalRadius:g*f.H_,meanMotion:2*Math.PI/(86400*R)}),[y,g,R]),B=F.radius+i,$=c.ZP[o].mass,G=D[o].mass/$,O=(0,a.useRef)(),q=(0,a.useRef)(),Q=(0,a.useRef)(null),H=(0,a.useRef)(null),[J,K]=(0,a.useState)(!1),ee=z&&z.name===m,et="Moon"===m?(0,s.m)("../assets/earth/moon/moon.jpg"):null,[er,en]=(0,a.useState)(!1),ea=(0,a.useRef)(null),eo=(0,a.useRef)(null),es=(0,a.useRef)(!1);return(0,a.useEffect)(()=>{O.current&&!es.current&&(O.current.position.set(F.orbitalRadius,0,0),es.current=!0)},[F.orbitalRadius]),(0,a.useEffect)(()=>{null===_&&(Q.current=null,K(!1),en(!1),q.current&&(q.current.material.color.set(et?"white":P),q.current.material.emissive.set("black")))},[_,P,et]),(0,p.A)((e,t)=>{if(J||"completed"===_)return;if("started"!==_){if(O.current){let e=O.current.getWorldPosition(new h.Vector3);I(m,{x:e.x,y:e.y,z:e.z})}return}let r=G<=.5,n=t*S;if(null===Q.current&&(Q.current=H.current,r)){let e=j({meanMotion:F.meanMotion,orbitalRadius:F.orbitalRadius,currentAngle:H.current,deltaTime:n});ea.current=e.position,eo.current=e.velocity,O.current.parent.parent.attach(O.current),en(!0)}if(O.current){if(r||er){let{position:e,velocity:t}=j({meanMotion:F.meanMotion,orbitalRadius:F.orbitalRadius,currentAngle:H.current,deltaTime:n,initialVelocity:eo.current,position:ea.current});if(ea.current=e,eo.current=t,O.current.position.copy(e),e.length()>3*F.orbitalRadius){U("completed");return}}else if(.1>Math.abs(G-2)){let{position:e,angle:t}=function(e){let{meanMotion:t,orbitalRadius:r,currentAngle:n,startAngle:a,deltaTime:o}=e,s=r*Math.exp(-(Math.abs(a-n)/(2*Math.PI)*2.2)),i=n+t*Math.pow(r/s,.8)*5*o,u=s*Math.cos(i),l=s*Math.sin(i);return{position:new h.Vector3(u,0,l),angle:i,radius:s}}({meanMotion:F.meanMotion,orbitalRadius:F.orbitalRadius,currentAngle:H.current,startAngle:Q.current,deltaTime:n});O.current.position.copy(e),H.current=t}else if(.1>Math.abs(G-1.5)){let{position:e,angle:t}=function(e){let{meanMotion:t,eccentricity:r,orbitalRadius:n,orbitalInclination:a,currentAngle:o,deltaTime:s,radiusModifier:i=.7,eccentricityModifier:u=.3}=e;return w({meanMotion:1.2*t,eccentricity:Math.min(.7,r+u),orbitalRadius:n*i,orbitalInclination:a,currentAngle:o,deltaTime:s})}({meanMotion:F.meanMotion,eccentricity:V,orbitalRadius:F.orbitalRadius,orbitalInclination:E,currentAngle:H.current,deltaTime:n,radiusModifier:.7,eccentricityModifier:.3});O.current.position.copy(e),H.current=t}else{let{position:e,angle:t}=w({meanMotion:F.meanMotion,eccentricity:V,orbitalRadius:F.orbitalRadius,orbitalInclination:E,currentAngle:H.current,deltaTime:n});O.current.position.copy(e),H.current=t}if(O.current.position.length()<=B&&!r){K(!0),U("completed"),q.current&&(q.current.material.color.set("red"),q.current.material.emissive.set("darkred"));return}let t=O.current.getWorldPosition(new h.Vector3);I(m,{x:t.x,y:t.y,z:t.z}),"Moon"===m&&O.current.lookAt(new h.Vector3(0,0,0));let a=new h.Vector3;e.camera.getWorldPosition(a),O.current.parent.worldToLocal(a);let o=O.current.getWorldPosition(new h.Vector3);L(m,{x:o.x,y:o.y,z:o.z})}}),(0,n.jsxs)(n.Fragment,{children:[W?.name===m&&O.current&&(0,n.jsx)(M.Z,{target:O.current,targetName:m,size:F.radius,bodyType:"moon"},m+"-satellite-camera"),"newton-1"===X?(0,n.jsx)(b,{target:O,color:P,width:2,active:_&&C,minPoints:100,maxPoints:150}):(0,n.jsx)(x.Z,{radius:F.orbitalRadius,eccentricity:V,orbitalInclination:E,color:P,name:`${m}-orbit-path`,hiRes:!0,lineWidth:1,position:O.current?.position,arcLength:.9}),(0,n.jsxs)("group",{ref:O,children:[(0,n.jsxs)("mesh",{ref:q,rotation:"Moon"===m?[0,3.5*Math.PI,0]:[0,0,0],children:[(0,n.jsx)("sphereGeometry",{args:[F.radius,ee?38:24,ee?28:16]}),(0,n.jsx)("meshStandardMaterial",{metalness:J?.8:.5,roughness:J?.2:.5,map:J?null:et,color:J?"red":et?null:P,emissive:J?"darkred":"black"})]},m+"-textured"),(Z||ee)&&(0,n.jsx)(d.V,{position:[0,1.2*F.radius,0],center:!0,zIndexRange:[100,0],style:ee?{pointerEvents:"none"}:{},children:(0,n.jsx)("span",{className:"planet-label",style:{color:P,fontSize:ee?"14px":"12px",cursor:"pointer"},children:m})})]}),O.current&&"newton-1"===X&&(0,n.jsx)(v,{moonRef:O,planetRef:r,length:F.radius*G*100/(O.current.position.length()||1)})]})},E=r(4242),V=r(8236);let S=e=>(e%(2*Math.PI)+2*Math.PI)%(2*Math.PI);var T=e=>{let{planetName:t="Earth",planetRef:r,angleRef:o,numTriangles:s=5,radius:i,eccentricity:c=0,orbitalInclination:m}=e,{planetsData:h,updatePlanetAngle:d,updatePlanetData:f}=(0,u.d2)(),{experimentStatus:x}=(0,l.Z)(),[g,M]=(0,a.useState)(null),[y,v]=(0,a.useState)([]),[w,j]=(0,a.useState)(0),[b,R]=(0,a.useState)(null),E=(0,a.useRef)([]),V=(0,a.useRef)(!1);(0,a.useEffect)(()=>{v([]),j(0),M(null),R(null),E.current=[],V.current=!0},[t,i,h[t].eccentricity,m,s,f]),(0,a.useEffect)(()=>{null===x&&(v([]),j(0),M(null),R(null),E.current=[],V.current=!0)},[x]);let T=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,n=[];e=S(e),t=S(t);for(let e=0;e<20;e++)n.push([0,0,0]);let a=t-e;a<0&&(a+=2*Math.PI);for(let t=0;t<=r;t++){let o=e+t/r*a;n.push(k(o))}for(let e=0;e<20;e++)n.push([0,0,0]);return n},z=(0,a.useMemo)(()=>{let e=[];for(let t=0;t<=s;t++){let r=t/s*2*Math.PI,n=r;for(let e=0;e<10;e++){let e=(n-c*Math.sin(n)-r)/(1-c*Math.cos(n));if(n-=e,1e-6>Math.abs(e))break}let a=2*Math.atan(Math.sqrt((1+c)/(1-c))*Math.tan(n/2));e.push(S(a))}return e},[s,c]),k=e=>{let t=i*(1-c*c)/(1+c*Math.cos(e)),r=t*Math.sin(e),n=Math.PI/180*m;return[t*Math.cos(e),Math.sin(n)*r,Math.cos(n)*r]},A=(e,t,r)=>(e=S(e),(t=S(t))<=(r=S(r)))?e>=t&&e<=r:e>=t||e<=r;return(0,p.A)(()=>{if(!r.current)return;let e=r.current.position,t=S(Math.atan2(e.z,e.x));if(E.current.push(t),E.current.length>3&&E.current.shift(),null===b){R(t);return}let n=E.current,a=n.some(e=>e>5),o=n.some(e=>e<1);if(a&&o&&t<b){v([]),j(0),M(null),R(t),E.current=[t];return}if(w<s){let e=z[w],r=z[w+1];g?!A(t,e,r)&&A(b,e,r)?(v(t=>[...t,{points:T(e,r),color:g.color}]),w<s-1?(j(e=>e+1),M({startAngle:r,endAngle:t,color:`hsl(${(w+1)*360/s}, 70%, 50%)`})):M(null)):M(e=>({...e,endAngle:t})):M({startAngle:e,endAngle:t,color:`hsl(${360*w/s}, 70%, 50%)`})}R(t)}),(0,n.jsxs)("group",{children:[y.map((e,t)=>(0,n.jsx)(P.x,{points:e.points,color:e.color,lineWidth:2},`complete-${t}`)),g&&(0,n.jsx)(P.x,{points:T(g.startAngle,g.endAngle),color:g.color,lineWidth:4})]},t)},z=e=>{let{name:t="Earth",textures:r}=e,{planetsData:o}=(0,u.d2)(),{experimentType:s,experimentPlanet:i,experimentStatus:m}=(0,l.Z)(),{radius:M=1,orbitalOrigin:y,orbitalRadius:v=1,orbitalPeriod:w=1,orbitalInclination:j=0,axialTilt:P=0,rotationPeriod:b=1,color:S="#ffffff",initialOrbitalAngle:z=0,eccentricity:k=0,mass:A}={...o[t]},{simSpeed:I,toggleDetailsMenu:L}=(0,u.ZP)(),{planetAngles:Z,updatePlanetPosition:C,selectedPlanet:D,setSelectedPlanet:N,displayLabels:W,selectedMoon:Y,setSelectedMoon:_,orbitPaths:U}=(0,u.d2)(),{isSurfaceCameraActive:X,satelliteCamera:F,toggleSatelliteCamera:B,setAutoRotate:$,autoRotate:G,activeCamera:O,switchToPlanetCamera:q}=(0,u.g5)();c.ZP[t].mass;let Q=(0,a.useRef)(),H=(0,a.useRef)(0),J=(0,a.useRef)(),K=(0,a.useRef)(null),[ee,et]=(0,a.useState)(!1),[er,en]=(0,a.useState)(!1),[ea,eo]=(0,a.useState)(!1),es=(0,a.useRef)({x:0,y:0}),ei=Math.max(.1,v*(X?1e-4:c.Hm)),eu=Math.max(.1,M*c.YB);c.E_;let el="newton-1"===s||D&&D.name===t,ec=()=>!!el||Y?.parentName===t,em=el||ec()?128:32,[eh,ep]=(0,a.useState)(eu),ed=(0,a.useRef)(1),[ef,ex]=(0,a.useState)(!1),[eg,eM]=(0,a.useState)(1),[ey,ev]=(0,a.useState)(0);(0,a.useEffect)(()=>{null===m&&(H.current=-.000001,ev(0))},[m]),(0,p.A)((e,r)=>{let n=r*I;if("completed"===m)return;if("newton-1"===s){if(b&&K.current){let e=2*Math.PI/(3600*b)*n,t=new h.Vector3(0,1,0);K.current.rotateOnAxis(t,e),J.current&&(J.current.rotation.y+=1.1*e)}if(Q.current){if(!Q.current.userData.initialPositionSet){let e=ei*(1-k);Q.current.position.set(e,0,0),C(t,{x:e,y:0,z:0}),Q.current.userData.initialPositionSet=!0}let r=Q.current.position.distanceTo(e.camera.position);ep(r/1e3<=eu?eu:r/1e3),ex("moon"===O.type||r<500);let n=100*eu,a=1*eu;eM(Math.max(0,Math.min(1,(r-a)/(n-a)))),ed.current&&(ed.current=.02*r)}return}H.current-=2*Math.PI/(86400*w)*n;let a=H.current;for(let e=0;e<10;e++){let e=(a-k*Math.sin(a)-H.current)/(1-k*Math.cos(a));if(a-=e,1e-6>Math.abs(e))break}let o=2*Math.atan(Math.sqrt((1+k)/(1-k))*Math.tan(a/2)),i=ei*(1-k*k)/(1+k*Math.cos(o)),u=i*Math.cos(-o),l=i*Math.sin(-o);if(Q.current){let r=Math.PI/180*j,a=Math.sin(r)*l,o=Math.cos(r)*l;if(Q.current.position.set(u,a,o),C(t,{x:u,y:a,z:o}),b&&K.current){let e=2*Math.PI/(3600*b)*n,t=new h.Vector3(0,1,0);K.current.rotateOnAxis(t,e);let r=n/86400;ev(e=>e+r),Q.current.rotation.y>=2*Math.PI&&el&&(Q.current.rotation.y%=2*Math.PI),J.current&&(J.current.rotation.y+=1.1*e)}let s=Q.current.position.distanceTo(e.camera.position);ep(Math.max(.1,s/1e3<=eu?eu:s/1e3)),ex("moon"===O.type||s<500);let i=100*eu,c=1*eu;eM(Math.max(0,Math.min(1,(s-c)/(i-c)))),ed.current&&(ed.current=Math.max(.1,.02*s))}}),(0,a.useEffect)(()=>{K.current&&(K.current.rotation.order="YXZ",K.current.rotation.y=0,K.current.rotation.x=h.MathUtils.degToRad(P))},[P,D]);let ew=e=>{e.stopPropagation(),en(!1),es.current={x:e.clientX,y:e.clientY}},ej=e=>{Math.sqrt(Math.pow(e.clientX-es.current.x,2)+Math.pow(e.clientY-es.current.y,2))>5&&en(!0)},eP=e=>{en(!1)},eb=e=>{e.stopPropagation(),document.body.style.cursor="pointer",eo(!0)},eR=e=>{e.stopPropagation(),document.body.style.cursor="auto",eo(!1)},eE=f.ZP[t]||[],eV=Math.max(.1,ec()?eu:8*eh),eS=Math.max(.1,ec()?eu:8*eh),eT=Math.max(.1,1.005*eu),ez=Math.max(.1,1.008*eu);return(0,n.jsxs)(n.Fragment,{children:[O?.name===t&&Q.current&&(0,n.jsx)(g.Z,{target:Q.current,targetName:t,size:eu}),(0,n.jsxs)("group",{ref:Q,children:[(0,n.jsx)("mesh",{visible:!1,onPointerDown:ew,onPointerMove:ej,onPointerUp:eP,onPointerOver:eb,onPointerOut:eR,children:O?.name!==t&&(0,n.jsx)("sphereGeometry",{args:[eV,8,8]})}),(0,n.jsxs)("mesh",{ref:K,children:[(0,n.jsx)("sphereGeometry",{args:[eS,em,em/2]}),el||ec()||!ee?(0,n.jsxs)(n.Fragment,{children:["Earth"===t&&el&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("mesh",{ref:J,children:[(0,n.jsx)("sphereGeometry",{args:[eT,em,em/2]}),(0,n.jsx)("meshStandardMaterial",{alphaMap:r?.clouds,transparent:!0,opacity:.8})]},`${t}-cloud_texture`),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("sphereGeometry",{args:[ez,em,em/2]}),(0,n.jsx)("shaderMaterial",{args:[E.e]})]},`${t}-atmosphere_texture`)]}),(0,n.jsx)("meshStandardMaterial",{metalness:.6,roughness:.8,map:r?.map,onBuild:()=>et(!0)})]}):(0,n.jsx)("meshBasicMaterial",{color:S})]},el?t+"-textured":t+"-basic"),"Saturn"===t&&ef&&(0,n.jsx)(V.Z,{innerRadius:Math.max(.1,1.2*eu),outerRadius:Math.max(.1,2*eu),height:0,rotation:[h.MathUtils.degToRad(P),0,0],texture:el?r?.ringTexture:null,detail:Math.max(em,32)},em+t+"-ring"),"Uranus"===t&&ef&&(0,n.jsx)(V.Z,{innerRadius:Math.max(.1,1.5*eu),outerRadius:Math.max(.1,1.9*eu),height:0,texture:el?r?.ringTexture:null,detail:Math.max(em,32),rotation:[h.MathUtils.degToRad(P),0,0]},em+t+"-ring"),W&&el&&(0,n.jsx)(d.V,{as:"span",wrapperClass:"label-wrapper",center:!0,"position-y":el?eh+.25*eh:4*eh,zIndexRange:[100,0],style:{pointerEvents:"none"},children:(0,n.jsx)("span",{className:"planet-label",style:{color:S},onPointerDown:ew,onPointerMove:ej,onPointerUp:eP,onPointerOver:eb,onPointerOut:eR,children:t})}),ec()&&eE.map((e,r)=>{let a=["Saturn","Uranus"].includes(t);return(0,n.jsx)("group",{rotation:a?[h.MathUtils.degToRad(P),0,0]:[0,0,0],children:(0,n.jsx)(R,{moonData:e,planetRef:Q,parentName:t,scaledPlanetRadius:eu},`${t}-moon-${r}`)},`${t}-moon-group-${r}`)})]}),U&&"newton-1"!==s&&(0,n.jsx)(x.Z,{position:Q.current?.position,...(()=>{switch(s){case"kepler-2":return{name:t+"orbital-path",color:"#fff",lineWidth:1,opacity:1,hiRes:!0,transparent:!0,arcLength:.8,origin:y,radius:ei,eccentricity:k,orbitalInclination:j};case"kepler-3":return{name:t+"orbital-path",color:S,lineWidth:5,opacity:.1,hiRes:!0,transparent:!0,arcLength:.8,origin:y,radius:ei,eccentricity:k,orbitalInclination:j};default:return{name:t+"orbital-path",color:S,lineWidth:2,opacity:1,transparent:!0,hiRes:!0,arcLength:.8,origin:y,radius:ei,eccentricity:k,orbitalInclination:j}}})()}),"kepler-2"===s&&(0,n.jsx)(T,{planetName:t,planetRef:Q,angleRef:H,numTriangles:6,radius:ei,eccentricity:k,orbitalInclination:j},t)]})},k=r(3920),A=()=>{let{sunSettings:e,simSpeed:t,setSimSpeed:r,prevSpeed:o,setPrevSpeed:d,setViewOnlyMode:f}=(0,u.ZP)(),{planetPositions:x,selectedPlanet:g,setSelectedPlanet:M,selectedMoon:y,setSelectedMoon:v,planetsData:w,moonsData:j,moonPositions:P,resetPlanetsData:b}=(0,u.d2)(),{satelliteCamera:R,isCameraTransitioning:E,toggleCameraTransitioning:V,isZoomingToSun:S,resetCamera:T,toggleZoomingToSun:A,activeCamera:I,setActiveCamera:L,switchToCustomCamera:Z,satelliteCameraState:C,setSatelliteCameraState:D}=(0,u.g5)(),{experimentPlanet:N,experimentType:W}=(0,l.Z)(),Y=(0,a.useRef)(),[_,U]=(0,a.useState)(200),[X,F]=(0,a.useState)(!1),B=[1e5,1e5,1e5],$=[2e4,2e4,2e4],G=[0,0,0];(0,a.useEffect)(()=>{Y.current&&!X&&(Y.current.setPosition(...B,!1),Y.current.setTarget(...G,!1),setTimeout(()=>{Y.current.setPosition(...$,!0),Y.current.setTarget(...G,!0),F(!0)},100))},[Y.current]);let O=e=>"moon"===I.type?Math.max(.5*e,.01):4.2*e,q=(e,t)=>{let r=j[t];return r?r.find(t=>t.name===e):null};(0,p.A)(()=>{if(Y.current){if(C?.position&&E){let{position:e,targetPosition:t}=C;Y.current.setPosition(e.x,e.y,e.z,!1),Y.current.setTarget(t.x,t.y,t.z,!1),Y.current.updateCameraUp(),Y.current.update(),D(null)}if("planet"===I.type&&"Sun"!==I.name){let e=x[g.name];if(v(null),e){let t=O(w[g.name].radius*c.YB);U(t/2),Y.current.setTarget(e.x,e.y,e.z,!0),Y.current.dollyTo(t,!0),A(!1)}}if("moon"===I.type){let e=P[I.name],t=q(I.name,I.parentName);if(e&&t){let r=t.radius*c.YB,n=O(r);U(2*r),Y.current.setTarget(e.x,e.y,e.z,!0),Y.current.dollyTo(4*n,!0);let a=new h.Vector3;Y.current.getTarget(a),.1>a.distanceTo(new h.Vector3(e.x,e.y,e.z))&&V(!1)}}if("Sun"===I.name&&"planet"===I.type&&(U(200),Y.current.setTarget(0,0,0,!0),Y.current.maxDistance=1e3,V(!1),Y.current.distance>300&&S?Y.current.dollyTo(200,!0):A(!1)),"Asteroid Belt"===I.name){let e=I.position;if(e&&"number"==typeof e.x){Y.current.setPosition(e.x,e.y,e.z,!0),Y.current.setTarget(0,0,0,!0),U(4250),Y.current.maxDistance=9e3;let t=new h.Vector3;Y.current.getPosition(t),100>t.distanceTo(new h.Vector3(e.x,e.y,e.z))&&V(!1)}}if("default"===I.name&&E){let e=I.position,t=I.lookAt,r=new h.Vector3,n=new h.Vector3;Y.current.getPosition(r),Y.current.getTarget(n),r.distanceTo(e)>100&&Y.current.setLookAt(e.x,e.y,e.z,t.x,t.y,t.z,!0),V(!1),U(200)}if("orbit"!==I.type||E||(U(200),Y.current.maxDistance=16e4),"kepler"===I.name&&N&&E){let e=w[N],t=e.orbitalRadius*c.Hm,r=t/2*e.eccentricity;Y.current.setPosition(r,5*t,0,!0),Y.current.setTarget(r,0,0,!0),U(t),Y.current.maxDistance=2e6,V(!1)}if("newton"===I.name&&N&&E){let e=w[N].radius*c.YB,t=x[N];if(!t)return;let r=10*e*4;Y.current.setPosition(t.x+r,.5*r,t.z,!0),Y.current.setTarget(t.x,t.y,t.z,!0),U(6*e),Y.current.maxDistance=20*r,V(!1)}}}),(0,a.useEffect)(()=>{Y.current&&!X&&(Y.current.setPosition(...B,!1),Y.current.setTarget(...G,!1),Y.current.camera.updateProjectionMatrix(),setTimeout(()=>{T(),F(!0)},100))},[Y.current]),(0,a.useEffect)(()=>{I.name,("planet"===I.type||"moon"===I.type)&&(console.log("Transitioning camera"),V(!0),d(t),r(0)),"orbit"===I.type&&"default"===I.name&&0===t&&r(o),g||y||0!==t||r(o),"Sun"===I.name&&(A(!0),0===t&&r(o)),Y.current?.camera.updateProjectionMatrix()},[g,y,I]),(0,a.useEffect)(()=>{W&&(W.includes("kepler")?Z("kepler",w[N]):"newton-1"===W&&(M(N),Z("newton",w[N])))},[W]),(0,a.useEffect)(()=>{let e=e=>{1===e.button&&e.preventDefault(),Y.current&&(Y.current.mouseButtons.right=1)};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}},[]);let Q=(0,s.m)({map:"../assets/earth/earth_daymap.jpg",clouds:"../assets/earth/earth_clouds.jpg"}),H=(0,s.m)({map:"../assets/sun/sun.jpg"}),J=(0,s.m)({map:"../assets/venus/venus_surface.jpg"}),K=(0,s.m)({map:"../assets/mercury/mercury.jpg"}),ee=(0,s.m)({map:"../assets/mars/mars.jpg"}),et=(0,s.m)({map:"../assets/jupiter/jupiter.jpg"}),er=(0,s.m)({map:"../assets/saturn/saturn.jpg",ringTexture:"../assets/saturn/saturn-rings.png"}),en=(0,s.m)({map:"../assets/uranus/uranus.jpg",ringTexture:"../assets/uranus/uranus-rings.png"}),ea=(0,s.m)({map:"../assets/neptune/neptune.jpg"});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.B,{ref:Y,makeDefault:!R,maxDistance:12e5,minDistance:_,smoothTime:.6,enableDamping:!0,near:.01,far:15e5,autoRotate:!0,enabled:!R}),(0,n.jsx)(k.Z,{}),(()=>{switch(N){case"Earth":default:return(0,n.jsx)(z,{name:"Earth",textures:Q});case"Mars":return(0,n.jsx)(z,{name:"Mars",textures:ee});case"Venus":return(0,n.jsx)(z,{name:"Venus",textures:J});case"Mercury":return(0,n.jsx)(z,{name:"Mercury",textures:K});case"Jupiter":return(0,n.jsx)(z,{name:"Jupiter",textures:et});case"Saturn":return(0,n.jsx)(z,{name:"Saturn",textures:er});case"Uranus":return(0,n.jsx)(z,{name:"Uranus",textures:en});case"Neptune":return(0,n.jsx)(z,{name:"Neptune",textures:ea})}})(),(0,n.jsx)(m.Z,{textures:H,position:e.position,resetCamera:T},"Sun-plain")]})};r(7045);var I=()=>{let{experimentMode:e,toggleExperimentMode:t}=(0,l.Z)();return(0,a.useEffect)(()=>{t(!0)},[t]),(0,n.jsx)(o.Z,{mode:e?"experiments":"main",children:(0,n.jsx)(A,{})})}},8236:function(e,t,r){"use strict";var n=r(7437),a=r(2265),o=r(7776);t.Z=e=>{let{innerRadius:t,outerRadius:r,height:s=0,rotation:i,texture:u,detail:l=16}=e,c=(0,a.useMemo)(()=>{let e=new o.CylinderGeometry(r,t,s,l,1,!0),n=e.attributes.uv;for(let e=0;e<n.count;e++){let t=n.getX(e),r=n.getY(e);n.setXY(e,t,r)}return e},[t,r,s]),m=(0,a.useMemo)(()=>new o.MeshBasicMaterial({map:u,side:o.DoubleSide,transparent:!0}),[u]);return(0,n.jsx)("mesh",{geometry:c,material:m,rotation:i})}},1675:function(e,t,r){"use strict";var n=r(7437),a=r(2265),o=r(9373),s=r(5533),i=r(7776),u=r(8384);t.Z=e=>{let{target:t,size:r,targetName:l,bodyType:c="planet"}=e,{toggleCameraTransitioning:m,setAutoRotate:h,autoRotate:p,toggleSatelliteCamera:d,satelliteCamera:f,activeCamera:x,setSatelliteCameraState:g}=(0,u.g5)(),{prevSpeed:M,setSimSpeed:y}=(0,u.ZP)(),{gl:v,camera:w}=(0,o.z)(),j=(0,a.useRef)(),P=(0,a.useRef)(!1),b=(0,a.useRef)({x:0,y:0}),R=(0,a.useRef)(new i.Spherical(6*r,Math.PI/2,0)),E=2.8*r,V=(0,a.useCallback)(()=>{h(!1)},[h]),S=(0,a.useCallback)(e=>{P.current=!0,b.current={x:e.clientX,y:e.clientY}},[]),T=(0,a.useCallback)(()=>{P.current=!1},[]),z=(0,a.useCallback)(e=>{if(!P.current)return;V();let t=e.clientX-b.current.x,r=e.clientY-b.current.y,n=R.current.phi-.45*r*.01,a=R.current.theta-.45*t*.01;R.current.phi=Math.max(.1,Math.min(Math.PI-.1,n)),R.current.theta=a,b.current={x:e.clientX,y:e.clientY}},[V]),k=(0,a.useCallback)(e=>{if(!f)return;let t=.1*e.deltaY,r=i.MathUtils.clamp(R.current.radius+t,E,1e3);R.current.radius=r,V()},[f,r,c,V]),A=(0,a.useCallback)(e=>{P.current=!0,e.touches?(e.preventDefault(),b.current={x:e.touches[0].clientX,y:e.touches[0].clientY}):b.current={x:e.clientX,y:e.clientY}},[]),I=(0,a.useCallback)(e=>{if(!P.current)return;V();let t=e.touches?e.touches[0].clientX:e.clientX,r=e.touches?e.touches[0].clientY:e.clientY,n=t-b.current.x,a=r-b.current.y,o=R.current.phi-.003*a,s=R.current.theta-.003*n;R.current.phi=Math.max(.1,Math.min(Math.PI-.1,o)),R.current.theta=s,b.current={x:t,y:r}},[V]);(0,o.A)((e,n)=>{if(!j.current||!t)return;let a=new i.Vector3;t.getWorldPosition(a);let o=t.position.clone();p&&(R.current.theta+=.05*n);let s=new i.Vector3().setFromSpherical(R.current).add(o);if(j.current.position.copy(s),j.current.lookAt(o),j.current.updateMatrixWorld(),f){let e=new i.Vector3;j.current.getWorldPosition(e);let t=new i.Quaternion;j.current.getWorldQuaternion(t),g(e,new i.Euler().setFromQuaternion(t),a)}x.name===l&&!f&&w.position.distanceTo(a)<=4.5*r&&L(w,a)});let L=(0,a.useCallback)((e,r)=>{let n=e.position.clone(),a=t.parent.matrixWorld.clone().invert(),o=n.applyMatrix4(a),s=t.position.clone(),u=o.sub(s);R.current.setFromVector3(u),R.current.radius=i.MathUtils.clamp(R.current.radius,E,1e3),j.current.position.copy(o),j.current.lookAt(s),d(!0),m(!1),y(M)},[t,c,r,d,m,y,M]);return(0,a.useEffect)(()=>{let e=v.domElement;return e.addEventListener("mousedown",S),window.addEventListener("mousemove",z),window.addEventListener("mouseup",T),e.addEventListener("wheel",k,{passive:!0}),e.addEventListener("touchstart",A),e.addEventListener("touchmove",I),e.addEventListener("touchend",T),e.addEventListener("contextmenu",e=>e.preventDefault()),()=>{e.removeEventListener("mousedown",S),window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",T),e.removeEventListener("wheel",k),e.removeEventListener("touchstart",A),e.removeEventListener("touchmove",I),e.removeEventListener("touchend",T),e.removeEventListener("contextmenu",e=>e.preventDefault()),f&&d(!1)}},[S,z,T,k,A,I,v.domElement,f,d]),(0,n.jsx)(s.c,{ref:j,name:"planet-satellite-camera-"+l,makeDefault:f,fov:50,near:1e-4,far:12e5},l)}},4242:function(e,t,r){"use strict";r.d(t,{e:function(){return n}});let n={uniforms:{glowColor:{value:new(r(7776)).Color(3377407)},glowIntensity:{value:.6}},vertexShader:`
      varying vec3 vNormal;
      varying vec3 vViewPosition;
      
      void main() {
        vNormal = normalize(normalMatrix * normal);
        vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
        vViewPosition = -mvPosition.xyz;
        gl_Position = projectionMatrix * mvPosition;
      }
    `,fragmentShader:`
      uniform vec3 glowColor;
      uniform float glowIntensity;
      varying vec3 vNormal;
      varying vec3 vViewPosition;
      
      void main() {
        float rim = 1.0 - max(dot(normalize(vViewPosition), vNormal), 0.0);
        rim = pow(rim, 3.0); // Increased power for sharper falloff
        gl_FragColor = vec4(glowColor, rim * glowIntensity);
      }
    `}},7045:function(){}},function(e){e.O(0,[260,689,723,802,122,971,190,744],function(){return e(e.s=206)}),_N_E=e.O()}]);